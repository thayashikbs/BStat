<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 ロジット/ブロビット回帰分析 | ビジネス統計</title>
  <meta name="description" content="6 ロジット/ブロビット回帰分析 | ビジネス統計" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="6 ロジット/ブロビット回帰分析 | ビジネス統計" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 ロジット/ブロビット回帰分析 | ビジネス統計" />
  
  
  

<meta name="author" content="林 高樹" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="線形回帰分析.html"/>
<link rel="next" href="判別分析.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> はじめに</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#コースの目的"><i class="fa fa-check"></i><b>1.1</b> コースの目的</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#統計学統計的手法の学習について"><i class="fa fa-check"></i><b>1.2</b> 統計学/統計的手法の学習について</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#学習の目標"><i class="fa fa-check"></i>学習の目標</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#統計学統計的手法の学習方法"><i class="fa fa-check"></i>統計学/統計的手法の学習方法</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#統計学統計的手法の学習ステップ"><i class="fa fa-check"></i>統計学/統計的手法の学習ステップ</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#ビジネス応用における統計学の最近の趨勢"><i class="fa fa-check"></i><b>1.3</b> ビジネス応用における統計学の最近の趨勢</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#本書内の記載の注意点"><i class="fa fa-check"></i><b>1.4</b> 本書内の記載の注意点</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r言語の基本.html"><a href="r言語の基本.html"><i class="fa fa-check"></i><b>2</b> R言語の基本</a>
<ul>
<li class="chapter" data-level="2.1" data-path="r言語の基本.html"><a href="r言語の基本.html#rの基本プログラミング"><i class="fa fa-check"></i><b>2.1</b> Rの基本プログラミング</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="r言語の基本.html"><a href="r言語の基本.html#基本操作"><i class="fa fa-check"></i><b>2.1.1</b> 基本操作</a></li>
<li class="chapter" data-level="2.1.2" data-path="r言語の基本.html"><a href="r言語の基本.html#基本構文"><i class="fa fa-check"></i><b>2.1.2</b> 基本構文</a></li>
<li class="chapter" data-level="2.1.3" data-path="r言語の基本.html"><a href="r言語の基本.html#自作関数"><i class="fa fa-check"></i><b>2.1.3</b> 自作関数</a></li>
<li class="chapter" data-level="2.1.4" data-path="r言語の基本.html"><a href="r言語の基本.html#パッケージのインストール-読み込み"><i class="fa fa-check"></i><b>2.1.4</b> パッケージのインストール &amp; 読み込み</a></li>
<li class="chapter" data-level="2.1.5" data-path="r言語の基本.html"><a href="r言語の基本.html#ヘルプ"><i class="fa fa-check"></i><b>2.1.5</b> ヘルプ</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="r言語の基本.html"><a href="r言語の基本.html#データの型や構造"><i class="fa fa-check"></i><b>2.2</b> データの型や構造</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="r言語の基本.html"><a href="r言語の基本.html#データの値の種類-データ型"><i class="fa fa-check"></i><b>2.2.1</b> データの値の種類 (“データ型”)</a></li>
<li class="chapter" data-level="2.2.2" data-path="r言語の基本.html"><a href="r言語の基本.html#データの配列の仕方-データ構造"><i class="fa fa-check"></i><b>2.2.2</b> データの配列の仕方 (“データ構造”)</a></li>
<li class="chapter" data-level="2.2.3" data-path="r言語の基本.html"><a href="r言語の基本.html#ベクトル"><i class="fa fa-check"></i><b>2.2.3</b> ベクトル</a></li>
<li class="chapter" data-level="2.2.4" data-path="r言語の基本.html"><a href="r言語の基本.html#行列"><i class="fa fa-check"></i><b>2.2.4</b> 行列</a></li>
<li class="chapter" data-level="2.2.5" data-path="r言語の基本.html"><a href="r言語の基本.html#リスト"><i class="fa fa-check"></i><b>2.2.5</b> リスト</a></li>
<li class="chapter" data-level="2.2.6" data-path="r言語の基本.html"><a href="r言語の基本.html#データフレーム"><i class="fa fa-check"></i><b>2.2.6</b> データフレーム</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="r言語の基本.html"><a href="r言語の基本.html#データの操作演算"><i class="fa fa-check"></i><b>2.3</b> データの操作・演算</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="r言語の基本.html"><a href="r言語の基本.html#ベクトルの結合-ソート"><i class="fa fa-check"></i><b>2.3.1</b> ベクトルの結合, ソート</a></li>
<li class="chapter" data-level="2.3.2" data-path="r言語の基本.html"><a href="r言語の基本.html#二項演算"><i class="fa fa-check"></i><b>2.3.2</b> 二項演算</a></li>
<li class="chapter" data-level="2.3.3" data-path="r言語の基本.html"><a href="r言語の基本.html#論理演算"><i class="fa fa-check"></i><b>2.3.3</b> 論理演算</a></li>
<li class="chapter" data-level="2.3.4" data-path="r言語の基本.html"><a href="r言語の基本.html#条件式"><i class="fa fa-check"></i><b>2.3.4</b> 条件式</a></li>
<li class="chapter" data-level="2.3.5" data-path="r言語の基本.html"><a href="r言語の基本.html#行列演算"><i class="fa fa-check"></i><b>2.3.5</b> 行列演算</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="r言語の基本.html"><a href="r言語の基本.html#r関数"><i class="fa fa-check"></i><b>2.4</b> R関数</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="r言語の基本.html"><a href="r言語の基本.html#数学基本関数"><i class="fa fa-check"></i><b>2.4.1</b> 数学基本関数</a></li>
<li class="chapter" data-level="2.4.2" data-path="r言語の基本.html"><a href="r言語の基本.html#基本統計量の計算"><i class="fa fa-check"></i><b>2.4.2</b> 基本統計量の計算</a></li>
<li class="chapter" data-level="2.4.3" data-path="r言語の基本.html"><a href="r言語の基本.html#確率分布"><i class="fa fa-check"></i><b>2.4.3</b> 確率分布</a></li>
<li class="chapter" data-level="2.4.4" data-path="r言語の基本.html"><a href="r言語の基本.html#その他便利な関数"><i class="fa fa-check"></i><b>2.4.4</b> その他便利な関数</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="r言語の基本.html"><a href="r言語の基本.html#データの可視化"><i class="fa fa-check"></i><b>2.5</b> データの可視化</a></li>
<li class="chapter" data-level="2.6" data-path="r言語の基本.html"><a href="r言語の基本.html#ファイル入出力"><i class="fa fa-check"></i><b>2.6</b> ファイル入出力</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="r言語の基本.html"><a href="r言語の基本.html#テキストファイル読み込み"><i class="fa fa-check"></i><b>2.6.1</b> テキストファイル読み込み</a></li>
<li class="chapter" data-level="2.6.2" data-path="r言語の基本.html"><a href="r言語の基本.html#テキストファイル書き出し"><i class="fa fa-check"></i><b>2.6.2</b> テキストファイル書き出し</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="仮説検定.html"><a href="仮説検定.html"><i class="fa fa-check"></i><b>3</b> 仮説検定</a>
<ul>
<li class="chapter" data-level="3.1" data-path="仮説検定.html"><a href="仮説検定.html#平均値の差の検定"><i class="fa fa-check"></i><b>3.1</b> 平均値の差の検定</a></li>
<li class="chapter" data-level="3.2" data-path="仮説検定.html"><a href="仮説検定.html#カイ二乗検定"><i class="fa fa-check"></i><b>3.2</b> カイ二乗検定</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="仮説検定.html"><a href="仮説検定.html#独立性検定"><i class="fa fa-check"></i><b>3.2.1</b> 独立性検定</a></li>
<li class="chapter" data-level="3.2.2" data-path="仮説検定.html"><a href="仮説検定.html#適合度検定"><i class="fa fa-check"></i><b>3.2.2</b> 適合度検定</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="仮説検定.html"><a href="仮説検定.html#分析例-統計テストデータ"><i class="fa fa-check"></i><b>3.3</b> 分析例: 統計テストデータ</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="分散分析-anova.html"><a href="分散分析-anova.html"><i class="fa fa-check"></i><b>4</b> 分散分析 (ANOVA)</a>
<ul>
<li class="chapter" data-level="4.1" data-path="分散分析-anova.html"><a href="分散分析-anova.html#元配置anova"><i class="fa fa-check"></i><b>4.1</b> 1元配置ANOVA</a></li>
<li class="chapter" data-level="4.2" data-path="分散分析-anova.html"><a href="分散分析-anova.html#元配置anova-1"><i class="fa fa-check"></i><b>4.2</b> 2元配置ANOVA</a></li>
<li class="chapter" data-level="4.3" data-path="分散分析-anova.html"><a href="分散分析-anova.html#分析例"><i class="fa fa-check"></i><b>4.3</b> 分析例</a>
<ul>
<li class="chapter" data-level="" data-path="分散分析-anova.html"><a href="分散分析-anova.html#データ1-2業種口コミサイト仮想データ"><i class="fa fa-check"></i>データ1: 2業種口コミサイト(仮想データ)</a></li>
<li class="chapter" data-level="" data-path="分散分析-anova.html"><a href="分散分析-anova.html#データ2-統計小テストデータ"><i class="fa fa-check"></i>データ2: 統計小テストデータ</a></li>
<li class="chapter" data-level="" data-path="分散分析-anova.html"><a href="分散分析-anova.html#データ3-経営科学アンケート"><i class="fa fa-check"></i>データ3: 経営科学アンケート</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="線形回帰分析.html"><a href="線形回帰分析.html"><i class="fa fa-check"></i><b>5</b> 線形回帰分析</a>
<ul>
<li class="chapter" data-level="5.1" data-path="線形回帰分析.html"><a href="線形回帰分析.html#重回帰分析の基本操作"><i class="fa fa-check"></i><b>5.1</b> 重回帰分析の基本操作</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰分析.html"><a href="線形回帰分析.html#データ1-1ルーム賃貸マンション"><i class="fa fa-check"></i>データ1: 1ルーム賃貸マンション</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="線形回帰分析.html"><a href="線形回帰分析.html#変数の選択"><i class="fa fa-check"></i><b>5.2</b> 変数の選択</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰分析.html"><a href="線形回帰分析.html#データ2-ボストン市内住宅物件価格データ"><i class="fa fa-check"></i>データ2: ボストン市内住宅物件価格データ</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="線形回帰分析.html"><a href="線形回帰分析.html#説明変数に質的変数を含む回帰"><i class="fa fa-check"></i><b>5.3</b> 説明変数に質的変数を含む回帰</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰分析.html"><a href="線形回帰分析.html#データセット3-高速道路事故データ"><i class="fa fa-check"></i>データセット#3: 高速道路事故データ</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="線形回帰分析.html"><a href="線形回帰分析.html#時系列データ同士の回帰"><i class="fa fa-check"></i><b>5.4</b> 時系列データ同士の回帰</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰分析.html"><a href="線形回帰分析.html#データセット4-株式市場"><i class="fa fa-check"></i>データセット#4: 株式市場</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="線形回帰分析.html"><a href="線形回帰分析.html#線形モデル"><i class="fa fa-check"></i><b>5.5</b> 線形モデル</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰分析.html"><a href="線形回帰分析.html#因子モデルの例-交互作用なし"><i class="fa fa-check"></i>2因子モデルの例 (交互作用なし)</a></li>
<li class="chapter" data-level="" data-path="線形回帰分析.html"><a href="線形回帰分析.html#因子モデルの例-交互作用有り"><i class="fa fa-check"></i>2因子モデルの例 (交互作用有り)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ロジットブロビット回帰分析.html"><a href="ロジットブロビット回帰分析.html"><i class="fa fa-check"></i><b>6</b> ロジット/ブロビット回帰分析</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ロジットブロビット回帰分析.html"><a href="ロジットブロビット回帰分析.html#ロジット回帰分析の基本操作"><i class="fa fa-check"></i><b>6.1</b> ロジット回帰分析の基本操作</a>
<ul>
<li class="chapter" data-level="" data-path="ロジットブロビット回帰分析.html"><a href="ロジットブロビット回帰分析.html#ロジットモデル-シミュレーションデータ"><i class="fa fa-check"></i>ロジットモデル: シミュレーションデータ</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="ロジットブロビット回帰分析.html"><a href="ロジットブロビット回帰分析.html#データ分析例"><i class="fa fa-check"></i><b>6.2</b> データ分析例</a>
<ul>
<li class="chapter" data-level="" data-path="ロジットブロビット回帰分析.html"><a href="ロジットブロビット回帰分析.html#データセット-1-販売プロモーションデータ-仮想"><i class="fa fa-check"></i>データセット (1): 販売プロモーション・データ (仮想)</a></li>
<li class="chapter" data-level="" data-path="ロジットブロビット回帰分析.html"><a href="ロジットブロビット回帰分析.html#データセット-2-個人ローンデフォルトデータ-仮想"><i class="fa fa-check"></i>データセット (2): 個人ローン・デフォルト・データ (仮想)</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="ロジットブロビット回帰分析.html"><a href="ロジットブロビット回帰分析.html#疑似r2の計算"><i class="fa fa-check"></i><b>6.3</b> 疑似R2の計算</a>
<ul>
<li class="chapter" data-level="" data-path="ロジットブロビット回帰分析.html"><a href="ロジットブロビット回帰分析.html#パッケージdesctoolsの利用"><i class="fa fa-check"></i>パッケージDescToolsの利用</a></li>
<li class="chapter" data-level="" data-path="ロジットブロビット回帰分析.html"><a href="ロジットブロビット回帰分析.html#パッケージpsclの利用"><i class="fa fa-check"></i>パッケージpsclの利用</a></li>
<li class="chapter" data-level="" data-path="ロジットブロビット回帰分析.html"><a href="ロジットブロビット回帰分析.html#パッケージperformanceの利用"><i class="fa fa-check"></i>パッケージperformanceの利用</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="ロジットブロビット回帰分析.html"><a href="ロジットブロビット回帰分析.html#関数factorについて"><i class="fa fa-check"></i><b>6.4</b> 関数<code>factor()</code>について</a>
<ul>
<li class="chapter" data-level="" data-path="ロジットブロビット回帰分析.html"><a href="ロジットブロビット回帰分析.html#rでのfactor関数の使い方"><i class="fa fa-check"></i>Rでのfactor関数の使い方</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="判別分析.html"><a href="判別分析.html"><i class="fa fa-check"></i><b>7</b> 判別分析</a>
<ul>
<li class="chapter" data-level="7.1" data-path="判別分析.html"><a href="判別分析.html#線形判別-2次判別---パッケージmassの利用"><i class="fa fa-check"></i><b>7.1</b> 線形判別 &amp; 2次判別 - パッケージMASSの利用</a>
<ul>
<li class="chapter" data-level="" data-path="判別分析.html"><a href="判別分析.html#データセット-1-ビジネススクールの入学許可データ"><i class="fa fa-check"></i>データセット (1): ビジネススクールの入学許可データ</a></li>
<li class="chapter" data-level="" data-path="判別分析.html"><a href="判別分析.html#線形判別-lda"><i class="fa fa-check"></i>線形判別 (LDA)</a></li>
<li class="chapter" data-level="" data-path="判別分析.html"><a href="判別分析.html#次判別-qda"><i class="fa fa-check"></i>2次判別 (QDA)</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="判別分析.html"><a href="判別分析.html#knn法---パッケージclassの利用"><i class="fa fa-check"></i><b>7.2</b> kNN法 - パッケージclassの利用</a></li>
<li class="chapter" data-level="7.3" data-path="判別分析.html"><a href="判別分析.html#データセット分割学習判別評価"><i class="fa fa-check"></i><b>7.3</b> データセット分割・学習・判別・評価</a>
<ul>
<li class="chapter" data-level="" data-path="判別分析.html"><a href="判別分析.html#データセット2-個人ローンデフォルトデータ-仮想"><i class="fa fa-check"></i>データセット2: 個人ローン・デフォルト・データ (仮想)</a></li>
<li class="chapter" data-level="" data-path="判別分析.html"><a href="判別分析.html#線形判別"><i class="fa fa-check"></i>線形判別</a></li>
<li class="chapter" data-level="" data-path="判別分析.html"><a href="判別分析.html#knn法"><i class="fa fa-check"></i>kNN法</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="判別分析.html"><a href="判別分析.html#他パッケージの利用"><i class="fa fa-check"></i><b>7.4</b> 他パッケージの利用</a>
<ul>
<li class="chapter" data-level="" data-path="判別分析.html"><a href="判別分析.html#パッケージklar"><i class="fa fa-check"></i>パッケージ<strong>klaR</strong></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="決定木分析.html"><a href="決定木分析.html"><i class="fa fa-check"></i><b>8</b> 決定木分析</a>
<ul>
<li class="chapter" data-level="8.1" data-path="決定木分析.html"><a href="決定木分析.html#導入-回帰木-vs-線形回帰"><i class="fa fa-check"></i><b>8.1</b> 導入: 回帰木 vs 線形回帰</a>
<ul>
<li class="chapter" data-level="" data-path="決定木分析.html"><a href="決定木分析.html#データセット1-自動車の制動距離"><i class="fa fa-check"></i>データセット1: 自動車の制動距離</a></li>
<li class="chapter" data-level="8.1.1" data-path="決定木分析.html"><a href="決定木分析.html#基本操作-回帰木"><i class="fa fa-check"></i><b>8.1.1</b> 基本操作: 回帰木</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="決定木分析.html"><a href="決定木分析.html#回帰木"><i class="fa fa-check"></i><b>8.2</b> 回帰木</a>
<ul>
<li class="chapter" data-level="" data-path="決定木分析.html"><a href="決定木分析.html#データセット2-ワイン品質データ"><i class="fa fa-check"></i>データセット2: ワイン品質データ</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="決定木分析.html"><a href="決定木分析.html#分類木"><i class="fa fa-check"></i><b>8.3</b> 分類木</a>
<ul>
<li class="chapter" data-level="" data-path="決定木分析.html"><a href="決定木分析.html#データセット3-自動車評価データ"><i class="fa fa-check"></i>データセット3: 自動車評価データ</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="主成分分析-pca.html"><a href="主成分分析-pca.html"><i class="fa fa-check"></i><b>9</b> 主成分分析 (PCA)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="主成分分析-pca.html"><a href="主成分分析-pca.html#基本操作-1"><i class="fa fa-check"></i><b>9.1</b> 基本操作</a>
<ul>
<li class="chapter" data-level="" data-path="主成分分析-pca.html"><a href="主成分分析-pca.html#データセット1-ソニー株価リターン-vs-パナソニック株価リターン"><i class="fa fa-check"></i>データセット1: ソニー株価リターン vs パナソニック株価リターン</a></li>
<li class="chapter" data-level="" data-path="主成分分析-pca.html"><a href="主成分分析-pca.html#データセット2-従業員スキル評価データ仮想"><i class="fa fa-check"></i>データセット2: 従業員スキル評価データ(仮想)</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="主成分分析-pca.html"><a href="主成分分析-pca.html#種類のpca-相関行列ベース-vs-分散共分散行列ベース"><i class="fa fa-check"></i><b>9.2</b> 2種類のPCA: 相関行列ベース vs 分散共分散行列ベース</a>
<ul>
<li class="chapter" data-level="" data-path="主成分分析-pca.html"><a href="主成分分析-pca.html#データセット3-usarrests-data"><i class="fa fa-check"></i>データセット3: USArrests data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="探索的因子分析.html"><a href="探索的因子分析.html"><i class="fa fa-check"></i><b>10</b> 探索的因子分析</a>
<ul>
<li class="chapter" data-level="10.1" data-path="探索的因子分析.html"><a href="探索的因子分析.html#基本操作-2"><i class="fa fa-check"></i><b>10.1</b> 基本操作</a>
<ul>
<li class="chapter" data-level="" data-path="探索的因子分析.html"><a href="探索的因子分析.html#データセット1-従業員評価データ-仮想"><i class="fa fa-check"></i>データセット1: 従業員評価データ (仮想)</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="探索的因子分析.html"><a href="探索的因子分析.html#ライブラリpsychの利用"><i class="fa fa-check"></i><b>10.2</b> ライブラリ<strong>psych</strong>の利用</a></li>
<li class="chapter" data-level="10.3" data-path="探索的因子分析.html"><a href="探索的因子分析.html#因子分析に有用なツール"><i class="fa fa-check"></i><b>10.3</b> 因子分析に有用なツール</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="クラスター分析.html"><a href="クラスター分析.html"><i class="fa fa-check"></i><b>11</b> クラスター分析</a>
<ul>
<li class="chapter" data-level="11.1" data-path="クラスター分析.html"><a href="クラスター分析.html#基本操作-3"><i class="fa fa-check"></i><b>11.1</b> 基本操作</a>
<ul>
<li class="chapter" data-level="" data-path="クラスター分析.html"><a href="クラスター分析.html#階層型クラスタリング"><i class="fa fa-check"></i>階層型クラスタリング</a></li>
<li class="chapter" data-level="" data-path="クラスター分析.html"><a href="クラスター分析.html#k-means法"><i class="fa fa-check"></i>k-means法</a></li>
<li class="chapter" data-level="" data-path="クラスター分析.html"><a href="クラスター分析.html#変数に対するクラスタリング"><i class="fa fa-check"></i>変数に対するクラスタリング</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="クラスター分析.html"><a href="クラスター分析.html#データ分析例-1"><i class="fa fa-check"></i><b>11.2</b> データ分析例</a>
<ul>
<li class="chapter" data-level="" data-path="クラスター分析.html"><a href="クラスター分析.html#データセット-1-ワイン品質データ-再掲"><i class="fa fa-check"></i>データセット (1): ワイン品質データ (再掲)</a></li>
<li class="chapter" data-level="" data-path="クラスター分析.html"><a href="クラスター分析.html#データセット-2-id無し-posデータ"><i class="fa fa-check"></i>データセット (2): (ID無し) POSデータ</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="クラスター分析.html"><a href="クラスター分析.html#発展的なクラスター分析"><i class="fa fa-check"></i><b>11.3</b> 発展的なクラスター分析</a>
<ul>
<li class="chapter" data-level="" data-path="クラスター分析.html"><a href="クラスター分析.html#関数agnes"><i class="fa fa-check"></i>関数<code>agnes</code></a></li>
<li class="chapter" data-level="" data-path="クラスター分析.html"><a href="クラスター分析.html#関数pheatmap"><i class="fa fa-check"></i>関数<code>pheatmap</code></a></li>
<li class="chapter" data-level="" data-path="クラスター分析.html"><a href="クラスター分析.html#関数pam"><i class="fa fa-check"></i>関数<code>pam</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="アソシエーション分析.html"><a href="アソシエーション分析.html"><i class="fa fa-check"></i><b>12</b> アソシエーション分析</a>
<ul>
<li class="chapter" data-level="12.1" data-path="アソシエーション分析.html"><a href="アソシエーション分析.html#基本操作-4"><i class="fa fa-check"></i><b>12.1</b> 基本操作</a>
<ul>
<li class="chapter" data-level="" data-path="アソシエーション分析.html"><a href="アソシエーション分析.html#arulesパッケージの機能"><i class="fa fa-check"></i>arulesパッケージの機能</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="アソシエーション分析.html"><a href="アソシエーション分析.html#データ分析例-2"><i class="fa fa-check"></i><b>12.2</b> データ分析例</a>
<ul>
<li class="chapter" data-level="" data-path="アソシエーション分析.html"><a href="アソシエーション分析.html#データセット-id無し-posデータ-再掲"><i class="fa fa-check"></i>データセット: (ID無し) POSデータ (再掲)</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ビジネス統計</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ロジットブロビット回帰分析" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">6</span> ロジット/ブロビット回帰分析<a href="ロジットブロビット回帰分析.html#ロジットブロビット回帰分析" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="ロジット回帰分析の基本操作" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> ロジット回帰分析の基本操作<a href="ロジットブロビット回帰分析.html#ロジット回帰分析の基本操作" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="ロジットモデル-シミュレーションデータ" class="section level3 unnumbered hasAnchor">
<h3>ロジットモデル: シミュレーションデータ<a href="ロジットブロビット回帰分析.html#ロジットモデル-シミュレーションデータ" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>シミュレーションデータの生成</li>
</ul>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="ロジットブロビット回帰分析.html#cb211-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb211-2"><a href="ロジットブロビット回帰分析.html#cb211-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb211-3"><a href="ロジットブロビット回帰分析.html#cb211-3" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb211-4"><a href="ロジットブロビット回帰分析.html#cb211-4" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fl">1.2</span></span>
<span id="cb211-5"><a href="ロジットブロビット回帰分析.html#cb211-5" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>)</span>
<span id="cb211-6"><a href="ロジットブロビット回帰分析.html#cb211-6" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(n <span class="sc">*</span> p, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>), <span class="at">ncol =</span> p)  <span class="co"># 予測変数 (X1, X2)</span></span>
<span id="cb211-7"><a href="ロジットブロビット回帰分析.html#cb211-7" tabindex="-1"></a><span class="fu">colnames</span>(X) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;X&quot;</span>, <span class="dv">1</span><span class="sc">:</span>p)</span>
<span id="cb211-8"><a href="ロジットブロビット回帰分析.html#cb211-8" tabindex="-1"></a>mu <span class="ot">&lt;-</span> a <span class="sc">+</span> X <span class="sc">%*%</span> b  <span class="co"># 線形予測子</span></span>
<span id="cb211-9"><a href="ロジットブロビット回帰分析.html#cb211-9" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">exp</span>(mu)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(mu))  <span class="co"># ロジスティック変換</span></span>
<span id="cb211-10"><a href="ロジットブロビット回帰分析.html#cb211-10" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, pi)  <span class="co"># 発生頻度 (ランダム)</span></span>
<span id="cb211-11"><a href="ロジットブロビット回帰分析.html#cb211-11" tabindex="-1"></a></span>
<span id="cb211-12"><a href="ロジットブロビット回帰分析.html#cb211-12" tabindex="-1"></a><span class="fu">plot</span>(X[, <span class="dv">1</span>], y)</span></code></pre></div>
<p><img src="070-logit_files/figure-html/logit_1-1.png" width="75%" /></p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="ロジットブロビット回帰分析.html#cb212-1" tabindex="-1"></a><span class="fu">plot</span>(X[, <span class="dv">2</span>], y)</span></code></pre></div>
<p><img src="070-logit_files/figure-html/logit_1-2.png" width="75%" /></p>
<ul>
<li>ロジット回帰分析の実行</li>
</ul>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="ロジットブロビット回帰分析.html#cb213-1" tabindex="-1"></a><span class="co"># ロジット回帰</span></span>
<span id="cb213-2"><a href="ロジットブロビット回帰分析.html#cb213-2" tabindex="-1"></a>res_glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> X, <span class="at">family =</span> binomial)</span>
<span id="cb213-3"><a href="ロジットブロビット回帰分析.html#cb213-3" tabindex="-1"></a><span class="fu">summary</span>(res_glm)</span>
<span id="cb213-4"><a href="ロジットブロビット回帰分析.html#cb213-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb213-5"><a href="ロジットブロビット回帰分析.html#cb213-5" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb213-6"><a href="ロジットブロビット回帰分析.html#cb213-6" tabindex="-1"></a><span class="co">#&gt; glm(formula = y ~ X, family = binomial)</span></span>
<span id="cb213-7"><a href="ロジットブロビット回帰分析.html#cb213-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb213-8"><a href="ロジットブロビット回帰分析.html#cb213-8" tabindex="-1"></a><span class="co">#&gt; Deviance Residuals: </span></span>
<span id="cb213-9"><a href="ロジットブロビット回帰分析.html#cb213-9" tabindex="-1"></a><span class="co">#&gt;      Min        1Q    Median        3Q       Max  </span></span>
<span id="cb213-10"><a href="ロジットブロビット回帰分析.html#cb213-10" tabindex="-1"></a><span class="co">#&gt; -1.79161  -0.08440   0.00084   0.09128   2.36307  </span></span>
<span id="cb213-11"><a href="ロジットブロビット回帰分析.html#cb213-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb213-12"><a href="ロジットブロビット回帰分析.html#cb213-12" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb213-13"><a href="ロジットブロビット回帰分析.html#cb213-13" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb213-14"><a href="ロジットブロビット回帰分析.html#cb213-14" tabindex="-1"></a><span class="co">#&gt; (Intercept)   2.5815     0.8647   2.985 0.002831 ** </span></span>
<span id="cb213-15"><a href="ロジットブロビット回帰分析.html#cb213-15" tabindex="-1"></a><span class="co">#&gt; XX1           1.1494     0.3434   3.347 0.000818 ***</span></span>
<span id="cb213-16"><a href="ロジットブロビット回帰分析.html#cb213-16" tabindex="-1"></a><span class="co">#&gt; XX2           2.7630     0.7509   3.680 0.000233 ***</span></span>
<span id="cb213-17"><a href="ロジットブロビット回帰分析.html#cb213-17" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb213-18"><a href="ロジットブロビット回帰分析.html#cb213-18" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb213-19"><a href="ロジットブロビット回帰分析.html#cb213-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb213-20"><a href="ロジットブロビット回帰分析.html#cb213-20" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb213-21"><a href="ロジットブロビット回帰分析.html#cb213-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb213-22"><a href="ロジットブロビット回帰分析.html#cb213-22" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 133.750  on 99  degrees of freedom</span></span>
<span id="cb213-23"><a href="ロジットブロビット回帰分析.html#cb213-23" tabindex="-1"></a><span class="co">#&gt; Residual deviance:  34.478  on 97  degrees of freedom</span></span>
<span id="cb213-24"><a href="ロジットブロビット回帰分析.html#cb213-24" tabindex="-1"></a><span class="co">#&gt; AIC: 40.478</span></span>
<span id="cb213-25"><a href="ロジットブロビット回帰分析.html#cb213-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb213-26"><a href="ロジットブロビット回帰分析.html#cb213-26" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 8</span></span></code></pre></div>
<ul>
<li>予測</li>
</ul>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="ロジットブロビット回帰分析.html#cb214-1" tabindex="-1"></a><span class="co"># 予測 (内挿)</span></span>
<span id="cb214-2"><a href="ロジットブロビット回帰分析.html#cb214-2" tabindex="-1"></a>mu_hat <span class="ot">&lt;-</span> <span class="fu">predict</span>(res_glm)  <span class="co"># μ</span></span>
<span id="cb214-3"><a href="ロジットブロビット回帰分析.html#cb214-3" tabindex="-1"></a>p_hat <span class="ot">&lt;-</span> <span class="fu">predict</span>(res_glm, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)  <span class="co"># 発生頻度</span></span>
<span id="cb214-4"><a href="ロジットブロビット回帰分析.html#cb214-4" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">data.frame</span>(y, p_hat))</span>
<span id="cb214-5"><a href="ロジットブロビット回帰分析.html#cb214-5" tabindex="-1"></a><span class="co">#&gt;   y     p_hat</span></span>
<span id="cb214-6"><a href="ロジットブロビット回帰分析.html#cb214-6" tabindex="-1"></a><span class="co">#&gt; 1 1 0.9846543</span></span>
<span id="cb214-7"><a href="ロジットブロビット回帰分析.html#cb214-7" tabindex="-1"></a><span class="co">#&gt; 2 0 0.0500027</span></span>
<span id="cb214-8"><a href="ロジットブロビット回帰分析.html#cb214-8" tabindex="-1"></a><span class="co">#&gt; 3 0 0.0507452</span></span>
<span id="cb214-9"><a href="ロジットブロビット回帰分析.html#cb214-9" tabindex="-1"></a><span class="co">#&gt; 4 1 1.0000000</span></span>
<span id="cb214-10"><a href="ロジットブロビット回帰分析.html#cb214-10" tabindex="-1"></a><span class="co">#&gt; 5 1 0.9448650</span></span>
<span id="cb214-11"><a href="ロジットブロビット回帰分析.html#cb214-11" tabindex="-1"></a><span class="co">#&gt; 6 0 0.3178520</span></span>
<span id="cb214-12"><a href="ロジットブロビット回帰分析.html#cb214-12" tabindex="-1"></a><span class="fu">plot</span>(mu_hat, p_hat)</span></code></pre></div>
<p><img src="070-logit_files/figure-html/unnamed-chunk-3-1.png" width="75%" /></p>
<ul>
<li>係数の信頼区間</li>
</ul>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="ロジットブロビット回帰分析.html#cb215-1" tabindex="-1"></a><span class="co"># 信頼区間</span></span>
<span id="cb215-2"><a href="ロジットブロビット回帰分析.html#cb215-2" tabindex="-1"></a><span class="fu">confint</span>(res_glm)  <span class="co"># 95%信頼区間 (デフォルト)</span></span>
<span id="cb215-3"><a href="ロジットブロビット回帰分析.html#cb215-3" tabindex="-1"></a><span class="co">#&gt;                 2.5 %   97.5 %</span></span>
<span id="cb215-4"><a href="ロジットブロビット回帰分析.html#cb215-4" tabindex="-1"></a><span class="co">#&gt; (Intercept) 1.1914472 4.659417</span></span>
<span id="cb215-5"><a href="ロジットブロビット回帰分析.html#cb215-5" tabindex="-1"></a><span class="co">#&gt; XX1         0.5901329 1.974012</span></span>
<span id="cb215-6"><a href="ロジットブロビット回帰分析.html#cb215-6" tabindex="-1"></a><span class="co">#&gt; XX2         1.5989191 4.620681</span></span>
<span id="cb215-7"><a href="ロジットブロビット回帰分析.html#cb215-7" tabindex="-1"></a><span class="fu">confint</span>(res_glm, <span class="at">level =</span> <span class="fl">0.9</span>)  <span class="co"># 90%信頼区間</span></span>
<span id="cb215-8"><a href="ロジットブロビット回帰分析.html#cb215-8" tabindex="-1"></a><span class="co">#&gt;                   5 %     95 %</span></span>
<span id="cb215-9"><a href="ロジットブロビット回帰分析.html#cb215-9" tabindex="-1"></a><span class="co">#&gt; (Intercept) 1.3787136 4.269921</span></span>
<span id="cb215-10"><a href="ロジットブロビット回帰分析.html#cb215-10" tabindex="-1"></a><span class="co">#&gt; XX1         0.6664132 1.818782</span></span>
<span id="cb215-11"><a href="ロジットブロビット回帰分析.html#cb215-11" tabindex="-1"></a><span class="co">#&gt; XX2         1.7488603 4.265779</span></span></code></pre></div>
</div>
</div>
<div id="データ分析例" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> データ分析例<a href="ロジットブロビット回帰分析.html#データ分析例" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="データセット-1-販売プロモーションデータ-仮想" class="section level3 unnumbered hasAnchor">
<h3>データセット (1): 販売プロモーション・データ (仮想)<a href="ロジットブロビット回帰分析.html#データセット-1-販売プロモーションデータ-仮想" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>- convdat.csv, 8件
  - 商品 (product): A/B
  - 世代 (genZ): Yes/No 
  - K-pop好き (Kpop): Yes/No
  - DM送付数 (n.tot): 人
  - 購入人数 (n.conv): 人
- 注) product--Kpopは, 関数read.csv()でそのまま読み込むと文字型変数となり, 因子型にはならない.  </code></pre>
<ul>
<li>データ読み込み</li>
</ul>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="ロジットブロビット回帰分析.html#cb217-1" tabindex="-1"></a>conv_dat1 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;convdat.txt&quot;</span>, <span class="at">skip =</span> <span class="dv">1</span>)</span>
<span id="cb217-2"><a href="ロジットブロビット回帰分析.html#cb217-2" tabindex="-1"></a><span class="co"># 注) デフォルトはstringsAsFactors = F (文字列を因子型変数に変換せずに読み込む)</span></span>
<span id="cb217-3"><a href="ロジットブロビット回帰分析.html#cb217-3" tabindex="-1"></a><span class="co"># conv_dat1 &lt;- read.csv(&#39;convdat.txt&#39;, skip = 2, stringsAsFactors = T)</span></span>
<span id="cb217-4"><a href="ロジットブロビット回帰分析.html#cb217-4" tabindex="-1"></a><span class="fu">attach</span>(conv_dat1)</span></code></pre></div>
<ul>
<li>ロジット回帰実行</li>
<li>異なるデータ形式への対応</li>
</ul>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="ロジットブロビット回帰分析.html#cb218-1" tabindex="-1"></a><span class="co"># データ形式-1 &#39;成功回数&#39;、&#39;失敗回数&#39;の2列</span></span>
<span id="cb218-2"><a href="ロジットブロビット回帰分析.html#cb218-2" tabindex="-1"></a>conv_tbl <span class="ot">&lt;-</span> <span class="fu">cbind</span>(n.conv, n.tot <span class="sc">-</span> n.conv)</span>
<span id="cb218-3"><a href="ロジットブロビット回帰分析.html#cb218-3" tabindex="-1"></a>res_glm1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(conv_tbl <span class="sc">~</span> product <span class="sc">+</span> genZ <span class="sc">+</span> Kpop, <span class="at">family =</span> binomial)</span>
<span id="cb218-4"><a href="ロジットブロビット回帰分析.html#cb218-4" tabindex="-1"></a><span class="fu">summary</span>(res_glm1)</span>
<span id="cb218-5"><a href="ロジットブロビット回帰分析.html#cb218-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb218-6"><a href="ロジットブロビット回帰分析.html#cb218-6" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb218-7"><a href="ロジットブロビット回帰分析.html#cb218-7" tabindex="-1"></a><span class="co">#&gt; glm(formula = conv_tbl ~ product + genZ + Kpop, family = binomial)</span></span>
<span id="cb218-8"><a href="ロジットブロビット回帰分析.html#cb218-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb218-9"><a href="ロジットブロビット回帰分析.html#cb218-9" tabindex="-1"></a><span class="co">#&gt; Deviance Residuals: </span></span>
<span id="cb218-10"><a href="ロジットブロビット回帰分析.html#cb218-10" tabindex="-1"></a><span class="co">#&gt;        1         2         3         4         5         6         7         8  </span></span>
<span id="cb218-11"><a href="ロジットブロビット回帰分析.html#cb218-11" tabindex="-1"></a><span class="co">#&gt;  0.11781   0.18151   0.15625  -1.18807  -0.35661  -0.40158   0.78239   0.09386  </span></span>
<span id="cb218-12"><a href="ロジットブロビット回帰分析.html#cb218-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb218-13"><a href="ロジットブロビット回帰分析.html#cb218-13" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb218-14"><a href="ロジットブロビット回帰分析.html#cb218-14" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb218-15"><a href="ロジットブロビット回帰分析.html#cb218-15" tabindex="-1"></a><span class="co">#&gt; (Intercept) -2.07205    0.33431  -6.198 5.72e-10 ***</span></span>
<span id="cb218-16"><a href="ロジットブロビット回帰分析.html#cb218-16" tabindex="-1"></a><span class="co">#&gt; productB    -0.07844    0.26926  -0.291  0.77082    </span></span>
<span id="cb218-17"><a href="ロジットブロビット回帰分析.html#cb218-17" tabindex="-1"></a><span class="co">#&gt; genZYes      0.82333    0.27607   2.982  0.00286 ** </span></span>
<span id="cb218-18"><a href="ロジットブロビット回帰分析.html#cb218-18" tabindex="-1"></a><span class="co">#&gt; KpopYes      0.61585    0.35132   1.753  0.07961 .  </span></span>
<span id="cb218-19"><a href="ロジットブロビット回帰分析.html#cb218-19" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb218-20"><a href="ロジットブロビット回帰分析.html#cb218-20" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb218-21"><a href="ロジットブロビット回帰分析.html#cb218-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb218-22"><a href="ロジットブロビット回帰分析.html#cb218-22" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb218-23"><a href="ロジットブロビット回帰分析.html#cb218-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb218-24"><a href="ロジットブロビット回帰分析.html#cb218-24" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 15.2547  on 7  degrees of freedom</span></span>
<span id="cb218-25"><a href="ロジットブロビット回帰分析.html#cb218-25" tabindex="-1"></a><span class="co">#&gt; Residual deviance:  2.3921  on 4  degrees of freedom</span></span>
<span id="cb218-26"><a href="ロジットブロビット回帰分析.html#cb218-26" tabindex="-1"></a><span class="co">#&gt; AIC: 36.198</span></span>
<span id="cb218-27"><a href="ロジットブロビット回帰分析.html#cb218-27" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb218-28"><a href="ロジットブロビット回帰分析.html#cb218-28" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 4</span></span>
<span id="cb218-29"><a href="ロジットブロビット回帰分析.html#cb218-29" tabindex="-1"></a></span>
<span id="cb218-30"><a href="ロジットブロビット回帰分析.html#cb218-30" tabindex="-1"></a>res_glm2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(conv_tbl <span class="sc">~</span> genZ <span class="sc">+</span> Kpop, binomial)</span>
<span id="cb218-31"><a href="ロジットブロビット回帰分析.html#cb218-31" tabindex="-1"></a><span class="fu">summary</span>(res_glm2)</span>
<span id="cb218-32"><a href="ロジットブロビット回帰分析.html#cb218-32" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb218-33"><a href="ロジットブロビット回帰分析.html#cb218-33" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb218-34"><a href="ロジットブロビット回帰分析.html#cb218-34" tabindex="-1"></a><span class="co">#&gt; glm(formula = conv_tbl ~ genZ + Kpop, family = binomial)</span></span>
<span id="cb218-35"><a href="ロジットブロビット回帰分析.html#cb218-35" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb218-36"><a href="ロジットブロビット回帰分析.html#cb218-36" tabindex="-1"></a><span class="co">#&gt; Deviance Residuals: </span></span>
<span id="cb218-37"><a href="ロジットブロビット回帰分析.html#cb218-37" tabindex="-1"></a><span class="co">#&gt;        1         2         3         4         5         6         7         8  </span></span>
<span id="cb218-38"><a href="ロジットブロビット回帰分析.html#cb218-38" tabindex="-1"></a><span class="co">#&gt;  0.16285   0.20322   0.28582  -1.22028  -0.54755  -0.32113   0.66014   0.01463  </span></span>
<span id="cb218-39"><a href="ロジットブロビット回帰分析.html#cb218-39" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb218-40"><a href="ロジットブロビット回帰分析.html#cb218-40" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb218-41"><a href="ロジットブロビット回帰分析.html#cb218-41" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb218-42"><a href="ロジットブロビット回帰分析.html#cb218-42" tabindex="-1"></a><span class="co">#&gt; (Intercept)  -2.0904     0.3286  -6.361    2e-10 ***</span></span>
<span id="cb218-43"><a href="ロジットブロビット回帰分析.html#cb218-43" tabindex="-1"></a><span class="co">#&gt; genZYes       0.8235     0.2760   2.983  0.00285 ** </span></span>
<span id="cb218-44"><a href="ロジットブロビット回帰分析.html#cb218-44" tabindex="-1"></a><span class="co">#&gt; KpopYes       0.6100     0.3507   1.739  0.08200 .  </span></span>
<span id="cb218-45"><a href="ロジットブロビット回帰分析.html#cb218-45" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb218-46"><a href="ロジットブロビット回帰分析.html#cb218-46" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb218-47"><a href="ロジットブロビット回帰分析.html#cb218-47" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb218-48"><a href="ロジットブロビット回帰分析.html#cb218-48" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb218-49"><a href="ロジットブロビット回帰分析.html#cb218-49" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb218-50"><a href="ロジットブロビット回帰分析.html#cb218-50" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 15.2547  on 7  degrees of freedom</span></span>
<span id="cb218-51"><a href="ロジットブロビット回帰分析.html#cb218-51" tabindex="-1"></a><span class="co">#&gt; Residual deviance:  2.4775  on 5  degrees of freedom</span></span>
<span id="cb218-52"><a href="ロジットブロビット回帰分析.html#cb218-52" tabindex="-1"></a><span class="co">#&gt; AIC: 34.284</span></span>
<span id="cb218-53"><a href="ロジットブロビット回帰分析.html#cb218-53" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb218-54"><a href="ロジットブロビット回帰分析.html#cb218-54" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 4</span></span>
<span id="cb218-55"><a href="ロジットブロビット回帰分析.html#cb218-55" tabindex="-1"></a></span>
<span id="cb218-56"><a href="ロジットブロビット回帰分析.html#cb218-56" tabindex="-1"></a>res_glm0 <span class="ot">&lt;-</span> <span class="fu">glm</span>(conv_tbl <span class="sc">~</span> <span class="dv">1</span>, binomial)  <span class="co"># 切片項のみ</span></span>
<span id="cb218-57"><a href="ロジットブロビット回帰分析.html#cb218-57" tabindex="-1"></a><span class="fu">summary</span>(res_glm0)</span>
<span id="cb218-58"><a href="ロジットブロビット回帰分析.html#cb218-58" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb218-59"><a href="ロジットブロビット回帰分析.html#cb218-59" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb218-60"><a href="ロジットブロビット回帰分析.html#cb218-60" tabindex="-1"></a><span class="co">#&gt; glm(formula = conv_tbl ~ 1, family = binomial)</span></span>
<span id="cb218-61"><a href="ロジットブロビット回帰分析.html#cb218-61" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb218-62"><a href="ロジットブロビット回帰分析.html#cb218-62" tabindex="-1"></a><span class="co">#&gt; Deviance Residuals: </span></span>
<span id="cb218-63"><a href="ロジットブロビット回帰分析.html#cb218-63" tabindex="-1"></a><span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span></span>
<span id="cb218-64"><a href="ロジットブロビット回帰分析.html#cb218-64" tabindex="-1"></a><span class="co">#&gt; -1.6946  -1.0354  -0.5135   0.7712   2.2549  </span></span>
<span id="cb218-65"><a href="ロジットブロビット回帰分析.html#cb218-65" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb218-66"><a href="ロジットブロビット回帰分析.html#cb218-66" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb218-67"><a href="ロジットブロビット回帰分析.html#cb218-67" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb218-68"><a href="ロジットブロビット回帰分析.html#cb218-68" tabindex="-1"></a><span class="co">#&gt; (Intercept)  -1.3950     0.1205  -11.58   &lt;2e-16 ***</span></span>
<span id="cb218-69"><a href="ロジットブロビット回帰分析.html#cb218-69" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb218-70"><a href="ロジットブロビット回帰分析.html#cb218-70" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb218-71"><a href="ロジットブロビット回帰分析.html#cb218-71" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb218-72"><a href="ロジットブロビット回帰分析.html#cb218-72" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb218-73"><a href="ロジットブロビット回帰分析.html#cb218-73" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb218-74"><a href="ロジットブロビット回帰分析.html#cb218-74" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 15.255  on 7  degrees of freedom</span></span>
<span id="cb218-75"><a href="ロジットブロビット回帰分析.html#cb218-75" tabindex="-1"></a><span class="co">#&gt; Residual deviance: 15.255  on 7  degrees of freedom</span></span>
<span id="cb218-76"><a href="ロジットブロビット回帰分析.html#cb218-76" tabindex="-1"></a><span class="co">#&gt; AIC: 43.061</span></span>
<span id="cb218-77"><a href="ロジットブロビット回帰分析.html#cb218-77" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb218-78"><a href="ロジットブロビット回帰分析.html#cb218-78" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 4</span></span>
<span id="cb218-79"><a href="ロジットブロビット回帰分析.html#cb218-79" tabindex="-1"></a></span>
<span id="cb218-80"><a href="ロジットブロビット回帰分析.html#cb218-80" tabindex="-1"></a><span class="fu">anova</span>(res_glm2, <span class="at">test =</span> <span class="st">&quot;Chisq&quot;</span>)  <span class="co"># カイ2乗検定 (test = &#39;LRT&#39;でも可)</span></span>
<span id="cb218-81"><a href="ロジットブロビット回帰分析.html#cb218-81" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table</span></span>
<span id="cb218-82"><a href="ロジットブロビット回帰分析.html#cb218-82" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb218-83"><a href="ロジットブロビット回帰分析.html#cb218-83" tabindex="-1"></a><span class="co">#&gt; Model: binomial, link: logit</span></span>
<span id="cb218-84"><a href="ロジットブロビット回帰分析.html#cb218-84" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb218-85"><a href="ロジットブロビット回帰分析.html#cb218-85" tabindex="-1"></a><span class="co">#&gt; Response: conv_tbl</span></span>
<span id="cb218-86"><a href="ロジットブロビット回帰分析.html#cb218-86" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb218-87"><a href="ロジットブロビット回帰分析.html#cb218-87" tabindex="-1"></a><span class="co">#&gt; Terms added sequentially (first to last)</span></span>
<span id="cb218-88"><a href="ロジットブロビット回帰分析.html#cb218-88" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb218-89"><a href="ロジットブロビット回帰分析.html#cb218-89" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb218-90"><a href="ロジットブロビット回帰分析.html#cb218-90" tabindex="-1"></a><span class="co">#&gt;      Df Deviance Resid. Df Resid. Dev Pr(&gt;Chi)   </span></span>
<span id="cb218-91"><a href="ロジットブロビット回帰分析.html#cb218-91" tabindex="-1"></a><span class="co">#&gt; NULL                     7    15.2547            </span></span>
<span id="cb218-92"><a href="ロジットブロビット回帰分析.html#cb218-92" tabindex="-1"></a><span class="co">#&gt; genZ  1   9.4371         6     5.8175 0.002126 **</span></span>
<span id="cb218-93"><a href="ロジットブロビット回帰分析.html#cb218-93" tabindex="-1"></a><span class="co">#&gt; Kpop  1   3.3400         5     2.4775 0.067615 . </span></span>
<span id="cb218-94"><a href="ロジットブロビット回帰分析.html#cb218-94" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb218-95"><a href="ロジットブロビット回帰分析.html#cb218-95" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb218-96"><a href="ロジットブロビット回帰分析.html#cb218-96" tabindex="-1"></a><span class="fu">anova</span>(res_glm2, res_glm0, <span class="at">test =</span> <span class="st">&quot;Chisq&quot;</span>)  <span class="co"># 同</span></span>
<span id="cb218-97"><a href="ロジットブロビット回帰分析.html#cb218-97" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table</span></span>
<span id="cb218-98"><a href="ロジットブロビット回帰分析.html#cb218-98" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb218-99"><a href="ロジットブロビット回帰分析.html#cb218-99" tabindex="-1"></a><span class="co">#&gt; Model 1: conv_tbl ~ genZ + Kpop</span></span>
<span id="cb218-100"><a href="ロジットブロビット回帰分析.html#cb218-100" tabindex="-1"></a><span class="co">#&gt; Model 2: conv_tbl ~ 1</span></span>
<span id="cb218-101"><a href="ロジットブロビット回帰分析.html#cb218-101" tabindex="-1"></a><span class="co">#&gt;   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)   </span></span>
<span id="cb218-102"><a href="ロジットブロビット回帰分析.html#cb218-102" tabindex="-1"></a><span class="co">#&gt; 1         5     2.4775                        </span></span>
<span id="cb218-103"><a href="ロジットブロビット回帰分析.html#cb218-103" tabindex="-1"></a><span class="co">#&gt; 2         7    15.2547 -2  -12.777 0.001681 **</span></span>
<span id="cb218-104"><a href="ロジットブロビット回帰分析.html#cb218-104" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb218-105"><a href="ロジットブロビット回帰分析.html#cb218-105" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="ロジットブロビット回帰分析.html#cb219-1" tabindex="-1"></a><span class="co"># データ形式-2 &#39;成功率&#39;の指定</span></span>
<span id="cb219-2"><a href="ロジットブロビット回帰分析.html#cb219-2" tabindex="-1"></a>prop_conv <span class="ot">&lt;-</span> n.conv<span class="sc">/</span>n.tot</span>
<span id="cb219-3"><a href="ロジットブロビット回帰分析.html#cb219-3" tabindex="-1"></a>res_glm1_2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(prop_conv <span class="sc">~</span> product <span class="sc">+</span> genZ <span class="sc">+</span> Kpop, binomial, <span class="at">weights =</span> n.tot)</span>
<span id="cb219-4"><a href="ロジットブロビット回帰分析.html#cb219-4" tabindex="-1"></a><span class="fu">summary</span>(res_glm1_2)</span>
<span id="cb219-5"><a href="ロジットブロビット回帰分析.html#cb219-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb219-6"><a href="ロジットブロビット回帰分析.html#cb219-6" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb219-7"><a href="ロジットブロビット回帰分析.html#cb219-7" tabindex="-1"></a><span class="co">#&gt; glm(formula = prop_conv ~ product + genZ + Kpop, family = binomial, </span></span>
<span id="cb219-8"><a href="ロジットブロビット回帰分析.html#cb219-8" tabindex="-1"></a><span class="co">#&gt;     weights = n.tot)</span></span>
<span id="cb219-9"><a href="ロジットブロビット回帰分析.html#cb219-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb219-10"><a href="ロジットブロビット回帰分析.html#cb219-10" tabindex="-1"></a><span class="co">#&gt; Deviance Residuals: </span></span>
<span id="cb219-11"><a href="ロジットブロビット回帰分析.html#cb219-11" tabindex="-1"></a><span class="co">#&gt;        1         2         3         4         5         6         7         8  </span></span>
<span id="cb219-12"><a href="ロジットブロビット回帰分析.html#cb219-12" tabindex="-1"></a><span class="co">#&gt;  0.11781   0.18151   0.15625  -1.18807  -0.35661  -0.40158   0.78239   0.09386  </span></span>
<span id="cb219-13"><a href="ロジットブロビット回帰分析.html#cb219-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb219-14"><a href="ロジットブロビット回帰分析.html#cb219-14" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb219-15"><a href="ロジットブロビット回帰分析.html#cb219-15" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb219-16"><a href="ロジットブロビット回帰分析.html#cb219-16" tabindex="-1"></a><span class="co">#&gt; (Intercept) -2.07205    0.33431  -6.198 5.72e-10 ***</span></span>
<span id="cb219-17"><a href="ロジットブロビット回帰分析.html#cb219-17" tabindex="-1"></a><span class="co">#&gt; productB    -0.07844    0.26926  -0.291  0.77082    </span></span>
<span id="cb219-18"><a href="ロジットブロビット回帰分析.html#cb219-18" tabindex="-1"></a><span class="co">#&gt; genZYes      0.82333    0.27607   2.982  0.00286 ** </span></span>
<span id="cb219-19"><a href="ロジットブロビット回帰分析.html#cb219-19" tabindex="-1"></a><span class="co">#&gt; KpopYes      0.61585    0.35132   1.753  0.07961 .  </span></span>
<span id="cb219-20"><a href="ロジットブロビット回帰分析.html#cb219-20" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb219-21"><a href="ロジットブロビット回帰分析.html#cb219-21" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb219-22"><a href="ロジットブロビット回帰分析.html#cb219-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb219-23"><a href="ロジットブロビット回帰分析.html#cb219-23" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb219-24"><a href="ロジットブロビット回帰分析.html#cb219-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb219-25"><a href="ロジットブロビット回帰分析.html#cb219-25" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 15.2547  on 7  degrees of freedom</span></span>
<span id="cb219-26"><a href="ロジットブロビット回帰分析.html#cb219-26" tabindex="-1"></a><span class="co">#&gt; Residual deviance:  2.3921  on 4  degrees of freedom</span></span>
<span id="cb219-27"><a href="ロジットブロビット回帰分析.html#cb219-27" tabindex="-1"></a><span class="co">#&gt; AIC: 36.198</span></span>
<span id="cb219-28"><a href="ロジットブロビット回帰分析.html#cb219-28" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb219-29"><a href="ロジットブロビット回帰分析.html#cb219-29" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 4</span></span></code></pre></div>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="ロジットブロビット回帰分析.html#cb220-1" tabindex="-1"></a><span class="co"># プロビット回帰</span></span>
<span id="cb220-2"><a href="ロジットブロビット回帰分析.html#cb220-2" tabindex="-1"></a>res_glm2_p <span class="ot">&lt;-</span> <span class="fu">glm</span>(conv_tbl <span class="sc">~</span> genZ <span class="sc">+</span> Kpop, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;probit&quot;</span>))  <span class="co"># probit</span></span>
<span id="cb220-3"><a href="ロジットブロビット回帰分析.html#cb220-3" tabindex="-1"></a><span class="fu">summary</span>(res_glm2_p)</span>
<span id="cb220-4"><a href="ロジットブロビット回帰分析.html#cb220-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb220-5"><a href="ロジットブロビット回帰分析.html#cb220-5" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb220-6"><a href="ロジットブロビット回帰分析.html#cb220-6" tabindex="-1"></a><span class="co">#&gt; glm(formula = conv_tbl ~ genZ + Kpop, family = binomial(link = &quot;probit&quot;))</span></span>
<span id="cb220-7"><a href="ロジットブロビット回帰分析.html#cb220-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb220-8"><a href="ロジットブロビット回帰分析.html#cb220-8" tabindex="-1"></a><span class="co">#&gt; Deviance Residuals: </span></span>
<span id="cb220-9"><a href="ロジットブロビット回帰分析.html#cb220-9" tabindex="-1"></a><span class="co">#&gt;        1         2         3         4         5         6         7         8  </span></span>
<span id="cb220-10"><a href="ロジットブロビット回帰分析.html#cb220-10" tabindex="-1"></a><span class="co">#&gt;  0.17291   0.15015   0.27674  -1.24447  -0.55358  -0.29829   0.67558   0.02009  </span></span>
<span id="cb220-11"><a href="ロジットブロビット回帰分析.html#cb220-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb220-12"><a href="ロジットブロビット回帰分析.html#cb220-12" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb220-13"><a href="ロジットブロビット回帰分析.html#cb220-13" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb220-14"><a href="ロジットブロビット回帰分析.html#cb220-14" tabindex="-1"></a><span class="co">#&gt; (Intercept)  -1.2285     0.1742  -7.053 1.75e-12 ***</span></span>
<span id="cb220-15"><a href="ロジットブロビット回帰分析.html#cb220-15" tabindex="-1"></a><span class="co">#&gt; genZYes       0.4814     0.1644   2.929   0.0034 ** </span></span>
<span id="cb220-16"><a href="ロジットブロビット回帰分析.html#cb220-16" tabindex="-1"></a><span class="co">#&gt; KpopYes       0.3343     0.1886   1.773   0.0763 .  </span></span>
<span id="cb220-17"><a href="ロジットブロビット回帰分析.html#cb220-17" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb220-18"><a href="ロジットブロビット回帰分析.html#cb220-18" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb220-19"><a href="ロジットブロビット回帰分析.html#cb220-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb220-20"><a href="ロジットブロビット回帰分析.html#cb220-20" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb220-21"><a href="ロジットブロビット回帰分析.html#cb220-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb220-22"><a href="ロジットブロビット回帰分析.html#cb220-22" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 15.255  on 7  degrees of freedom</span></span>
<span id="cb220-23"><a href="ロジットブロビット回帰分析.html#cb220-23" tabindex="-1"></a><span class="co">#&gt; Residual deviance:  2.530  on 5  degrees of freedom</span></span>
<span id="cb220-24"><a href="ロジットブロビット回帰分析.html#cb220-24" tabindex="-1"></a><span class="co">#&gt; AIC: 34.336</span></span>
<span id="cb220-25"><a href="ロジットブロビット回帰分析.html#cb220-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb220-26"><a href="ロジットブロビット回帰分析.html#cb220-26" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 3</span></span></code></pre></div>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="ロジットブロビット回帰分析.html#cb221-1" tabindex="-1"></a><span class="co"># ロジット回帰 (再実行)</span></span>
<span id="cb221-2"><a href="ロジットブロビット回帰分析.html#cb221-2" tabindex="-1"></a>res_glm2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(conv_tbl <span class="sc">~</span> genZ <span class="sc">+</span> Kpop, binomial)  <span class="co"># simpler, logit</span></span>
<span id="cb221-3"><a href="ロジットブロビット回帰分析.html#cb221-3" tabindex="-1"></a><span class="fu">summary</span>(res_glm2)</span>
<span id="cb221-4"><a href="ロジットブロビット回帰分析.html#cb221-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb221-5"><a href="ロジットブロビット回帰分析.html#cb221-5" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb221-6"><a href="ロジットブロビット回帰分析.html#cb221-6" tabindex="-1"></a><span class="co">#&gt; glm(formula = conv_tbl ~ genZ + Kpop, family = binomial)</span></span>
<span id="cb221-7"><a href="ロジットブロビット回帰分析.html#cb221-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb221-8"><a href="ロジットブロビット回帰分析.html#cb221-8" tabindex="-1"></a><span class="co">#&gt; Deviance Residuals: </span></span>
<span id="cb221-9"><a href="ロジットブロビット回帰分析.html#cb221-9" tabindex="-1"></a><span class="co">#&gt;        1         2         3         4         5         6         7         8  </span></span>
<span id="cb221-10"><a href="ロジットブロビット回帰分析.html#cb221-10" tabindex="-1"></a><span class="co">#&gt;  0.16285   0.20322   0.28582  -1.22028  -0.54755  -0.32113   0.66014   0.01463  </span></span>
<span id="cb221-11"><a href="ロジットブロビット回帰分析.html#cb221-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb221-12"><a href="ロジットブロビット回帰分析.html#cb221-12" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb221-13"><a href="ロジットブロビット回帰分析.html#cb221-13" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb221-14"><a href="ロジットブロビット回帰分析.html#cb221-14" tabindex="-1"></a><span class="co">#&gt; (Intercept)  -2.0904     0.3286  -6.361    2e-10 ***</span></span>
<span id="cb221-15"><a href="ロジットブロビット回帰分析.html#cb221-15" tabindex="-1"></a><span class="co">#&gt; genZYes       0.8235     0.2760   2.983  0.00285 ** </span></span>
<span id="cb221-16"><a href="ロジットブロビット回帰分析.html#cb221-16" tabindex="-1"></a><span class="co">#&gt; KpopYes       0.6100     0.3507   1.739  0.08200 .  </span></span>
<span id="cb221-17"><a href="ロジットブロビット回帰分析.html#cb221-17" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb221-18"><a href="ロジットブロビット回帰分析.html#cb221-18" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb221-19"><a href="ロジットブロビット回帰分析.html#cb221-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb221-20"><a href="ロジットブロビット回帰分析.html#cb221-20" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb221-21"><a href="ロジットブロビット回帰分析.html#cb221-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb221-22"><a href="ロジットブロビット回帰分析.html#cb221-22" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 15.2547  on 7  degrees of freedom</span></span>
<span id="cb221-23"><a href="ロジットブロビット回帰分析.html#cb221-23" tabindex="-1"></a><span class="co">#&gt; Residual deviance:  2.4775  on 5  degrees of freedom</span></span>
<span id="cb221-24"><a href="ロジットブロビット回帰分析.html#cb221-24" tabindex="-1"></a><span class="co">#&gt; AIC: 34.284</span></span>
<span id="cb221-25"><a href="ロジットブロビット回帰分析.html#cb221-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb221-26"><a href="ロジットブロビット回帰分析.html#cb221-26" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 4</span></span>
<span id="cb221-27"><a href="ロジットブロビット回帰分析.html#cb221-27" tabindex="-1"></a></span>
<span id="cb221-28"><a href="ロジットブロビット回帰分析.html#cb221-28" tabindex="-1"></a><span class="co"># モデル診断 plot(res_glm2)</span></span></code></pre></div>
<ul>
<li>予測</li>
</ul>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="ロジットブロビット回帰分析.html#cb222-1" tabindex="-1"></a><span class="co"># 予測</span></span>
<span id="cb222-2"><a href="ロジットブロビット回帰分析.html#cb222-2" tabindex="-1"></a><span class="fu">predict</span>(res_glm2)  <span class="co"># 対数オッズ</span></span>
<span id="cb222-3"><a href="ロジットブロビット回帰分析.html#cb222-3" tabindex="-1"></a><span class="co">#&gt;         1         2         3         4         5         6         7         8 </span></span>
<span id="cb222-4"><a href="ロジットブロビット回帰分析.html#cb222-4" tabindex="-1"></a><span class="co">#&gt; -2.090427 -1.266936 -1.480454 -1.266936 -1.480454 -0.656963 -0.656963 -2.090427</span></span>
<span id="cb222-5"><a href="ロジットブロビット回帰分析.html#cb222-5" tabindex="-1"></a>p_hat <span class="ot">&lt;-</span> <span class="fu">predict</span>(res_glm2, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)  <span class="co"># 確率</span></span>
<span id="cb222-6"><a href="ロジットブロビット回帰分析.html#cb222-6" tabindex="-1"></a><span class="fu">data.frame</span>(conv_dat1, p_hat)</span>
<span id="cb222-7"><a href="ロジットブロビット回帰分析.html#cb222-7" tabindex="-1"></a><span class="co">#&gt;   product genZ Kpop n.tot n.conv     p_hat</span></span>
<span id="cb222-8"><a href="ロジットブロビット回帰分析.html#cb222-8" tabindex="-1"></a><span class="co">#&gt; 1       A   No   No    60      7 0.1100307</span></span>
<span id="cb222-9"><a href="ロジットブロビット回帰分析.html#cb222-9" tabindex="-1"></a><span class="co">#&gt; 2       A  Yes   No     8      2 0.2197822</span></span>
<span id="cb222-10"><a href="ロジットブロビット回帰分析.html#cb222-10" tabindex="-1"></a><span class="co">#&gt; 3       A   No  Yes   186     36 0.1853588</span></span>
<span id="cb222-11"><a href="ロジットブロビット回帰分析.html#cb222-11" tabindex="-1"></a><span class="co">#&gt; 4       B  Yes   No     3      0 0.2197822</span></span>
<span id="cb222-12"><a href="ロジットブロビット回帰分析.html#cb222-12" tabindex="-1"></a><span class="co">#&gt; 5       B   No  Yes    86     14 0.1853588</span></span>
<span id="cb222-13"><a href="ロジットブロビット回帰分析.html#cb222-13" tabindex="-1"></a><span class="co">#&gt; 6       A  Yes  Yes    50     16 0.3414222</span></span>
<span id="cb222-14"><a href="ロジットブロビット回帰分析.html#cb222-14" tabindex="-1"></a><span class="co">#&gt; 7       B  Yes  Yes    22      9 0.3414222</span></span>
<span id="cb222-15"><a href="ロジットブロビット回帰分析.html#cb222-15" tabindex="-1"></a><span class="co">#&gt; 8       B   No   No    18      2 0.1100307</span></span>
<span id="cb222-16"><a href="ロジットブロビット回帰分析.html#cb222-16" tabindex="-1"></a></span>
<span id="cb222-17"><a href="ロジットブロビット回帰分析.html#cb222-17" tabindex="-1"></a><span class="co"># 注) 説明変数が因子型(factor)でない場合, 以下エラーとなる (read.csvで,</span></span>
<span id="cb222-18"><a href="ロジットブロビット回帰分析.html#cb222-18" tabindex="-1"></a><span class="co"># stringsAsFactors = Tを指定していた場合はOK) plot(genZ, predict(res_glm2, type</span></span>
<span id="cb222-19"><a href="ロジットブロビット回帰分析.html#cb222-19" tabindex="-1"></a><span class="co"># = &#39;response&#39;)) plot(cat, predict(res_glm2, type = &#39;response&#39;)) すなわち,</span></span>
<span id="cb222-20"><a href="ロジットブロビット回帰分析.html#cb222-20" tabindex="-1"></a><span class="co"># 文字列型のままの場合, は因子型に一旦変換が必要 plot(factor(genZ),</span></span>
<span id="cb222-21"><a href="ロジットブロビット回帰分析.html#cb222-21" tabindex="-1"></a><span class="co"># predict(res_glm2, type = &#39;response&#39;)) plot(factor(cat), predict(res_glm2,</span></span>
<span id="cb222-22"><a href="ロジットブロビット回帰分析.html#cb222-22" tabindex="-1"></a><span class="co"># type = &#39;response&#39;))</span></span>
<span id="cb222-23"><a href="ロジットブロビット回帰分析.html#cb222-23" tabindex="-1"></a></span>
<span id="cb222-24"><a href="ロジットブロビット回帰分析.html#cb222-24" tabindex="-1"></a><span class="co"># 説明変数が数値型変数ならば、logistic曲線を描く</span></span></code></pre></div>
<ul>
<li>係数の信頼区間</li>
</ul>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="ロジットブロビット回帰分析.html#cb223-1" tabindex="-1"></a><span class="co"># 信頼区間</span></span>
<span id="cb223-2"><a href="ロジットブロビット回帰分析.html#cb223-2" tabindex="-1"></a><span class="fu">confint</span>(res_glm1_2)  <span class="co"># 95%信頼区間 (デフォルト)</span></span>
<span id="cb223-3"><a href="ロジットブロビット回帰分析.html#cb223-3" tabindex="-1"></a><span class="co">#&gt;                   2.5 %     97.5 %</span></span>
<span id="cb223-4"><a href="ロジットブロビット回帰分析.html#cb223-4" tabindex="-1"></a><span class="co">#&gt; (Intercept) -2.78200808 -1.4598384</span></span>
<span id="cb223-5"><a href="ロジットブロビット回帰分析.html#cb223-5" tabindex="-1"></a><span class="co">#&gt; productB    -0.61946141  0.4396708</span></span>
<span id="cb223-6"><a href="ロジットブロビット回帰分析.html#cb223-6" tabindex="-1"></a><span class="co">#&gt; genZYes      0.27372310  1.3592877</span></span>
<span id="cb223-7"><a href="ロジットブロビット回帰分析.html#cb223-7" tabindex="-1"></a><span class="co">#&gt; KpopYes     -0.03750972  1.3520115</span></span>
<span id="cb223-8"><a href="ロジットブロビット回帰分析.html#cb223-8" tabindex="-1"></a><span class="fu">confint</span>(res_glm1_2, <span class="at">level =</span> <span class="fl">0.9</span>)  <span class="co"># 90%信頼区間</span></span>
<span id="cb223-9"><a href="ロジットブロビット回帰分析.html#cb223-9" tabindex="-1"></a><span class="co">#&gt;                     5 %       95 %</span></span>
<span id="cb223-10"><a href="ロジットブロビット回帰分析.html#cb223-10" tabindex="-1"></a><span class="co">#&gt; (Intercept) -2.65972908 -1.5530190</span></span>
<span id="cb223-11"><a href="ロジットブロビット回帰分析.html#cb223-11" tabindex="-1"></a><span class="co">#&gt; productB    -0.53045473  0.3574811</span></span>
<span id="cb223-12"><a href="ロジットブロビット回帰分析.html#cb223-12" tabindex="-1"></a><span class="co">#&gt; genZYes      0.36344375  1.2736384</span></span>
<span id="cb223-13"><a href="ロジットブロビット回帰分析.html#cb223-13" tabindex="-1"></a><span class="co">#&gt; KpopYes      0.06339516  1.2264225</span></span>
<span id="cb223-14"><a href="ロジットブロビット回帰分析.html#cb223-14" tabindex="-1"></a></span>
<span id="cb223-15"><a href="ロジットブロビット回帰分析.html#cb223-15" tabindex="-1"></a><span class="fu">detach</span>()</span></code></pre></div>
</div>
<div id="データセット-2-個人ローンデフォルトデータ-仮想" class="section level3 unnumbered hasAnchor">
<h3>データセット (2): 個人ローン・デフォルト・データ (仮想)<a href="ロジットブロビット回帰分析.html#データセット-2-個人ローンデフォルトデータ-仮想" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>- default.csv, 100件
  - デフォルト (1/0)
  - ローン残高 (万円) 
  - 収入 (万円)
  - 職種 (A/B)</code></pre>
<ul>
<li>データ読み込み</li>
</ul>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="ロジットブロビット回帰分析.html#cb225-1" tabindex="-1"></a>default <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;default.csv&quot;</span>)</span>
<span id="cb225-2"><a href="ロジットブロビット回帰分析.html#cb225-2" tabindex="-1"></a><span class="fu">attach</span>(default)</span></code></pre></div>
<ul>
<li>ロジット回帰</li>
</ul>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="ロジットブロビット回帰分析.html#cb226-1" tabindex="-1"></a><span class="co"># ロジット回帰</span></span>
<span id="cb226-2"><a href="ロジットブロビット回帰分析.html#cb226-2" tabindex="-1"></a>res_glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(デフォルト <span class="sc">~</span> ローン残高 <span class="sc">+</span> 収入 <span class="sc">+</span> 職種, <span class="at">family =</span> binomial)</span>
<span id="cb226-3"><a href="ロジットブロビット回帰分析.html#cb226-3" tabindex="-1"></a><span class="fu">summary</span>(res_glm)</span>
<span id="cb226-4"><a href="ロジットブロビット回帰分析.html#cb226-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb226-5"><a href="ロジットブロビット回帰分析.html#cb226-5" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb226-6"><a href="ロジットブロビット回帰分析.html#cb226-6" tabindex="-1"></a><span class="co">#&gt; glm(formula = デフォルト ~ ローン残高 + 収入 + 職種, </span></span>
<span id="cb226-7"><a href="ロジットブロビット回帰分析.html#cb226-7" tabindex="-1"></a><span class="co">#&gt;     family = binomial)</span></span>
<span id="cb226-8"><a href="ロジットブロビット回帰分析.html#cb226-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb226-9"><a href="ロジットブロビット回帰分析.html#cb226-9" tabindex="-1"></a><span class="co">#&gt; Deviance Residuals: </span></span>
<span id="cb226-10"><a href="ロジットブロビット回帰分析.html#cb226-10" tabindex="-1"></a><span class="co">#&gt;      Min        1Q    Median        3Q       Max  </span></span>
<span id="cb226-11"><a href="ロジットブロビット回帰分析.html#cb226-11" tabindex="-1"></a><span class="co">#&gt; -2.20685  -0.21788  -0.04981  -0.00258   2.84704  </span></span>
<span id="cb226-12"><a href="ロジットブロビット回帰分析.html#cb226-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb226-13"><a href="ロジットブロビット回帰分析.html#cb226-13" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb226-14"><a href="ロジットブロビット回帰分析.html#cb226-14" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb226-15"><a href="ロジットブロビット回帰分析.html#cb226-15" tabindex="-1"></a><span class="co">#&gt; (Intercept) -1.336e+01  3.505e+00  -3.811 0.000138 ***</span></span>
<span id="cb226-16"><a href="ロジットブロビット回帰分析.html#cb226-16" tabindex="-1"></a><span class="co">#&gt; ローン残高   4.708e-03  1.224e-03   3.846 0.000120 ***</span></span>
<span id="cb226-17"><a href="ロジットブロビット回帰分析.html#cb226-17" tabindex="-1"></a><span class="co">#&gt; 収入        -9.227e-04  2.345e-03  -0.394 0.693925    </span></span>
<span id="cb226-18"><a href="ロジットブロビット回帰分析.html#cb226-18" tabindex="-1"></a><span class="co">#&gt; 職種B        9.713e-01  1.445e+00   0.672 0.501434    </span></span>
<span id="cb226-19"><a href="ロジットブロビット回帰分析.html#cb226-19" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb226-20"><a href="ロジットブロビット回帰分析.html#cb226-20" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb226-21"><a href="ロジットブロビット回帰分析.html#cb226-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb226-22"><a href="ロジットブロビット回帰分析.html#cb226-22" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb226-23"><a href="ロジットブロビット回帰分析.html#cb226-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb226-24"><a href="ロジットブロビット回帰分析.html#cb226-24" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 102.791  on 99  degrees of freedom</span></span>
<span id="cb226-25"><a href="ロジットブロビット回帰分析.html#cb226-25" tabindex="-1"></a><span class="co">#&gt; Residual deviance:  46.971  on 96  degrees of freedom</span></span>
<span id="cb226-26"><a href="ロジットブロビット回帰分析.html#cb226-26" tabindex="-1"></a><span class="co">#&gt; AIC: 54.971</span></span>
<span id="cb226-27"><a href="ロジットブロビット回帰分析.html#cb226-27" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb226-28"><a href="ロジットブロビット回帰分析.html#cb226-28" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 8</span></span>
<span id="cb226-29"><a href="ロジットブロビット回帰分析.html#cb226-29" tabindex="-1"></a></span>
<span id="cb226-30"><a href="ロジットブロビット回帰分析.html#cb226-30" tabindex="-1"></a><span class="fu">plot</span>(ローン残高, <span class="fu">predict</span>(res_glm, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>))</span></code></pre></div>
<p><img src="070-logit_files/figure-html/unnamed-chunk-10-1.png" width="75%" /></p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="ロジットブロビット回帰分析.html#cb227-1" tabindex="-1"></a><span class="fu">plot</span>(収入, <span class="fu">predict</span>(res_glm, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>))</span></code></pre></div>
<p><img src="070-logit_files/figure-html/unnamed-chunk-10-2.png" width="75%" /></p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="ロジットブロビット回帰分析.html#cb228-1" tabindex="-1"></a><span class="co"># plot(職種, predict(res_glm, type = &#39;response&#39;))</span></span></code></pre></div>
<ul>
<li>プロビット回帰</li>
</ul>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="ロジットブロビット回帰分析.html#cb229-1" tabindex="-1"></a><span class="co"># プロビット回帰</span></span>
<span id="cb229-2"><a href="ロジットブロビット回帰分析.html#cb229-2" tabindex="-1"></a>res_glm_p <span class="ot">&lt;-</span> <span class="fu">glm</span>(デフォルト <span class="sc">~</span> ローン残高 <span class="sc">+</span> 収入 <span class="sc">+</span> 職種, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;probit&quot;</span>))</span>
<span id="cb229-3"><a href="ロジットブロビット回帰分析.html#cb229-3" tabindex="-1"></a><span class="fu">summary</span>(res_glm_p)</span>
<span id="cb229-4"><a href="ロジットブロビット回帰分析.html#cb229-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb229-5"><a href="ロジットブロビット回帰分析.html#cb229-5" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb229-6"><a href="ロジットブロビット回帰分析.html#cb229-6" tabindex="-1"></a><span class="co">#&gt; glm(formula = デフォルト ~ ローン残高 + 収入 + 職種, </span></span>
<span id="cb229-7"><a href="ロジットブロビット回帰分析.html#cb229-7" tabindex="-1"></a><span class="co">#&gt;     family = binomial(link = &quot;probit&quot;))</span></span>
<span id="cb229-8"><a href="ロジットブロビット回帰分析.html#cb229-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb229-9"><a href="ロジットブロビット回帰分析.html#cb229-9" tabindex="-1"></a><span class="co">#&gt; Deviance Residuals: </span></span>
<span id="cb229-10"><a href="ロジットブロビット回帰分析.html#cb229-10" tabindex="-1"></a><span class="co">#&gt;      Min        1Q    Median        3Q       Max  </span></span>
<span id="cb229-11"><a href="ロジットブロビット回帰分析.html#cb229-11" tabindex="-1"></a><span class="co">#&gt; -2.10245  -0.22078  -0.02316  -0.00001   2.80240  </span></span>
<span id="cb229-12"><a href="ロジットブロビット回帰分析.html#cb229-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb229-13"><a href="ロジットブロビット回帰分析.html#cb229-13" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb229-14"><a href="ロジットブロビット回帰分析.html#cb229-14" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb229-15"><a href="ロジットブロビット回帰分析.html#cb229-15" tabindex="-1"></a><span class="co">#&gt; (Intercept) -7.0233825  1.6903093  -4.155 3.25e-05 ***</span></span>
<span id="cb229-16"><a href="ロジットブロビット回帰分析.html#cb229-16" tabindex="-1"></a><span class="co">#&gt; ローン残高   0.0024920  0.0005893   4.229 2.35e-05 ***</span></span>
<span id="cb229-17"><a href="ロジットブロビット回帰分析.html#cb229-17" tabindex="-1"></a><span class="co">#&gt; 収入        -0.0006478  0.0013082  -0.495    0.620    </span></span>
<span id="cb229-18"><a href="ロジットブロビット回帰分析.html#cb229-18" tabindex="-1"></a><span class="co">#&gt; 職種B        0.6549554  0.8035424   0.815    0.415    </span></span>
<span id="cb229-19"><a href="ロジットブロビット回帰分析.html#cb229-19" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb229-20"><a href="ロジットブロビット回帰分析.html#cb229-20" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb229-21"><a href="ロジットブロビット回帰分析.html#cb229-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb229-22"><a href="ロジットブロビット回帰分析.html#cb229-22" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb229-23"><a href="ロジットブロビット回帰分析.html#cb229-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb229-24"><a href="ロジットブロビット回帰分析.html#cb229-24" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 102.79  on 99  degrees of freedom</span></span>
<span id="cb229-25"><a href="ロジットブロビット回帰分析.html#cb229-25" tabindex="-1"></a><span class="co">#&gt; Residual deviance:  47.81  on 96  degrees of freedom</span></span>
<span id="cb229-26"><a href="ロジットブロビット回帰分析.html#cb229-26" tabindex="-1"></a><span class="co">#&gt; AIC: 55.81</span></span>
<span id="cb229-27"><a href="ロジットブロビット回帰分析.html#cb229-27" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb229-28"><a href="ロジットブロビット回帰分析.html#cb229-28" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 8</span></span>
<span id="cb229-29"><a href="ロジットブロビット回帰分析.html#cb229-29" tabindex="-1"></a></span>
<span id="cb229-30"><a href="ロジットブロビット回帰分析.html#cb229-30" tabindex="-1"></a><span class="do">## 結果の比較: glm vs lm res_glm_normal &lt;- glm(デフォルト ~ ローン残高 + 収入 +</span></span>
<span id="cb229-31"><a href="ロジットブロビット回帰分析.html#cb229-31" tabindex="-1"></a><span class="do">## 職種, family = gaussian) summary(res_glm_normal) res_lm &lt;- lm(デフォルト ~</span></span>
<span id="cb229-32"><a href="ロジットブロビット回帰分析.html#cb229-32" tabindex="-1"></a><span class="do">## ローン残高 + 収入 + 職種) anova(res_lm)</span></span></code></pre></div>
<ul>
<li>予測</li>
</ul>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="ロジットブロビット回帰分析.html#cb230-1" tabindex="-1"></a><span class="co"># 予測 (新しいデータセットに対して)</span></span>
<span id="cb230-2"><a href="ロジットブロビット回帰分析.html#cb230-2" tabindex="-1"></a>newdat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(ローン残高 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>, <span class="dv">10000</span>), 収入 <span class="ot">=</span> <span class="dv">30000</span>,</span>
<span id="cb230-3"><a href="ロジットブロビット回帰分析.html#cb230-3" tabindex="-1"></a>  職種 <span class="ot">=</span> <span class="st">&quot;A&quot;</span>)</span>
<span id="cb230-4"><a href="ロジットブロビット回帰分析.html#cb230-4" tabindex="-1"></a><span class="fu">predict</span>(res_glm, <span class="at">newdata =</span> newdat, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb230-5"><a href="ロジットブロビット回帰分析.html#cb230-5" tabindex="-1"></a><span class="co">#&gt;            1            2            3            4 </span></span>
<span id="cb230-6"><a href="ロジットブロビット回帰分析.html#cb230-6" tabindex="-1"></a><span class="co">#&gt; 2.220446e-16 2.220446e-16 2.220446e-16 9.976404e-01</span></span></code></pre></div>
<ul>
<li>係数の信頼区間</li>
</ul>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="ロジットブロビット回帰分析.html#cb231-1" tabindex="-1"></a><span class="co"># 信頼区間</span></span>
<span id="cb231-2"><a href="ロジットブロビット回帰分析.html#cb231-2" tabindex="-1"></a><span class="fu">confint</span>(res_glm)  <span class="co"># 95%信頼区間 (デフォルト)</span></span>
<span id="cb231-3"><a href="ロジットブロビット回帰分析.html#cb231-3" tabindex="-1"></a><span class="co">#&gt;                     2.5 %       97.5 %</span></span>
<span id="cb231-4"><a href="ロジットブロビット回帰分析.html#cb231-4" tabindex="-1"></a><span class="co">#&gt; (Intercept) -21.713657994 -7.721969240</span></span>
<span id="cb231-5"><a href="ロジットブロビット回帰分析.html#cb231-5" tabindex="-1"></a><span class="co">#&gt; ローン残高    0.002743950  0.007642011</span></span>
<span id="cb231-6"><a href="ロジットブロビット回帰分析.html#cb231-6" tabindex="-1"></a><span class="co">#&gt; 収入         -0.005498298  0.003877354</span></span>
<span id="cb231-7"><a href="ロジットブロビット回帰分析.html#cb231-7" tabindex="-1"></a><span class="co">#&gt; 職種B        -1.917922786  3.862413416</span></span>
<span id="cb231-8"><a href="ロジットブロビット回帰分析.html#cb231-8" tabindex="-1"></a></span>
<span id="cb231-9"><a href="ロジットブロビット回帰分析.html#cb231-9" tabindex="-1"></a><span class="fu">detach</span>()</span></code></pre></div>
</div>
</div>
<div id="疑似r2の計算" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> 疑似R2の計算<a href="ロジットブロビット回帰分析.html#疑似r2の計算" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="ロジットブロビット回帰分析.html#cb232-1" tabindex="-1"></a><span class="co"># ロジット回帰</span></span>
<span id="cb232-2"><a href="ロジットブロビット回帰分析.html#cb232-2" tabindex="-1"></a>res_glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(デフォルト <span class="sc">~</span> ローン残高 <span class="sc">+</span> 収入 <span class="sc">+</span> 職種, <span class="at">family =</span> binomial,</span>
<span id="cb232-3"><a href="ロジットブロビット回帰分析.html#cb232-3" tabindex="-1"></a>  <span class="at">data =</span> default)</span>
<span id="cb232-4"><a href="ロジットブロビット回帰分析.html#cb232-4" tabindex="-1"></a><span class="co"># summary(res_glm)</span></span></code></pre></div>
<div id="パッケージdesctoolsの利用" class="section level3 unnumbered hasAnchor">
<h3>パッケージDescToolsの利用<a href="ロジットブロビット回帰分析.html#パッケージdesctoolsの利用" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>DescTools::PseudoR2()
- usage: PseudoR2(x, which = NULL)
  - which: 計算したい疑似R2. 
    選択肢: &quot;McFadden&quot;(デフォルト), &quot;McFaddenAdj&quot;, &quot;CoxSnell&quot;, &quot;Nagelkerke&quot;, &quot;AldrichNelson&quot;, &quot;VeallZimmermann&quot;, &quot;Efron&quot;, &quot;McKelveyZavoina&quot;, &quot;Tjur&quot;, &quot;all&quot;.</code></pre>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="ロジットブロビット回帰分析.html#cb234-1" tabindex="-1"></a><span class="co"># 疑似R2の計算</span></span>
<span id="cb234-2"><a href="ロジットブロビット回帰分析.html#cb234-2" tabindex="-1"></a><span class="fu">library</span>(DescTools)</span>
<span id="cb234-3"><a href="ロジットブロビット回帰分析.html#cb234-3" tabindex="-1"></a><span class="fu">PseudoR2</span>(res_glm)  <span class="co"># McFadden (デフォルト)</span></span>
<span id="cb234-4"><a href="ロジットブロビット回帰分析.html#cb234-4" tabindex="-1"></a><span class="co">#&gt;  McFadden </span></span>
<span id="cb234-5"><a href="ロジットブロビット回帰分析.html#cb234-5" tabindex="-1"></a><span class="co">#&gt; 0.5430468</span></span>
<span id="cb234-6"><a href="ロジットブロビット回帰分析.html#cb234-6" tabindex="-1"></a><span class="fu">PseudoR2</span>(res_glm, <span class="at">which =</span> <span class="st">&quot;CoxSnell&quot;</span>)  <span class="co"># Cox-Snell</span></span>
<span id="cb234-7"><a href="ロジットブロビット回帰分析.html#cb234-7" tabindex="-1"></a><span class="co">#&gt;  CoxSnell </span></span>
<span id="cb234-8"><a href="ロジットブロビット回帰分析.html#cb234-8" tabindex="-1"></a><span class="co">#&gt; 0.4277647</span></span>
<span id="cb234-9"><a href="ロジットブロビット回帰分析.html#cb234-9" tabindex="-1"></a><span class="fu">PseudoR2</span>(res_glm, <span class="at">which =</span> <span class="st">&quot;Nagelkerke&quot;</span>)  <span class="co"># Nagelkerke</span></span>
<span id="cb234-10"><a href="ロジットブロビット回帰分析.html#cb234-10" tabindex="-1"></a><span class="co">#&gt; Nagelkerke </span></span>
<span id="cb234-11"><a href="ロジットブロビット回帰分析.html#cb234-11" tabindex="-1"></a><span class="co">#&gt;  0.6660436</span></span>
<span id="cb234-12"><a href="ロジットブロビット回帰分析.html#cb234-12" tabindex="-1"></a><span class="fu">PseudoR2</span>(res_glm, <span class="at">which =</span> <span class="st">&quot;all&quot;</span>)</span>
<span id="cb234-13"><a href="ロジットブロビット回帰分析.html#cb234-13" tabindex="-1"></a><span class="co">#&gt;        McFadden     McFaddenAdj        CoxSnell      Nagelkerke   AldrichNelson </span></span>
<span id="cb234-14"><a href="ロジットブロビット回帰分析.html#cb234-14" tabindex="-1"></a><span class="co">#&gt;       0.5430468       0.4652192       0.4277647       0.6660436       0.3582359 </span></span>
<span id="cb234-15"><a href="ロジットブロビット回帰分析.html#cb234-15" tabindex="-1"></a><span class="co">#&gt; VeallZimmermann           Efron McKelveyZavoina            Tjur             AIC </span></span>
<span id="cb234-16"><a href="ロジットブロビット回帰分析.html#cb234-16" tabindex="-1"></a><span class="co">#&gt;       0.7067438       0.5736644       0.8515845       0.5589555      54.9708332 </span></span>
<span id="cb234-17"><a href="ロジットブロビット回帰分析.html#cb234-17" tabindex="-1"></a><span class="co">#&gt;             BIC          logLik         logLik0              G2 </span></span>
<span id="cb234-18"><a href="ロジットブロビット回帰分析.html#cb234-18" tabindex="-1"></a><span class="co">#&gt;      65.3915139     -23.4854166     -51.3956671      55.8205010</span></span></code></pre></div>
</div>
<div id="パッケージpsclの利用" class="section level3 unnumbered hasAnchor">
<h3>パッケージpsclの利用<a href="ロジットブロビット回帰分析.html#パッケージpsclの利用" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>pscl::pR2()
- 以下を出力:
- llh: The log-likelihood from the fitted model
- llhNull: The log-likelihood from the intercept-only restricted model
- G2: Minus two times the difference in the log-likelihoods
- McFadden: McFadden&#39;s pseudo r-squared
- r2ML: Maximum likelihood pseudo r-squared
- r2CU: Cragg and Uhler&#39;s pseudo r-squared</code></pre>
<!--
GPT-4:
pR2関数: psclパッケージに含まれるpR2関数は、ロジスティック回帰モデルに対する疑似R^2の計算をサポートしています。McFaddenのR^2、Cox and SnellのR^2、NagelkerkeのR^2など、複数の疑似R^2の指標を提供します。
とあるので, r2ML → Cox-Snell, r2CU → Nagelkerke,  に対応していると思われる
-->
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="ロジットブロビット回帰分析.html#cb236-1" tabindex="-1"></a><span class="co"># install.packages(&#39;pscl&#39;)</span></span>
<span id="cb236-2"><a href="ロジットブロビット回帰分析.html#cb236-2" tabindex="-1"></a><span class="fu">library</span>(pscl)</span>
<span id="cb236-3"><a href="ロジットブロビット回帰分析.html#cb236-3" tabindex="-1"></a></span>
<span id="cb236-4"><a href="ロジットブロビット回帰分析.html#cb236-4" tabindex="-1"></a><span class="co"># 疑似R2の計算</span></span>
<span id="cb236-5"><a href="ロジットブロビット回帰分析.html#cb236-5" tabindex="-1"></a>pscl<span class="sc">::</span><span class="fu">pR2</span>(res_glm)</span>
<span id="cb236-6"><a href="ロジットブロビット回帰分析.html#cb236-6" tabindex="-1"></a><span class="co">#&gt; fitting null model for pseudo-r2</span></span>
<span id="cb236-7"><a href="ロジットブロビット回帰分析.html#cb236-7" tabindex="-1"></a><span class="co">#&gt;         llh     llhNull          G2    McFadden        r2ML        r2CU </span></span>
<span id="cb236-8"><a href="ロジットブロビット回帰分析.html#cb236-8" tabindex="-1"></a><span class="co">#&gt; -23.4854166 -51.3956671  55.8205010   0.5430468   0.4277647   0.6660436</span></span></code></pre></div>
</div>
<div id="パッケージperformanceの利用" class="section level3 unnumbered hasAnchor">
<h3>パッケージperformanceの利用<a href="ロジットブロビット回帰分析.html#パッケージperformanceの利用" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>performance::r2()
- モデルに応じて適切な疑似R2を選んで出力:
  - Logistic models: Tjur&#39;s R2
  - General linear models: Nagelkerke&#39;s R2
  - Multinomial Logit: McFadden&#39;s R2
  - Models with zero-inflation: R2 for zero-inflated models
  - Mixed models: Nakagawa&#39;s R2
  - Bayesian models: R2 bayes</code></pre>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="ロジットブロビット回帰分析.html#cb238-1" tabindex="-1"></a><span class="co"># install.packages(&#39;performance&#39;)</span></span>
<span id="cb238-2"><a href="ロジットブロビット回帰分析.html#cb238-2" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb238-3"><a href="ロジットブロビット回帰分析.html#cb238-3" tabindex="-1"></a></span>
<span id="cb238-4"><a href="ロジットブロビット回帰分析.html#cb238-4" tabindex="-1"></a><span class="co"># 疑似R2の計算</span></span>
<span id="cb238-5"><a href="ロジットブロビット回帰分析.html#cb238-5" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">r2</span>(res_glm)</span>
<span id="cb238-6"><a href="ロジットブロビット回帰分析.html#cb238-6" tabindex="-1"></a><span class="co">#&gt; # R2 for Logistic Regression</span></span>
<span id="cb238-7"><a href="ロジットブロビット回帰分析.html#cb238-7" tabindex="-1"></a><span class="co">#&gt;   Tjur&#39;s R2: 0.559</span></span></code></pre></div>

</div>
</div>
<div id="関数factorについて" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> 関数<code>factor()</code>について<a href="ロジットブロビット回帰分析.html#関数factorについて" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Rの初心者向けに関数<code>factor()</code>の使い方に関する簡単な説明を行う.</p>
<hr />
<div id="rでのfactor関数の使い方" class="section level3 unnumbered hasAnchor">
<h3>Rでのfactor関数の使い方<a href="ロジットブロビット回帰分析.html#rでのfactor関数の使い方" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>関数<code>factor()</code>は, カテゴリーデータ（文字列や整数を値に持つベクトル）を因子型（factor）に変換するために使用される.</p>
<div id="ベクトルを因子に変換する" class="section level4 unnumbered hasAnchor">
<h4>1. ベクトルを因子に変換する<a href="ロジットブロビット回帰分析.html#ベクトルを因子に変換する" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="ロジットブロビット回帰分析.html#cb239-1" tabindex="-1"></a><span class="co"># サンプルのカテゴリーデータ</span></span>
<span id="cb239-2"><a href="ロジットブロビット回帰分析.html#cb239-2" tabindex="-1"></a>gender <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;male&quot;</span>, <span class="st">&quot;female&quot;</span>, <span class="st">&quot;female&quot;</span>, <span class="st">&quot;male&quot;</span>, <span class="st">&quot;male&quot;</span>)</span>
<span id="cb239-3"><a href="ロジットブロビット回帰分析.html#cb239-3" tabindex="-1"></a></span>
<span id="cb239-4"><a href="ロジットブロビット回帰分析.html#cb239-4" tabindex="-1"></a><span class="co"># ベクトルを因子に変換する</span></span>
<span id="cb239-5"><a href="ロジットブロビット回帰分析.html#cb239-5" tabindex="-1"></a>gender_factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(gender)</span>
<span id="cb239-6"><a href="ロジットブロビット回帰分析.html#cb239-6" tabindex="-1"></a></span>
<span id="cb239-7"><a href="ロジットブロビット回帰分析.html#cb239-7" tabindex="-1"></a><span class="co"># 変換後の因子の表示</span></span>
<span id="cb239-8"><a href="ロジットブロビット回帰分析.html#cb239-8" tabindex="-1"></a><span class="fu">print</span>(gender_factor)</span>
<span id="cb239-9"><a href="ロジットブロビット回帰分析.html#cb239-9" tabindex="-1"></a><span class="co">#&gt; [1] male   female female male   male  </span></span>
<span id="cb239-10"><a href="ロジットブロビット回帰分析.html#cb239-10" tabindex="-1"></a><span class="co">#&gt; Levels: female male</span></span></code></pre></div>
</div>
<div id="水準カテゴリーの指定" class="section level4 unnumbered hasAnchor">
<h4>2. 水準（カテゴリー）の指定<a href="ロジットブロビット回帰分析.html#水準カテゴリーの指定" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="ロジットブロビット回帰分析.html#cb240-1" tabindex="-1"></a><span class="co"># 水準（カテゴリー）を指定して因子に変換する</span></span>
<span id="cb240-2"><a href="ロジットブロビット回帰分析.html#cb240-2" tabindex="-1"></a>gender_factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(gender, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;male&quot;</span>, <span class="st">&quot;female&quot;</span>))</span>
<span id="cb240-3"><a href="ロジットブロビット回帰分析.html#cb240-3" tabindex="-1"></a></span>
<span id="cb240-4"><a href="ロジットブロビット回帰分析.html#cb240-4" tabindex="-1"></a><span class="co"># 変換後の因子の表示</span></span>
<span id="cb240-5"><a href="ロジットブロビット回帰分析.html#cb240-5" tabindex="-1"></a><span class="fu">print</span>(gender_factor)</span>
<span id="cb240-6"><a href="ロジットブロビット回帰分析.html#cb240-6" tabindex="-1"></a><span class="co">#&gt; [1] male   female female male   male  </span></span>
<span id="cb240-7"><a href="ロジットブロビット回帰分析.html#cb240-7" tabindex="-1"></a><span class="co">#&gt; Levels: male female</span></span></code></pre></div>
</div>
<div id="因子ラベルの指定" class="section level4 unnumbered hasAnchor">
<h4>3. 因子ラベルの指定<a href="ロジットブロビット回帰分析.html#因子ラベルの指定" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="ロジットブロビット回帰分析.html#cb241-1" tabindex="-1"></a><span class="co"># 因子ラベルを指定しながら因子に変換する</span></span>
<span id="cb241-2"><a href="ロジットブロビット回帰分析.html#cb241-2" tabindex="-1"></a>gender_factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(gender, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;m&quot;</span>, <span class="st">&quot;f&quot;</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;male&quot;</span>, <span class="st">&quot;female&quot;</span>))</span>
<span id="cb241-3"><a href="ロジットブロビット回帰分析.html#cb241-3" tabindex="-1"></a></span>
<span id="cb241-4"><a href="ロジットブロビット回帰分析.html#cb241-4" tabindex="-1"></a><span class="co"># 変換後の因子の表示</span></span>
<span id="cb241-5"><a href="ロジットブロビット回帰分析.html#cb241-5" tabindex="-1"></a><span class="fu">print</span>(gender_factor)</span>
<span id="cb241-6"><a href="ロジットブロビット回帰分析.html#cb241-6" tabindex="-1"></a><span class="co">#&gt; [1] &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;</span></span>
<span id="cb241-7"><a href="ロジットブロビット回帰分析.html#cb241-7" tabindex="-1"></a><span class="co">#&gt; Levels: male female</span></span></code></pre></div>
</div>
<div id="因子の利用" class="section level4 unnumbered hasAnchor">
<h4>4. 因子の利用<a href="ロジットブロビット回帰分析.html#因子の利用" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Rのデータフレーム (data.frame) は, 行列の形をしているが, 実際は, 長さは等しいものの 異なる”データ型”のベクトルを要素に持つリスト (list) である.
因子に変換されたデータは, データフレーム内でカテゴリー変数として保持することで, 統計解析や可視化などで利用される.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="ロジットブロビット回帰分析.html#cb242-1" tabindex="-1"></a><span class="co"># サンプルのカテゴリーデータ</span></span>
<span id="cb242-2"><a href="ロジットブロビット回帰分析.html#cb242-2" tabindex="-1"></a>gender <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;male&quot;</span>, <span class="st">&quot;female&quot;</span>, <span class="st">&quot;female&quot;</span>, <span class="st">&quot;male&quot;</span>, <span class="st">&quot;male&quot;</span>)</span>
<span id="cb242-3"><a href="ロジットブロビット回帰分析.html#cb242-3" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">35</span>, <span class="dv">40</span>, <span class="dv">45</span>)</span>
<span id="cb242-4"><a href="ロジットブロビット回帰分析.html#cb242-4" tabindex="-1"></a></span>
<span id="cb242-5"><a href="ロジットブロビット回帰分析.html#cb242-5" tabindex="-1"></a><span class="co"># データフレームの作成</span></span>
<span id="cb242-6"><a href="ロジットブロビット回帰分析.html#cb242-6" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">gender =</span> <span class="fu">factor</span>(gender), <span class="at">age =</span> age)</span>
<span id="cb242-7"><a href="ロジットブロビット回帰分析.html#cb242-7" tabindex="-1"></a>df</span>
<span id="cb242-8"><a href="ロジットブロビット回帰分析.html#cb242-8" tabindex="-1"></a><span class="co">#&gt;   gender age</span></span>
<span id="cb242-9"><a href="ロジットブロビット回帰分析.html#cb242-9" tabindex="-1"></a><span class="co">#&gt; 1   male  25</span></span>
<span id="cb242-10"><a href="ロジットブロビット回帰分析.html#cb242-10" tabindex="-1"></a><span class="co">#&gt; 2 female  30</span></span>
<span id="cb242-11"><a href="ロジットブロビット回帰分析.html#cb242-11" tabindex="-1"></a><span class="co">#&gt; 3 female  35</span></span>
<span id="cb242-12"><a href="ロジットブロビット回帰分析.html#cb242-12" tabindex="-1"></a><span class="co">#&gt; 4   male  40</span></span>
<span id="cb242-13"><a href="ロジットブロビット回帰分析.html#cb242-13" tabindex="-1"></a><span class="co">#&gt; 5   male  45</span></span>
<span id="cb242-14"><a href="ロジットブロビット回帰分析.html#cb242-14" tabindex="-1"></a></span>
<span id="cb242-15"><a href="ロジットブロビット回帰分析.html#cb242-15" tabindex="-1"></a><span class="co"># データフレームの要約</span></span>
<span id="cb242-16"><a href="ロジットブロビット回帰分析.html#cb242-16" tabindex="-1"></a><span class="fu">summary</span>(df)</span>
<span id="cb242-17"><a href="ロジットブロビット回帰分析.html#cb242-17" tabindex="-1"></a><span class="co">#&gt;     gender       age    </span></span>
<span id="cb242-18"><a href="ロジットブロビット回帰分析.html#cb242-18" tabindex="-1"></a><span class="co">#&gt;  female:2   Min.   :25  </span></span>
<span id="cb242-19"><a href="ロジットブロビット回帰分析.html#cb242-19" tabindex="-1"></a><span class="co">#&gt;  male  :3   1st Qu.:30  </span></span>
<span id="cb242-20"><a href="ロジットブロビット回帰分析.html#cb242-20" tabindex="-1"></a><span class="co">#&gt;             Median :35  </span></span>
<span id="cb242-21"><a href="ロジットブロビット回帰分析.html#cb242-21" tabindex="-1"></a><span class="co">#&gt;             Mean   :35  </span></span>
<span id="cb242-22"><a href="ロジットブロビット回帰分析.html#cb242-22" tabindex="-1"></a><span class="co">#&gt;             3rd Qu.:40  </span></span>
<span id="cb242-23"><a href="ロジットブロビット回帰分析.html#cb242-23" tabindex="-1"></a><span class="co">#&gt;             Max.   :45</span></span>
<span id="cb242-24"><a href="ロジットブロビット回帰分析.html#cb242-24" tabindex="-1"></a></span>
<span id="cb242-25"><a href="ロジットブロビット回帰分析.html#cb242-25" tabindex="-1"></a><span class="co"># 箱ひげ図</span></span>
<span id="cb242-26"><a href="ロジットブロビット回帰分析.html#cb242-26" tabindex="-1"></a><span class="fu">plot</span>(age <span class="sc">~</span> gender, <span class="at">data =</span> df)</span></code></pre></div>
<p><img src="072-factor_files/figure-html/unnamed-chunk-6-1.png" width="75%" /></p>
<p>Rにおける標準的な統計解析や可視化を行う場合には,
関数<code>factor()</code>を使うことで, カテゴリー変数はR内部で適正に処理されるため
一変数のままで使用することができる. すなわち, 通常,
カテゴリーの水準に対応するダミー変数を作る作業は不要である.</p>
<p>関数<code>lm()</code>や<code>glm()</code>等においては, 文字列を値に持つカテゴリー変数は明示的に<code>factor()</code>を使って因子型に
変換せずとも, Rは因子型と解釈して関数を実行するが, もしそのカテゴリー変数が整数値 (例, <code>gender &lt;- c(1, 2, 2, 1, 1)</code>) を持つ場合には, <code>factor()</code>を使って
変換しないと, 意図とは異なる結果やエラーを生じることになる</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="ロジットブロビット回帰分析.html#cb243-1" tabindex="-1"></a><span class="co"># カテゴリーデータが整数値で記録されている場合</span></span>
<span id="cb243-2"><a href="ロジットブロビット回帰分析.html#cb243-2" tabindex="-1"></a>gender <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb243-3"><a href="ロジットブロビット回帰分析.html#cb243-3" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">35</span>, <span class="dv">40</span>, <span class="dv">45</span>)</span>
<span id="cb243-4"><a href="ロジットブロビット回帰分析.html#cb243-4" tabindex="-1"></a></span>
<span id="cb243-5"><a href="ロジットブロビット回帰分析.html#cb243-5" tabindex="-1"></a><span class="co"># データフレームの作成</span></span>
<span id="cb243-6"><a href="ロジットブロビット回帰分析.html#cb243-6" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">gender =</span> gender, <span class="at">age =</span> age)</span>
<span id="cb243-7"><a href="ロジットブロビット回帰分析.html#cb243-7" tabindex="-1"></a>df</span>
<span id="cb243-8"><a href="ロジットブロビット回帰分析.html#cb243-8" tabindex="-1"></a><span class="co">#&gt;   gender age</span></span>
<span id="cb243-9"><a href="ロジットブロビット回帰分析.html#cb243-9" tabindex="-1"></a><span class="co">#&gt; 1      1  25</span></span>
<span id="cb243-10"><a href="ロジットブロビット回帰分析.html#cb243-10" tabindex="-1"></a><span class="co">#&gt; 2      2  30</span></span>
<span id="cb243-11"><a href="ロジットブロビット回帰分析.html#cb243-11" tabindex="-1"></a><span class="co">#&gt; 3      2  35</span></span>
<span id="cb243-12"><a href="ロジットブロビット回帰分析.html#cb243-12" tabindex="-1"></a><span class="co">#&gt; 4      1  40</span></span>
<span id="cb243-13"><a href="ロジットブロビット回帰分析.html#cb243-13" tabindex="-1"></a><span class="co">#&gt; 5      1  45</span></span>
<span id="cb243-14"><a href="ロジットブロビット回帰分析.html#cb243-14" tabindex="-1"></a></span>
<span id="cb243-15"><a href="ロジットブロビット回帰分析.html#cb243-15" tabindex="-1"></a><span class="co"># データフレームの要約?</span></span>
<span id="cb243-16"><a href="ロジットブロビット回帰分析.html#cb243-16" tabindex="-1"></a><span class="fu">summary</span>(df)</span>
<span id="cb243-17"><a href="ロジットブロビット回帰分析.html#cb243-17" tabindex="-1"></a><span class="co">#&gt;      gender         age    </span></span>
<span id="cb243-18"><a href="ロジットブロビット回帰分析.html#cb243-18" tabindex="-1"></a><span class="co">#&gt;  Min.   :1.0   Min.   :25  </span></span>
<span id="cb243-19"><a href="ロジットブロビット回帰分析.html#cb243-19" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:1.0   1st Qu.:30  </span></span>
<span id="cb243-20"><a href="ロジットブロビット回帰分析.html#cb243-20" tabindex="-1"></a><span class="co">#&gt;  Median :1.0   Median :35  </span></span>
<span id="cb243-21"><a href="ロジットブロビット回帰分析.html#cb243-21" tabindex="-1"></a><span class="co">#&gt;  Mean   :1.4   Mean   :35  </span></span>
<span id="cb243-22"><a href="ロジットブロビット回帰分析.html#cb243-22" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.:2.0   3rd Qu.:40  </span></span>
<span id="cb243-23"><a href="ロジットブロビット回帰分析.html#cb243-23" tabindex="-1"></a><span class="co">#&gt;  Max.   :2.0   Max.   :45</span></span>
<span id="cb243-24"><a href="ロジットブロビット回帰分析.html#cb243-24" tabindex="-1"></a></span>
<span id="cb243-25"><a href="ロジットブロビット回帰分析.html#cb243-25" tabindex="-1"></a><span class="co"># 箱ひげ図?</span></span>
<span id="cb243-26"><a href="ロジットブロビット回帰分析.html#cb243-26" tabindex="-1"></a><span class="fu">plot</span>(age <span class="sc">~</span> gender, <span class="at">data =</span> df)</span></code></pre></div>
<p><img src="072-factor_files/figure-html/unnamed-chunk-7-1.png" width="75%" /></p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="ロジットブロビット回帰分析.html#cb244-1" tabindex="-1"></a><span class="co"># 適切な処理: 関数factor()の使用</span></span>
<span id="cb244-2"><a href="ロジットブロビット回帰分析.html#cb244-2" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">gender =</span> <span class="fu">factor</span>(gender, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;male&quot;</span>,</span>
<span id="cb244-3"><a href="ロジットブロビット回帰分析.html#cb244-3" tabindex="-1"></a>  <span class="st">&quot;female&quot;</span>)), <span class="at">age =</span> age)</span>
<span id="cb244-4"><a href="ロジットブロビット回帰分析.html#cb244-4" tabindex="-1"></a>df</span>
<span id="cb244-5"><a href="ロジットブロビット回帰分析.html#cb244-5" tabindex="-1"></a><span class="co">#&gt;   gender age</span></span>
<span id="cb244-6"><a href="ロジットブロビット回帰分析.html#cb244-6" tabindex="-1"></a><span class="co">#&gt; 1   male  25</span></span>
<span id="cb244-7"><a href="ロジットブロビット回帰分析.html#cb244-7" tabindex="-1"></a><span class="co">#&gt; 2 female  30</span></span>
<span id="cb244-8"><a href="ロジットブロビット回帰分析.html#cb244-8" tabindex="-1"></a><span class="co">#&gt; 3 female  35</span></span>
<span id="cb244-9"><a href="ロジットブロビット回帰分析.html#cb244-9" tabindex="-1"></a><span class="co">#&gt; 4   male  40</span></span>
<span id="cb244-10"><a href="ロジットブロビット回帰分析.html#cb244-10" tabindex="-1"></a><span class="co">#&gt; 5   male  45</span></span>
<span id="cb244-11"><a href="ロジットブロビット回帰分析.html#cb244-11" tabindex="-1"></a></span>
<span id="cb244-12"><a href="ロジットブロビット回帰分析.html#cb244-12" tabindex="-1"></a><span class="co"># データフレームの要約</span></span>
<span id="cb244-13"><a href="ロジットブロビット回帰分析.html#cb244-13" tabindex="-1"></a><span class="fu">summary</span>(df)</span>
<span id="cb244-14"><a href="ロジットブロビット回帰分析.html#cb244-14" tabindex="-1"></a><span class="co">#&gt;     gender       age    </span></span>
<span id="cb244-15"><a href="ロジットブロビット回帰分析.html#cb244-15" tabindex="-1"></a><span class="co">#&gt;  male  :3   Min.   :25  </span></span>
<span id="cb244-16"><a href="ロジットブロビット回帰分析.html#cb244-16" tabindex="-1"></a><span class="co">#&gt;  female:2   1st Qu.:30  </span></span>
<span id="cb244-17"><a href="ロジットブロビット回帰分析.html#cb244-17" tabindex="-1"></a><span class="co">#&gt;             Median :35  </span></span>
<span id="cb244-18"><a href="ロジットブロビット回帰分析.html#cb244-18" tabindex="-1"></a><span class="co">#&gt;             Mean   :35  </span></span>
<span id="cb244-19"><a href="ロジットブロビット回帰分析.html#cb244-19" tabindex="-1"></a><span class="co">#&gt;             3rd Qu.:40  </span></span>
<span id="cb244-20"><a href="ロジットブロビット回帰分析.html#cb244-20" tabindex="-1"></a><span class="co">#&gt;             Max.   :45</span></span>
<span id="cb244-21"><a href="ロジットブロビット回帰分析.html#cb244-21" tabindex="-1"></a></span>
<span id="cb244-22"><a href="ロジットブロビット回帰分析.html#cb244-22" tabindex="-1"></a><span class="co"># 箱ひげ図</span></span>
<span id="cb244-23"><a href="ロジットブロビット回帰分析.html#cb244-23" tabindex="-1"></a><span class="fu">plot</span>(age <span class="sc">~</span> gender, <span class="at">data =</span> df)</span></code></pre></div>
<p><img src="072-factor_files/figure-html/unnamed-chunk-8-1.png" width="75%" /></p>
<hr />

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="線形回帰分析.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="判別分析.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
