<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 判別分析 | ビジネス統計</title>
  <meta name="description" content="7 判別分析 | ビジネス統計" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="7 判別分析 | ビジネス統計" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 判別分析 | ビジネス統計" />
  
  
  

<meta name="author" content="林 高樹" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ロジットブロビット回帰分析.html"/>
<link rel="next" href="決定木分析.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> はじめに</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#コースの目的"><i class="fa fa-check"></i><b>1.1</b> コースの目的</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#統計学統計的手法の学習について"><i class="fa fa-check"></i><b>1.2</b> 統計学/統計的手法の学習について</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#学習の目標"><i class="fa fa-check"></i>学習の目標</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#統計学統計的手法の学習方法"><i class="fa fa-check"></i>統計学/統計的手法の学習方法</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#統計学統計的手法の学習ステップ"><i class="fa fa-check"></i>統計学/統計的手法の学習ステップ</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#ビジネス応用における統計学の最近の趨勢"><i class="fa fa-check"></i><b>1.3</b> ビジネス応用における統計学の最近の趨勢</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#本書内の記載の注意点"><i class="fa fa-check"></i><b>1.4</b> 本書内の記載の注意点</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r言語の基本.html"><a href="r言語の基本.html"><i class="fa fa-check"></i><b>2</b> R言語の基本</a>
<ul>
<li class="chapter" data-level="2.1" data-path="r言語の基本.html"><a href="r言語の基本.html#rの基本プログラミング"><i class="fa fa-check"></i><b>2.1</b> Rの基本プログラミング</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="r言語の基本.html"><a href="r言語の基本.html#基本操作"><i class="fa fa-check"></i><b>2.1.1</b> 基本操作</a></li>
<li class="chapter" data-level="2.1.2" data-path="r言語の基本.html"><a href="r言語の基本.html#基本構文"><i class="fa fa-check"></i><b>2.1.2</b> 基本構文</a></li>
<li class="chapter" data-level="2.1.3" data-path="r言語の基本.html"><a href="r言語の基本.html#自作関数"><i class="fa fa-check"></i><b>2.1.3</b> 自作関数</a></li>
<li class="chapter" data-level="2.1.4" data-path="r言語の基本.html"><a href="r言語の基本.html#パッケージのインストール-読み込み"><i class="fa fa-check"></i><b>2.1.4</b> パッケージのインストール &amp; 読み込み</a></li>
<li class="chapter" data-level="2.1.5" data-path="r言語の基本.html"><a href="r言語の基本.html#ヘルプ"><i class="fa fa-check"></i><b>2.1.5</b> ヘルプ</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="r言語の基本.html"><a href="r言語の基本.html#データの型や構造"><i class="fa fa-check"></i><b>2.2</b> データの型や構造</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="r言語の基本.html"><a href="r言語の基本.html#データの値の種類-データ型"><i class="fa fa-check"></i><b>2.2.1</b> データの値の種類 (“データ型”)</a></li>
<li class="chapter" data-level="2.2.2" data-path="r言語の基本.html"><a href="r言語の基本.html#データの配列の仕方-データ構造"><i class="fa fa-check"></i><b>2.2.2</b> データの配列の仕方 (“データ構造”)</a></li>
<li class="chapter" data-level="2.2.3" data-path="r言語の基本.html"><a href="r言語の基本.html#ベクトル"><i class="fa fa-check"></i><b>2.2.3</b> ベクトル</a></li>
<li class="chapter" data-level="2.2.4" data-path="r言語の基本.html"><a href="r言語の基本.html#行列"><i class="fa fa-check"></i><b>2.2.4</b> 行列</a></li>
<li class="chapter" data-level="2.2.5" data-path="r言語の基本.html"><a href="r言語の基本.html#リスト"><i class="fa fa-check"></i><b>2.2.5</b> リスト</a></li>
<li class="chapter" data-level="2.2.6" data-path="r言語の基本.html"><a href="r言語の基本.html#データフレーム"><i class="fa fa-check"></i><b>2.2.6</b> データフレーム</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="r言語の基本.html"><a href="r言語の基本.html#データの操作演算"><i class="fa fa-check"></i><b>2.3</b> データの操作・演算</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="r言語の基本.html"><a href="r言語の基本.html#ベクトルの結合-ソート"><i class="fa fa-check"></i><b>2.3.1</b> ベクトルの結合, ソート</a></li>
<li class="chapter" data-level="2.3.2" data-path="r言語の基本.html"><a href="r言語の基本.html#二項演算"><i class="fa fa-check"></i><b>2.3.2</b> 二項演算</a></li>
<li class="chapter" data-level="2.3.3" data-path="r言語の基本.html"><a href="r言語の基本.html#論理演算"><i class="fa fa-check"></i><b>2.3.3</b> 論理演算</a></li>
<li class="chapter" data-level="2.3.4" data-path="r言語の基本.html"><a href="r言語の基本.html#条件式"><i class="fa fa-check"></i><b>2.3.4</b> 条件式</a></li>
<li class="chapter" data-level="2.3.5" data-path="r言語の基本.html"><a href="r言語の基本.html#行列演算"><i class="fa fa-check"></i><b>2.3.5</b> 行列演算</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="r言語の基本.html"><a href="r言語の基本.html#r関数"><i class="fa fa-check"></i><b>2.4</b> R関数</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="r言語の基本.html"><a href="r言語の基本.html#数学基本関数"><i class="fa fa-check"></i><b>2.4.1</b> 数学基本関数</a></li>
<li class="chapter" data-level="2.4.2" data-path="r言語の基本.html"><a href="r言語の基本.html#基本統計量の計算"><i class="fa fa-check"></i><b>2.4.2</b> 基本統計量の計算</a></li>
<li class="chapter" data-level="2.4.3" data-path="r言語の基本.html"><a href="r言語の基本.html#確率分布"><i class="fa fa-check"></i><b>2.4.3</b> 確率分布</a></li>
<li class="chapter" data-level="2.4.4" data-path="r言語の基本.html"><a href="r言語の基本.html#その他便利な関数"><i class="fa fa-check"></i><b>2.4.4</b> その他便利な関数</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="r言語の基本.html"><a href="r言語の基本.html#データの可視化"><i class="fa fa-check"></i><b>2.5</b> データの可視化</a></li>
<li class="chapter" data-level="2.6" data-path="r言語の基本.html"><a href="r言語の基本.html#ファイル入出力"><i class="fa fa-check"></i><b>2.6</b> ファイル入出力</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="r言語の基本.html"><a href="r言語の基本.html#テキストファイル読み込み"><i class="fa fa-check"></i><b>2.6.1</b> テキストファイル読み込み</a></li>
<li class="chapter" data-level="2.6.2" data-path="r言語の基本.html"><a href="r言語の基本.html#テキストファイル書き出し"><i class="fa fa-check"></i><b>2.6.2</b> テキストファイル書き出し</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="r言語の基本.html"><a href="r言語の基本.html#パッケージtidyverse"><i class="fa fa-check"></i><b>2.7</b> パッケージ<code>tidyverse</code></a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="r言語の基本.html"><a href="r言語の基本.html#q-rの初心者はtidyverseから勉強することは可能か"><i class="fa fa-check"></i><b>2.7.1</b> Q: Rの初心者は<code>tidyverse</code>から勉強することは可能か?</a></li>
<li class="chapter" data-level="2.7.2" data-path="r言語の基本.html"><a href="r言語の基本.html#tidyverseの基本"><i class="fa fa-check"></i><b>2.7.2</b> <code>tidyverse</code>の基本</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="仮説検定.html"><a href="仮説検定.html"><i class="fa fa-check"></i><b>3</b> 仮説検定</a>
<ul>
<li class="chapter" data-level="3.1" data-path="仮説検定.html"><a href="仮説検定.html#平均値の差の検定"><i class="fa fa-check"></i><b>3.1</b> 平均値の差の検定</a>
<ul>
<li class="chapter" data-level="" data-path="仮説検定.html"><a href="仮説検定.html#平均値の差の検定-ペア検定"><i class="fa fa-check"></i>平均値の差の検定 (ペア検定)</a></li>
<li class="chapter" data-level="" data-path="仮説検定.html"><a href="仮説検定.html#平均値の差の検定-1"><i class="fa fa-check"></i>平均値の差の検定</a></li>
<li class="chapter" data-level="" data-path="仮説検定.html"><a href="仮説検定.html#平均値の差の検定-ノンパラメトリック検定"><i class="fa fa-check"></i>平均値の差の検定 (ノンパラメトリック検定)</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="仮説検定.html"><a href="仮説検定.html#カイ二乗検定"><i class="fa fa-check"></i><b>3.2</b> カイ二乗検定</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="仮説検定.html"><a href="仮説検定.html#独立性検定"><i class="fa fa-check"></i><b>3.2.1</b> 独立性検定</a></li>
<li class="chapter" data-level="3.2.2" data-path="仮説検定.html"><a href="仮説検定.html#適合度検定"><i class="fa fa-check"></i><b>3.2.2</b> 適合度検定</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="仮説検定.html"><a href="仮説検定.html#分析例-統計テストデータ"><i class="fa fa-check"></i><b>3.3</b> 分析例: 統計テストデータ</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="分散分析-anova.html"><a href="分散分析-anova.html"><i class="fa fa-check"></i><b>4</b> 分散分析 (ANOVA)</a>
<ul>
<li class="chapter" data-level="4.1" data-path="分散分析-anova.html"><a href="分散分析-anova.html#元配置anova"><i class="fa fa-check"></i><b>4.1</b> 1元配置ANOVA</a>
<ul>
<li class="chapter" data-level="" data-path="分散分析-anova.html"><a href="分散分析-anova.html#anovaの計算ロジックの確認"><i class="fa fa-check"></i>ANOVAの計算ロジックの確認*</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="分散分析-anova.html"><a href="分散分析-anova.html#元配置anova-1"><i class="fa fa-check"></i><b>4.2</b> 2元配置ANOVA</a></li>
<li class="chapter" data-level="4.3" data-path="分散分析-anova.html"><a href="分散分析-anova.html#分析例"><i class="fa fa-check"></i><b>4.3</b> 分析例</a>
<ul>
<li class="chapter" data-level="" data-path="分散分析-anova.html"><a href="分散分析-anova.html#データ1-2業種口コミサイト仮想データ"><i class="fa fa-check"></i>データ1: 2業種口コミサイト(仮想データ)</a></li>
<li class="chapter" data-level="" data-path="分散分析-anova.html"><a href="分散分析-anova.html#データ2-統計小テストデータ"><i class="fa fa-check"></i>データ2: 統計小テストデータ</a></li>
<li class="chapter" data-level="" data-path="分散分析-anova.html"><a href="分散分析-anova.html#データ3-経営科学アンケート"><i class="fa fa-check"></i>データ3: 経営科学アンケート</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="分散分析-anova.html"><a href="分散分析-anova.html#分散分析と平均値の多重比較"><i class="fa fa-check"></i><b>4.4</b> 分散分析と平均値の多重比較*</a>
<ul>
<li class="chapter" data-level="" data-path="分散分析-anova.html"><a href="分散分析-anova.html#rによる事後分析の実行例"><i class="fa fa-check"></i>Rによる事後分析の実行例</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="線形回帰分析.html"><a href="線形回帰分析.html"><i class="fa fa-check"></i><b>5</b> 線形回帰分析</a>
<ul>
<li class="chapter" data-level="5.1" data-path="線形回帰分析.html"><a href="線形回帰分析.html#重回帰分析の基本操作"><i class="fa fa-check"></i><b>5.1</b> 重回帰分析の基本操作</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰分析.html"><a href="線形回帰分析.html#データ1-1ルーム賃貸マンション"><i class="fa fa-check"></i>データ1: 1ルーム賃貸マンション</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="線形回帰分析.html"><a href="線形回帰分析.html#変数の選択"><i class="fa fa-check"></i><b>5.2</b> 変数の選択</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰分析.html"><a href="線形回帰分析.html#データ2-ボストン市内住宅物件価格データ"><i class="fa fa-check"></i>データ2: ボストン市内住宅物件価格データ</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="線形回帰分析.html"><a href="線形回帰分析.html#説明変数に質的変数を含む回帰"><i class="fa fa-check"></i><b>5.3</b> 説明変数に質的変数を含む回帰</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰分析.html"><a href="線形回帰分析.html#データセット3-高速道路事故データ"><i class="fa fa-check"></i>データセット#3: 高速道路事故データ</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="線形回帰分析.html"><a href="線形回帰分析.html#説明変数に質的変数を含む回帰-2"><i class="fa fa-check"></i><b>5.4</b> 説明変数に質的変数を含む回帰 (2)</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰分析.html"><a href="線形回帰分析.html#データセット5-収入データ-仮想"><i class="fa fa-check"></i>データセット#5: 収入データ (仮想)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ロジットブロビット回帰分析.html"><a href="ロジットブロビット回帰分析.html"><i class="fa fa-check"></i><b>6</b> ロジット/ブロビット回帰分析</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ロジットブロビット回帰分析.html"><a href="ロジットブロビット回帰分析.html#ロジット回帰分析の基本操作"><i class="fa fa-check"></i><b>6.1</b> ロジット回帰分析の基本操作</a>
<ul>
<li class="chapter" data-level="" data-path="ロジットブロビット回帰分析.html"><a href="ロジットブロビット回帰分析.html#ロジットモデル-シミュレーションデータ"><i class="fa fa-check"></i>ロジットモデル: シミュレーションデータ</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="ロジットブロビット回帰分析.html"><a href="ロジットブロビット回帰分析.html#データ分析例"><i class="fa fa-check"></i><b>6.2</b> データ分析例</a>
<ul>
<li class="chapter" data-level="" data-path="ロジットブロビット回帰分析.html"><a href="ロジットブロビット回帰分析.html#データセット-1-企業パフォーマンスデータ-仮想"><i class="fa fa-check"></i>データセット (1): 企業パフォーマンス・データ (仮想)</a></li>
<li class="chapter" data-level="" data-path="ロジットブロビット回帰分析.html"><a href="ロジットブロビット回帰分析.html#データセット-2-個人ローンデフォルトデータ-仮想"><i class="fa fa-check"></i>データセット (2): 個人ローン・デフォルト・データ (仮想)</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="ロジットブロビット回帰分析.html"><a href="ロジットブロビット回帰分析.html#疑似r2の計算"><i class="fa fa-check"></i><b>6.3</b> 疑似R2の計算</a>
<ul>
<li class="chapter" data-level="" data-path="ロジットブロビット回帰分析.html"><a href="ロジットブロビット回帰分析.html#パッケージdesctoolsの利用"><i class="fa fa-check"></i>パッケージ<code>DescTools</code>の利用</a></li>
<li class="chapter" data-level="" data-path="ロジットブロビット回帰分析.html"><a href="ロジットブロビット回帰分析.html#パッケージpsclの利用"><i class="fa fa-check"></i>パッケージ<code>pscl</code>の利用</a></li>
<li class="chapter" data-level="" data-path="ロジットブロビット回帰分析.html"><a href="ロジットブロビット回帰分析.html#パッケージperformanceの利用"><i class="fa fa-check"></i>パッケージ<code>performance</code>の利用</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="判別分析.html"><a href="判別分析.html"><i class="fa fa-check"></i><b>7</b> 判別分析</a>
<ul>
<li class="chapter" data-level="7.1" data-path="判別分析.html"><a href="判別分析.html#線形判別-2次判別---パッケージmassの利用"><i class="fa fa-check"></i><b>7.1</b> 線形判別 &amp; 2次判別 - パッケージMASSの利用</a>
<ul>
<li class="chapter" data-level="" data-path="判別分析.html"><a href="判別分析.html#データセット1-ビジネススクールの入学許可データ"><i class="fa fa-check"></i>データセット1: ビジネススクールの入学許可データ</a></li>
<li class="chapter" data-level="" data-path="判別分析.html"><a href="判別分析.html#線形判別-lda"><i class="fa fa-check"></i>線形判別 (LDA)</a></li>
<li class="chapter" data-level="" data-path="判別分析.html"><a href="判別分析.html#次判別-qda"><i class="fa fa-check"></i>2次判別 (QDA)</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="判別分析.html"><a href="判別分析.html#knn法---パッケージclassの利用"><i class="fa fa-check"></i><b>7.2</b> kNN法 - パッケージclassの利用</a></li>
<li class="chapter" data-level="7.3" data-path="判別分析.html"><a href="判別分析.html#データセット分割学習判別評価"><i class="fa fa-check"></i><b>7.3</b> データセット分割・学習・判別・評価</a>
<ul>
<li class="chapter" data-level="" data-path="判別分析.html"><a href="判別分析.html#データセット2-個人ローンデフォルトデータ-仮想"><i class="fa fa-check"></i>データセット2: 個人ローン・デフォルト・データ (仮想)</a></li>
<li class="chapter" data-level="" data-path="判別分析.html"><a href="判別分析.html#線形判別"><i class="fa fa-check"></i>線形判別</a></li>
<li class="chapter" data-level="" data-path="判別分析.html"><a href="判別分析.html#knn法"><i class="fa fa-check"></i>kNN法</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="判別分析.html"><a href="判別分析.html#他パッケージの利用"><i class="fa fa-check"></i><b>7.4</b> 他パッケージの利用</a>
<ul>
<li class="chapter" data-level="" data-path="判別分析.html"><a href="判別分析.html#パッケージklar"><i class="fa fa-check"></i>パッケージ<strong>klaR</strong></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="決定木分析.html"><a href="決定木分析.html"><i class="fa fa-check"></i><b>8</b> 決定木分析</a>
<ul>
<li class="chapter" data-level="8.1" data-path="決定木分析.html"><a href="決定木分析.html#導入-回帰木-vs-線形回帰"><i class="fa fa-check"></i><b>8.1</b> 導入: 回帰木 vs 線形回帰</a>
<ul>
<li class="chapter" data-level="" data-path="決定木分析.html"><a href="決定木分析.html#データセット1-自動車の制動距離"><i class="fa fa-check"></i>データセット1: 自動車の制動距離</a></li>
<li class="chapter" data-level="8.1.1" data-path="決定木分析.html"><a href="決定木分析.html#基本操作-回帰木"><i class="fa fa-check"></i><b>8.1.1</b> 基本操作: 回帰木</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="決定木分析.html"><a href="決定木分析.html#回帰木"><i class="fa fa-check"></i><b>8.2</b> 回帰木</a>
<ul>
<li class="chapter" data-level="" data-path="決定木分析.html"><a href="決定木分析.html#データセット2-ワイン品質データ"><i class="fa fa-check"></i>データセット2: ワイン品質データ</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="決定木分析.html"><a href="決定木分析.html#分類木"><i class="fa fa-check"></i><b>8.3</b> 分類木</a>
<ul>
<li class="chapter" data-level="" data-path="決定木分析.html"><a href="決定木分析.html#データセット3-自動車評価データ"><i class="fa fa-check"></i>データセット3: 自動車評価データ</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="主成分分析-pca.html"><a href="主成分分析-pca.html"><i class="fa fa-check"></i><b>9</b> 主成分分析 (PCA)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="主成分分析-pca.html"><a href="主成分分析-pca.html#基本操作-1"><i class="fa fa-check"></i><b>9.1</b> 基本操作</a>
<ul>
<li class="chapter" data-level="" data-path="主成分分析-pca.html"><a href="主成分分析-pca.html#データセット1-従業員スキル評価データ仮想"><i class="fa fa-check"></i>データセット1: 従業員スキル評価データ(仮想)</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="主成分分析-pca.html"><a href="主成分分析-pca.html#種類のpca-相関行列ベース-vs-分散共分散行列ベース"><i class="fa fa-check"></i><b>9.2</b> 2種類のPCA: 相関行列ベース vs 分散共分散行列ベース</a>
<ul>
<li class="chapter" data-level="" data-path="主成分分析-pca.html"><a href="主成分分析-pca.html#データセット2-usarrests-data"><i class="fa fa-check"></i>データセット2: USArrests data</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ビジネス統計</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="判別分析" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">7</span> 判別分析<a href="判別分析.html#判別分析" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="線形判別-2次判別---パッケージmassの利用" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> 線形判別 &amp; 2次判別 - パッケージMASSの利用<a href="判別分析.html#線形判別-2次判別---パッケージmassの利用" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>手初めに, データセットを学習データ (訓練データ) とテストデータに分けずに,
標準パッケージ<strong>MASS</strong>内の線形判別, 2次判別を実行する関数
<code>lda</code>, <code>qda</code>を適用した結果 (内挿予測) を眺めてみる.</p>
<div id="データセット1-ビジネススクールの入学許可データ" class="section level3 unnumbered hasAnchor">
<h3>データセット1: ビジネススクールの入学許可データ<a href="判別分析.html#データセット1-ビジネススクールの入学許可データ" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>- admission.csv
   - GPA
   - GMAT
   - De (意思決定): &quot;admit&quot;, &quot;border&quot;, &quot;notadmit&quot;
- source: https://rstudio-pubs-static.s3.amazonaws.com/35817_2552e05f1d4e4db8ba87b334101a43da.html</code></pre>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="判別分析.html#cb276-1" tabindex="-1"></a><span class="co">#url &lt;- &#39;http://www.biz.uiowa.edu/faculty/jledolter/DataMining/admission.csv&#39;</span></span>
<span id="cb276-2"><a href="判別分析.html#cb276-2" tabindex="-1"></a><span class="co">#admit &lt;- read.csv(url)</span></span>
<span id="cb276-3"><a href="判別分析.html#cb276-3" tabindex="-1"></a>admdat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;admission.csv&quot;</span>,  <span class="at">skip =</span> <span class="dv">2</span>, </span>
<span id="cb276-4"><a href="判別分析.html#cb276-4" tabindex="-1"></a>                   <span class="at">stringsAsFactors =</span> T)    <span class="co"># 注: stringsAsFactors = F(デフォルト) → エラー</span></span>
<span id="cb276-5"><a href="判別分析.html#cb276-5" tabindex="-1"></a><span class="fu">head</span>(admdat)</span>
<span id="cb276-6"><a href="判別分析.html#cb276-6" tabindex="-1"></a><span class="co">#admdat = data.frame(admdat)</span></span>
<span id="cb276-7"><a href="判別分析.html#cb276-7" tabindex="-1"></a><span class="fu">plot</span>(admdat<span class="sc">$</span>GPA, admdat<span class="sc">$</span>GMAT, <span class="at">col =</span> admdat<span class="sc">$</span>De)</span></code></pre></div>
<p><img src="080-discrim_BS_files/figure-html/unnamed-chunk-3-1.png" width="75%" /></p>
<pre><code>#&gt;    GPA GMAT    De
#&gt; 1 2.96  596 admit
#&gt; 2 3.14  473 admit
#&gt; 3 3.22  482 admit
#&gt; 4 3.29  527 admit
#&gt; 5 3.69  505 admit
#&gt; 6 3.46  693 admit</code></pre>
</div>
<div id="線形判別-lda" class="section level3 unnumbered hasAnchor">
<h3>線形判別 (LDA)<a href="判別分析.html#線形判別-lda" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>線形判別の実行は, パッケージ<strong>MASS</strong>の関数<code>lda</code>により行うことができる.</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="判別分析.html#cb278-1" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb278-2"><a href="判別分析.html#cb278-2" tabindex="-1"></a><span class="co"># LDAの実行</span></span>
<span id="cb278-3"><a href="判別分析.html#cb278-3" tabindex="-1"></a>adm_lda <span class="ot">&lt;-</span> <span class="fu">lda</span>(De <span class="sc">~</span> ., admdat)</span>
<span id="cb278-4"><a href="判別分析.html#cb278-4" tabindex="-1"></a><span class="co">#adm_lda</span></span></code></pre></div>
<p>線形判別 (lda) や2次判別 (qda) の出力オブジェクト (適合結果) を
関数<code>predict</code>に入力することで,
判別結果 (class), およびその判断に使用した
事後確率 (posterior) が出力される.
これら (特に前者) が, 判別分析における主要な出力である.</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="判別分析.html#cb279-1" tabindex="-1"></a><span class="co"># 判別結果 (予測結果)</span></span>
<span id="cb279-2"><a href="判別分析.html#cb279-2" tabindex="-1"></a>prd_lda <span class="ot">&lt;-</span> <span class="fu">predict</span>(adm_lda) </span>
<span id="cb279-3"><a href="判別分析.html#cb279-3" tabindex="-1"></a><span class="fu">head</span>(prd_lda<span class="sc">$</span>class)</span>
<span id="cb279-4"><a href="判別分析.html#cb279-4" tabindex="-1"></a><span class="co">#&gt; [1] admit  border border admit  admit  admit </span></span>
<span id="cb279-5"><a href="判別分析.html#cb279-5" tabindex="-1"></a><span class="co">#&gt; Levels: admit border notadmit</span></span>
<span id="cb279-6"><a href="判別分析.html#cb279-6" tabindex="-1"></a><span class="fu">head</span>(prd_lda<span class="sc">$</span>posterior)</span>
<span id="cb279-7"><a href="判別分析.html#cb279-7" tabindex="-1"></a><span class="co">#&gt;       admit       border     notadmit</span></span>
<span id="cb279-8"><a href="判別分析.html#cb279-8" tabindex="-1"></a><span class="co">#&gt; 1 0.6274441 3.677500e-01 4.805886e-03</span></span>
<span id="cb279-9"><a href="判別分析.html#cb279-9" tabindex="-1"></a><span class="co">#&gt; 2 0.1400290 8.578453e-01 2.125682e-03</span></span>
<span id="cb279-10"><a href="判別分析.html#cb279-10" tabindex="-1"></a><span class="co">#&gt; 3 0.4070245 5.925494e-01 4.261541e-04</span></span>
<span id="cb279-11"><a href="判別分析.html#cb279-11" tabindex="-1"></a><span class="co">#&gt; 4 0.9111531 8.883071e-02 1.618774e-05</span></span>
<span id="cb279-12"><a href="判別分析.html#cb279-12" tabindex="-1"></a><span class="co">#&gt; 5 0.9989964 1.003605e-03 6.361722e-10</span></span>
<span id="cb279-13"><a href="判別分析.html#cb279-13" tabindex="-1"></a><span class="co">#&gt; 6 0.9999849 1.506768e-05 6.281005e-11</span></span>
<span id="cb279-14"><a href="判別分析.html#cb279-14" tabindex="-1"></a><span class="co"># →　出力: $class,  $posterior,  $x</span></span></code></pre></div>
<ul>
<li>外挿予測 &amp; 精度評価</li>
</ul>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="判別分析.html#cb280-1" tabindex="-1"></a><span class="fu">predict</span>(adm_lda, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">GPA =</span> <span class="fl">3.21</span>, <span class="at">GMAT =</span> <span class="dv">497</span>))</span>
<span id="cb280-2"><a href="判別分析.html#cb280-2" tabindex="-1"></a>(tbl_lda <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">predict</span>(adm_lda)<span class="sc">$</span>class, admdat<span class="sc">$</span>De))</span>
<span id="cb280-3"><a href="判別分析.html#cb280-3" tabindex="-1"></a><span class="co">#&gt; $class</span></span>
<span id="cb280-4"><a href="判別分析.html#cb280-4" tabindex="-1"></a><span class="co">#&gt; [1] admit</span></span>
<span id="cb280-5"><a href="判別分析.html#cb280-5" tabindex="-1"></a><span class="co">#&gt; Levels: admit border notadmit</span></span>
<span id="cb280-6"><a href="判別分析.html#cb280-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb280-7"><a href="判別分析.html#cb280-7" tabindex="-1"></a><span class="co">#&gt; $posterior</span></span>
<span id="cb280-8"><a href="判別分析.html#cb280-8" tabindex="-1"></a><span class="co">#&gt;       admit    border     notadmit</span></span>
<span id="cb280-9"><a href="判別分析.html#cb280-9" tabindex="-1"></a><span class="co">#&gt; 1 0.5180421 0.4816015 0.0003563717</span></span>
<span id="cb280-10"><a href="判別分析.html#cb280-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb280-11"><a href="判別分析.html#cb280-11" tabindex="-1"></a><span class="co">#&gt; $x</span></span>
<span id="cb280-12"><a href="判別分析.html#cb280-12" tabindex="-1"></a><span class="co">#&gt;        LD1      LD2</span></span>
<span id="cb280-13"><a href="判別分析.html#cb280-13" tabindex="-1"></a><span class="co">#&gt; 1 1.252409 0.318194</span></span>
<span id="cb280-14"><a href="判別分析.html#cb280-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb280-15"><a href="判別分析.html#cb280-15" tabindex="-1"></a><span class="co">#&gt;           </span></span>
<span id="cb280-16"><a href="判別分析.html#cb280-16" tabindex="-1"></a><span class="co">#&gt;            admit border notadmit</span></span>
<span id="cb280-17"><a href="判別分析.html#cb280-17" tabindex="-1"></a><span class="co">#&gt;   admit       28      1        0</span></span>
<span id="cb280-18"><a href="判別分析.html#cb280-18" tabindex="-1"></a><span class="co">#&gt;   border       3     24        2</span></span>
<span id="cb280-19"><a href="判別分析.html#cb280-19" tabindex="-1"></a><span class="co">#&gt;   notadmit     0      1       26</span></span></code></pre></div>
</div>
<div id="次判別-qda" class="section level3 unnumbered hasAnchor">
<h3>2次判別 (QDA)<a href="判別分析.html#次判別-qda" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>線形判別の実行は, パッケージ<strong>MASS</strong>の関数<code>qda</code>により行うことができる.</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="判別分析.html#cb281-1" tabindex="-1"></a><span class="co"># QDAの実行</span></span>
<span id="cb281-2"><a href="判別分析.html#cb281-2" tabindex="-1"></a>adm_qda <span class="ot">&lt;-</span> <span class="fu">qda</span>(De <span class="sc">~</span> ., admdat)</span>
<span id="cb281-3"><a href="判別分析.html#cb281-3" tabindex="-1"></a><span class="co">#adm_qda</span></span></code></pre></div>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="判別分析.html#cb282-1" tabindex="-1"></a><span class="co"># 判別結果 (予測結果)</span></span>
<span id="cb282-2"><a href="判別分析.html#cb282-2" tabindex="-1"></a>prd_qda <span class="ot">&lt;-</span> <span class="fu">predict</span>(adm_qda) </span>
<span id="cb282-3"><a href="判別分析.html#cb282-3" tabindex="-1"></a><span class="fu">head</span>(prd_qda<span class="sc">$</span>class)</span>
<span id="cb282-4"><a href="判別分析.html#cb282-4" tabindex="-1"></a><span class="co">#&gt; [1] admit  border admit  admit  admit  admit </span></span>
<span id="cb282-5"><a href="判別分析.html#cb282-5" tabindex="-1"></a><span class="co">#&gt; Levels: admit border notadmit</span></span>
<span id="cb282-6"><a href="判別分析.html#cb282-6" tabindex="-1"></a><span class="fu">head</span>(prd_qda<span class="sc">$</span>posterior)</span>
<span id="cb282-7"><a href="判別分析.html#cb282-7" tabindex="-1"></a><span class="co">#&gt;       admit       border     notadmit</span></span>
<span id="cb282-8"><a href="判別分析.html#cb282-8" tabindex="-1"></a><span class="co">#&gt; 1 0.9827310 5.740445e-03 1.152851e-02</span></span>
<span id="cb282-9"><a href="判別分析.html#cb282-9" tabindex="-1"></a><span class="co">#&gt; 2 0.3098756 6.880045e-01 2.119862e-03</span></span>
<span id="cb282-10"><a href="判別分析.html#cb282-10" tabindex="-1"></a><span class="co">#&gt; 3 0.8168026 1.826903e-01 5.070901e-04</span></span>
<span id="cb282-11"><a href="判別分析.html#cb282-11" tabindex="-1"></a><span class="co">#&gt; 4 0.9995494 4.307666e-04 1.985923e-05</span></span>
<span id="cb282-12"><a href="判別分析.html#cb282-12" tabindex="-1"></a><span class="co">#&gt; 5 1.0000000 2.322074e-09 4.254151e-10</span></span>
<span id="cb282-13"><a href="判別分析.html#cb282-13" tabindex="-1"></a><span class="co">#&gt; 6 1.0000000 3.974095e-20 1.887372e-10</span></span>
<span id="cb282-14"><a href="判別分析.html#cb282-14" tabindex="-1"></a><span class="co"># →　出力: $class,  $posterior </span></span></code></pre></div>
<ul>
<li>外挿予測 &amp; 精度評価</li>
</ul>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="判別分析.html#cb283-1" tabindex="-1"></a><span class="fu">predict</span>(adm_qda, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">GPA =</span> <span class="fl">3.21</span>, <span class="at">GMAT =</span> <span class="dv">497</span>))</span>
<span id="cb283-2"><a href="判別分析.html#cb283-2" tabindex="-1"></a>(tbl_qda <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">predict</span>(adm_qda)<span class="sc">$</span>class, admdat<span class="sc">$</span>De))</span>
<span id="cb283-3"><a href="判別分析.html#cb283-3" tabindex="-1"></a><span class="co">#&gt; $class</span></span>
<span id="cb283-4"><a href="判別分析.html#cb283-4" tabindex="-1"></a><span class="co">#&gt; [1] admit</span></span>
<span id="cb283-5"><a href="判別分析.html#cb283-5" tabindex="-1"></a><span class="co">#&gt; Levels: admit border notadmit</span></span>
<span id="cb283-6"><a href="判別分析.html#cb283-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb283-7"><a href="判別分析.html#cb283-7" tabindex="-1"></a><span class="co">#&gt; $posterior</span></span>
<span id="cb283-8"><a href="判別分析.html#cb283-8" tabindex="-1"></a><span class="co">#&gt;       admit    border     notadmit</span></span>
<span id="cb283-9"><a href="判別分析.html#cb283-9" tabindex="-1"></a><span class="co">#&gt; 1 0.9226763 0.0768693 0.0004544468</span></span>
<span id="cb283-10"><a href="判別分析.html#cb283-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb283-11"><a href="判別分析.html#cb283-11" tabindex="-1"></a><span class="co">#&gt;           </span></span>
<span id="cb283-12"><a href="判別分析.html#cb283-12" tabindex="-1"></a><span class="co">#&gt;            admit border notadmit</span></span>
<span id="cb283-13"><a href="判別分析.html#cb283-13" tabindex="-1"></a><span class="co">#&gt;   admit       30      1        0</span></span>
<span id="cb283-14"><a href="判別分析.html#cb283-14" tabindex="-1"></a><span class="co">#&gt;   border       1     25        1</span></span>
<span id="cb283-15"><a href="判別分析.html#cb283-15" tabindex="-1"></a><span class="co">#&gt;   notadmit     0      0       27</span></span></code></pre></div>
<p>なお, 学習済モデルのパラメータ推定値は
<code>lda</code>や<code>qda</code>の出力オブジェクトに格納され, これらから
線形判別関数や2次判別関数や, 判別境界の形状を知ることができる (ここでは省略).</p>
</div>
</div>
<div id="knn法---パッケージclassの利用" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> kNN法 - パッケージclassの利用<a href="判別分析.html#knn法---パッケージclassの利用" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>kNN法を実行する関数<code>knn</code>はパッケージ<strong>class</strong>に含まれている.
入学許可データに対して, 上と同様, 判別 (内挿予測) を試みる.</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="判別分析.html#cb284-1" tabindex="-1"></a><span class="co"># kNN法</span></span>
<span id="cb284-2"><a href="判別分析.html#cb284-2" tabindex="-1"></a><span class="fu">library</span>(class)</span>
<span id="cb284-3"><a href="判別分析.html#cb284-3" tabindex="-1"></a>pred_knn <span class="ot">&lt;-</span> <span class="fu">knn</span>(admdat[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], </span>
<span id="cb284-4"><a href="判別分析.html#cb284-4" tabindex="-1"></a>                admdat[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],  </span>
<span id="cb284-5"><a href="判別分析.html#cb284-5" tabindex="-1"></a>                <span class="at">cl =</span> admdat[, <span class="dv">3</span>], <span class="at">k =</span> <span class="dv">5</span>)</span>
<span id="cb284-6"><a href="判別分析.html#cb284-6" tabindex="-1"></a>(tbl_knn <span class="ot">&lt;-</span> <span class="fu">table</span>(pred_knn,  admdat[, <span class="dv">3</span>]))</span>
<span id="cb284-7"><a href="判別分析.html#cb284-7" tabindex="-1"></a><span class="co">#　confusionMatrix(knn_tab,  mode = &quot;prec_recall&quot;)</span></span>
<span id="cb284-8"><a href="判別分析.html#cb284-8" tabindex="-1"></a><span class="co">#&gt;           </span></span>
<span id="cb284-9"><a href="判別分析.html#cb284-9" tabindex="-1"></a><span class="co">#&gt; pred_knn   admit border notadmit</span></span>
<span id="cb284-10"><a href="判別分析.html#cb284-10" tabindex="-1"></a><span class="co">#&gt;   admit       25      1        1</span></span>
<span id="cb284-11"><a href="判別分析.html#cb284-11" tabindex="-1"></a><span class="co">#&gt;   border       3     15        7</span></span>
<span id="cb284-12"><a href="判別分析.html#cb284-12" tabindex="-1"></a><span class="co">#&gt;   notadmit     3     10       20</span></span></code></pre></div>
</div>
<div id="データセット分割学習判別評価" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> データセット分割・学習・判別・評価<a href="判別分析.html#データセット分割学習判別評価" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>実際の判別分析においては, まず,
データセットを学習データ (訓練データ) とテストデータに分け,
前者でモデルを推定 (学習) し, 後者でパフォーマンスを評価する必要がある.</p>
<div id="データセット2-個人ローンデフォルトデータ-仮想" class="section level3 unnumbered hasAnchor">
<h3>データセット2: 個人ローン・デフォルト・データ (仮想)<a href="判別分析.html#データセット2-個人ローンデフォルトデータ-仮想" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>- default1.csv, 7500件
  - ローン残高 (万円) 
  - 収入 (万円)
  - 職種 (A/B)
  -デフォルト (1/0)</code></pre>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="判別分析.html#cb286-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;default1.csv&quot;</span>)</span>
<span id="cb286-2"><a href="判別分析.html#cb286-2" tabindex="-1"></a>nsize <span class="ot">&lt;-</span> <span class="fu">nrow</span>(dat)</span></code></pre></div>
<p>データセットをランダムに, 2/3を学習用, 残りをテスト用に分割する.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="判別分析.html#cb287-1" tabindex="-1"></a><span class="co"># 学習用データ, テスト用データに分割</span></span>
<span id="cb287-2"><a href="判別分析.html#cb287-2" tabindex="-1"></a>id_train <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>nsize, <span class="fu">round</span>(nsize <span class="sc">/</span> <span class="dv">3</span> <span class="sc">*</span> <span class="dv">2</span>))</span>
<span id="cb287-3"><a href="判別分析.html#cb287-3" tabindex="-1"></a>dat_train <span class="ot">&lt;-</span> dat[id_train, ]</span>
<span id="cb287-4"><a href="判別分析.html#cb287-4" tabindex="-1"></a>dat_test <span class="ot">&lt;-</span> dat[<span class="sc">-</span> id_train, ]</span></code></pre></div>
<p>データセットの分割は通常ランダムに行うが,
学習済モデルの判別パフォーマンスはデータセットの分割の仕方に依存する. そこで, そのような分割への依存性を軽減し,
モデルによる外挿予測の精度評価の信頼性を高めるために交互検証 (クロス・バリデーション) と呼ばれる方法を行うことが多い (ここでは省略する).</p>
</div>
<div id="線形判別" class="section level3 unnumbered hasAnchor">
<h3>線形判別<a href="判別分析.html#線形判別" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="判別分析.html#cb288-1" tabindex="-1"></a><span class="co"># 線形判別</span></span>
<span id="cb288-2"><a href="判別分析.html#cb288-2" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb288-3"><a href="判別分析.html#cb288-3" tabindex="-1"></a>dat_lda <span class="ot">&lt;-</span> <span class="fu">lda</span>(デフォルト <span class="sc">~</span> ローン残高 <span class="sc">+</span> 収入, <span class="at">data =</span> dat_train)    </span>
<span id="cb288-4"><a href="判別分析.html#cb288-4" tabindex="-1"></a><span class="co"># dat_lda</span></span>
<span id="cb288-5"><a href="判別分析.html#cb288-5" tabindex="-1"></a><span class="co"># dat_lda$scaling               # 線形判別関数の係数</span></span>
<span id="cb288-6"><a href="判別分析.html#cb288-6" tabindex="-1"></a><span class="co"># hist(predict(dat_lda)$x)      # 判別得点</span></span>
<span id="cb288-7"><a href="判別分析.html#cb288-7" tabindex="-1"></a><span class="co"># dat_lda$means                 # グループ平均</span></span>
<span id="cb288-8"><a href="判別分析.html#cb288-8" tabindex="-1"></a><span class="co"># dat_lda$prior                 # 事前確率</span></span></code></pre></div>
<p>学習済モデルのパフォーマンス評価は,
テストデータを使って判別させ (外挿予測), 正解と比較することにより行う.</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="判別分析.html#cb289-1" tabindex="-1"></a><span class="co"># 予測 (テストデータに対する判別), パフォーマンス評価</span></span>
<span id="cb289-2"><a href="判別分析.html#cb289-2" tabindex="-1"></a>lda_tab <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">predict</span>(dat_lda,  dat_test)<span class="sc">$</span>class, </span>
<span id="cb289-3"><a href="判別分析.html#cb289-3" tabindex="-1"></a>                 dat_test[, <span class="st">&quot;デフォルト&quot;</span>])</span>
<span id="cb289-4"><a href="判別分析.html#cb289-4" tabindex="-1"></a><span class="co"># library(caret)</span></span>
<span id="cb289-5"><a href="判別分析.html#cb289-5" tabindex="-1"></a><span class="co"># confusionMatrix(lda_tab,  mode = &quot;prec_recall&quot;)</span></span></code></pre></div>
</div>
<div id="knn法" class="section level3 unnumbered hasAnchor">
<h3>kNN法<a href="判別分析.html#knn法" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="判別分析.html#cb290-1" tabindex="-1"></a><span class="co"># kNN法</span></span>
<span id="cb290-2"><a href="判別分析.html#cb290-2" tabindex="-1"></a><span class="fu">library</span>(class)</span>
<span id="cb290-3"><a href="判別分析.html#cb290-3" tabindex="-1"></a>pred_knn <span class="ot">&lt;-</span> <span class="fu">knn</span>(dat_train[, <span class="fu">c</span>(<span class="st">&quot;ローン残高&quot;</span>, <span class="st">&quot;収入&quot;</span>)], </span>
<span id="cb290-4"><a href="判別分析.html#cb290-4" tabindex="-1"></a>                dat_test[, <span class="fu">c</span>(<span class="st">&quot;ローン残高&quot;</span>, <span class="st">&quot;収入&quot;</span>)],  </span>
<span id="cb290-5"><a href="判別分析.html#cb290-5" tabindex="-1"></a>                <span class="at">cl =</span> dat_train[, <span class="st">&quot;デフォルト&quot;</span>], <span class="at">k =</span> <span class="dv">3</span>)</span>
<span id="cb290-6"><a href="判別分析.html#cb290-6" tabindex="-1"></a>(tbl_knn <span class="ot">&lt;-</span> <span class="fu">table</span>(pred_knn,  dat_test[, <span class="st">&quot;デフォルト&quot;</span>]))</span>
<span id="cb290-7"><a href="判別分析.html#cb290-7" tabindex="-1"></a><span class="co"># confusionMatrix(knn_tab,  mode = &quot;prec_recall&quot;)</span></span>
<span id="cb290-8"><a href="判別分析.html#cb290-8" tabindex="-1"></a><span class="co">#&gt;         </span></span>
<span id="cb290-9"><a href="判別分析.html#cb290-9" tabindex="-1"></a><span class="co">#&gt; pred_knn    0    1</span></span>
<span id="cb290-10"><a href="判別分析.html#cb290-10" tabindex="-1"></a><span class="co">#&gt;        0 2406   56</span></span>
<span id="cb290-11"><a href="判別分析.html#cb290-11" tabindex="-1"></a><span class="co">#&gt;        1   15   23</span></span></code></pre></div>
</div>
</div>
<div id="他パッケージの利用" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> 他パッケージの利用<a href="判別分析.html#他パッケージの利用" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="パッケージklar" class="section level3 unnumbered hasAnchor">
<h3>パッケージ<strong>klaR</strong><a href="判別分析.html#パッケージklar" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>関数<code>partimat()</code>は, 判別分析やそれ以外の多様なクラス分類手法をサポートしている.
- 引数<code>method</code>で指定: “lda”, “qda”, “rpart”, “naiveBayes”, “rda”, “sknn”, “svmlight”</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="判別分析.html#cb291-1" tabindex="-1"></a><span class="co"># &quot;klaR&quot;パッケージの利用</span></span>
<span id="cb291-2"><a href="判別分析.html#cb291-2" tabindex="-1"></a><span class="co">#install.packages(&#39;klaR&#39;)</span></span>
<span id="cb291-3"><a href="判別分析.html#cb291-3" tabindex="-1"></a><span class="fu">library</span>(klaR)</span>
<span id="cb291-4"><a href="判別分析.html#cb291-4" tabindex="-1"></a><span class="fu">partimat</span>(De <span class="sc">~</span> ., <span class="at">data =</span> admdat,  <span class="at">method =</span> <span class="st">&quot;lda&quot;</span>)    <span class="co"># 線形判別</span></span></code></pre></div>
<p><img src="080-discrim_BS_files/figure-html/unnamed-chunk-16-1.png" width="75%" /></p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="判別分析.html#cb292-1" tabindex="-1"></a><span class="fu">partimat</span>(De <span class="sc">~</span> ., <span class="at">data =</span> admdat,  <span class="at">method =</span> <span class="st">&quot;qda&quot;</span>)    <span class="co"># 2次判別</span></span></code></pre></div>
<p><img src="080-discrim_BS_files/figure-html/unnamed-chunk-16-2.png" width="75%" /></p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="判別分析.html#cb293-1" tabindex="-1"></a><span class="fu">partimat</span>(De <span class="sc">~</span> ., <span class="at">data =</span> admdat, <span class="at">method =</span> <span class="st">&quot;sknn&quot;</span>)    <span class="co"># Simple kNN法 (デフォルトk = 3)</span></span></code></pre></div>
<p><img src="080-discrim_BS_files/figure-html/unnamed-chunk-16-3.png" width="75%" /></p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="判別分析.html#cb294-1" tabindex="-1"></a><span class="fu">partimat</span>(De <span class="sc">~</span> ., <span class="at">data =</span> admdat,  <span class="at">method =</span> <span class="st">&quot;naiveBayes&quot;</span>)     <span class="co"># ナイーブベイズ法</span></span></code></pre></div>
<p><img src="080-discrim_BS_files/figure-html/unnamed-chunk-16-4.png" width="75%" /></p>
<p>変数間のスケールを統一 (標準化) した後にkNN法を再実行してみる.</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="判別分析.html#cb295-1" tabindex="-1"></a>adm2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">GPA =</span> <span class="fu">scale</span>(admdat<span class="sc">$</span>GPA),  </span>
<span id="cb295-2"><a href="判別分析.html#cb295-2" tabindex="-1"></a>                   <span class="at">GMAT =</span> <span class="fu">scale</span>(admdat<span class="sc">$</span>GMAT),  </span>
<span id="cb295-3"><a href="判別分析.html#cb295-3" tabindex="-1"></a>                   <span class="at">De =</span> admdat<span class="sc">$</span>De)</span>
<span id="cb295-4"><a href="判別分析.html#cb295-4" tabindex="-1"></a><span class="fu">partimat</span>(De <span class="sc">~</span> ., <span class="at">data =</span> adm2, <span class="at">method =</span> <span class="st">&quot;sknn&quot;</span>)  <span class="co"># Simple kNN法 (デフォルトk = 3),  変数標準化後</span></span></code></pre></div>
<p><img src="080-discrim_BS_files/figure-html/unnamed-chunk-17-1.png" width="75%" /></p>
<p>パッケージ<strong>klaR</strong>内には, ナイーブベイズ法を実行する関数<code>NaiveBayes()</code>も用意されている.</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="判別分析.html#cb296-1" tabindex="-1"></a><span class="co"># ナイーブベイズ法</span></span>
<span id="cb296-2"><a href="判別分析.html#cb296-2" tabindex="-1"></a>adm_NB  <span class="ot">&lt;-</span>  <span class="fu">NaiveBayes</span>(De <span class="sc">~</span> ., <span class="at">data =</span> admdat) <span class="co"># usekernel = F(デフォルト) → 正規分布</span></span>
<span id="cb296-3"><a href="判別分析.html#cb296-3" tabindex="-1"></a><span class="co"># predict(adm_NB)</span></span>
<span id="cb296-4"><a href="判別分析.html#cb296-4" tabindex="-1"></a><span class="co"># # →　出力: $class,  $posterior</span></span>
<span id="cb296-5"><a href="判別分析.html#cb296-5" tabindex="-1"></a>(tbl_nb <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">predict</span>(adm_NB)<span class="sc">$</span>class, admdat<span class="sc">$</span>De))</span>
<span id="cb296-6"><a href="判別分析.html#cb296-6" tabindex="-1"></a><span class="co">#&gt;           </span></span>
<span id="cb296-7"><a href="判別分析.html#cb296-7" tabindex="-1"></a><span class="co">#&gt;            admit border notadmit</span></span>
<span id="cb296-8"><a href="判別分析.html#cb296-8" tabindex="-1"></a><span class="co">#&gt;   admit       28      1        0</span></span>
<span id="cb296-9"><a href="判別分析.html#cb296-9" tabindex="-1"></a><span class="co">#&gt;   border       3     23        2</span></span>
<span id="cb296-10"><a href="判別分析.html#cb296-10" tabindex="-1"></a><span class="co">#&gt;   notadmit     0      2       26</span></span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ロジットブロビット回帰分析.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="決定木分析.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
