<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 線形回帰分析 | ビジネス統計</title>
  <meta name="description" content="5 線形回帰分析 | ビジネス統計" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="5 線形回帰分析 | ビジネス統計" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 線形回帰分析 | ビジネス統計" />
  
  
  

<meta name="author" content="林 高樹" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="分散分析-anova.html"/>
<link rel="next" href="ロジットブロビット回帰分析.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> はじめに</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#コースの目的"><i class="fa fa-check"></i><b>1.1</b> コースの目的</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#統計学統計的手法の学習について"><i class="fa fa-check"></i><b>1.2</b> 統計学/統計的手法の学習について</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#学習の目標"><i class="fa fa-check"></i>学習の目標</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#統計学統計的手法の学習方法"><i class="fa fa-check"></i>統計学/統計的手法の学習方法</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#統計学統計的手法の学習ステップ"><i class="fa fa-check"></i>統計学/統計的手法の学習ステップ</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#ビジネス応用における統計学の最近の趨勢"><i class="fa fa-check"></i><b>1.3</b> ビジネス応用における統計学の最近の趨勢</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#本書内の記載の注意点"><i class="fa fa-check"></i><b>1.4</b> 本書内の記載の注意点</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r言語の基本.html"><a href="r言語の基本.html"><i class="fa fa-check"></i><b>2</b> R言語の基本</a>
<ul>
<li class="chapter" data-level="2.1" data-path="r言語の基本.html"><a href="r言語の基本.html#rの基本プログラミング"><i class="fa fa-check"></i><b>2.1</b> Rの基本プログラミング</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="r言語の基本.html"><a href="r言語の基本.html#基本操作"><i class="fa fa-check"></i><b>2.1.1</b> 基本操作</a></li>
<li class="chapter" data-level="2.1.2" data-path="r言語の基本.html"><a href="r言語の基本.html#基本構文"><i class="fa fa-check"></i><b>2.1.2</b> 基本構文</a></li>
<li class="chapter" data-level="2.1.3" data-path="r言語の基本.html"><a href="r言語の基本.html#自作関数"><i class="fa fa-check"></i><b>2.1.3</b> 自作関数</a></li>
<li class="chapter" data-level="2.1.4" data-path="r言語の基本.html"><a href="r言語の基本.html#パッケージのインストール-読み込み"><i class="fa fa-check"></i><b>2.1.4</b> パッケージのインストール &amp; 読み込み</a></li>
<li class="chapter" data-level="2.1.5" data-path="r言語の基本.html"><a href="r言語の基本.html#ヘルプ"><i class="fa fa-check"></i><b>2.1.5</b> ヘルプ</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="r言語の基本.html"><a href="r言語の基本.html#データの型や構造"><i class="fa fa-check"></i><b>2.2</b> データの型や構造</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="r言語の基本.html"><a href="r言語の基本.html#データの値の種類-データ型"><i class="fa fa-check"></i><b>2.2.1</b> データの値の種類 (“データ型”)</a></li>
<li class="chapter" data-level="2.2.2" data-path="r言語の基本.html"><a href="r言語の基本.html#データの配列の仕方-データ構造"><i class="fa fa-check"></i><b>2.2.2</b> データの配列の仕方 (“データ構造”)</a></li>
<li class="chapter" data-level="2.2.3" data-path="r言語の基本.html"><a href="r言語の基本.html#ベクトル"><i class="fa fa-check"></i><b>2.2.3</b> ベクトル</a></li>
<li class="chapter" data-level="2.2.4" data-path="r言語の基本.html"><a href="r言語の基本.html#行列"><i class="fa fa-check"></i><b>2.2.4</b> 行列</a></li>
<li class="chapter" data-level="2.2.5" data-path="r言語の基本.html"><a href="r言語の基本.html#リスト"><i class="fa fa-check"></i><b>2.2.5</b> リスト</a></li>
<li class="chapter" data-level="2.2.6" data-path="r言語の基本.html"><a href="r言語の基本.html#データフレーム"><i class="fa fa-check"></i><b>2.2.6</b> データフレーム</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="r言語の基本.html"><a href="r言語の基本.html#データの操作演算"><i class="fa fa-check"></i><b>2.3</b> データの操作・演算</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="r言語の基本.html"><a href="r言語の基本.html#ベクトルの結合-ソート"><i class="fa fa-check"></i><b>2.3.1</b> ベクトルの結合, ソート</a></li>
<li class="chapter" data-level="2.3.2" data-path="r言語の基本.html"><a href="r言語の基本.html#二項演算"><i class="fa fa-check"></i><b>2.3.2</b> 二項演算</a></li>
<li class="chapter" data-level="2.3.3" data-path="r言語の基本.html"><a href="r言語の基本.html#論理演算"><i class="fa fa-check"></i><b>2.3.3</b> 論理演算</a></li>
<li class="chapter" data-level="2.3.4" data-path="r言語の基本.html"><a href="r言語の基本.html#条件式"><i class="fa fa-check"></i><b>2.3.4</b> 条件式</a></li>
<li class="chapter" data-level="2.3.5" data-path="r言語の基本.html"><a href="r言語の基本.html#行列演算"><i class="fa fa-check"></i><b>2.3.5</b> 行列演算</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="r言語の基本.html"><a href="r言語の基本.html#r関数"><i class="fa fa-check"></i><b>2.4</b> R関数</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="r言語の基本.html"><a href="r言語の基本.html#数学基本関数"><i class="fa fa-check"></i><b>2.4.1</b> 数学基本関数</a></li>
<li class="chapter" data-level="2.4.2" data-path="r言語の基本.html"><a href="r言語の基本.html#基本統計量の計算"><i class="fa fa-check"></i><b>2.4.2</b> 基本統計量の計算</a></li>
<li class="chapter" data-level="2.4.3" data-path="r言語の基本.html"><a href="r言語の基本.html#確率分布"><i class="fa fa-check"></i><b>2.4.3</b> 確率分布</a></li>
<li class="chapter" data-level="2.4.4" data-path="r言語の基本.html"><a href="r言語の基本.html#その他便利な関数"><i class="fa fa-check"></i><b>2.4.4</b> その他便利な関数</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="r言語の基本.html"><a href="r言語の基本.html#データの可視化"><i class="fa fa-check"></i><b>2.5</b> データの可視化</a></li>
<li class="chapter" data-level="2.6" data-path="r言語の基本.html"><a href="r言語の基本.html#ファイル入出力"><i class="fa fa-check"></i><b>2.6</b> ファイル入出力</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="r言語の基本.html"><a href="r言語の基本.html#テキストファイル読み込み"><i class="fa fa-check"></i><b>2.6.1</b> テキストファイル読み込み</a></li>
<li class="chapter" data-level="2.6.2" data-path="r言語の基本.html"><a href="r言語の基本.html#テキストファイル書き出し"><i class="fa fa-check"></i><b>2.6.2</b> テキストファイル書き出し</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="仮説検定.html"><a href="仮説検定.html"><i class="fa fa-check"></i><b>3</b> 仮説検定</a>
<ul>
<li class="chapter" data-level="3.1" data-path="仮説検定.html"><a href="仮説検定.html#平均値の差の検定"><i class="fa fa-check"></i><b>3.1</b> 平均値の差の検定</a></li>
<li class="chapter" data-level="3.2" data-path="仮説検定.html"><a href="仮説検定.html#カイ二乗検定"><i class="fa fa-check"></i><b>3.2</b> カイ二乗検定</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="仮説検定.html"><a href="仮説検定.html#独立性検定"><i class="fa fa-check"></i><b>3.2.1</b> 独立性検定</a></li>
<li class="chapter" data-level="3.2.2" data-path="仮説検定.html"><a href="仮説検定.html#適合度検定"><i class="fa fa-check"></i><b>3.2.2</b> 適合度検定</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="仮説検定.html"><a href="仮説検定.html#分析例-統計テストデータ"><i class="fa fa-check"></i><b>3.3</b> 分析例: 統計テストデータ</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="分散分析-anova.html"><a href="分散分析-anova.html"><i class="fa fa-check"></i><b>4</b> 分散分析 (ANOVA)</a>
<ul>
<li class="chapter" data-level="4.1" data-path="分散分析-anova.html"><a href="分散分析-anova.html#元配置anova"><i class="fa fa-check"></i><b>4.1</b> 1元配置ANOVA</a></li>
<li class="chapter" data-level="4.2" data-path="分散分析-anova.html"><a href="分散分析-anova.html#元配置anova-1"><i class="fa fa-check"></i><b>4.2</b> 2元配置ANOVA</a></li>
<li class="chapter" data-level="4.3" data-path="分散分析-anova.html"><a href="分散分析-anova.html#分析例"><i class="fa fa-check"></i><b>4.3</b> 分析例</a>
<ul>
<li class="chapter" data-level="" data-path="分散分析-anova.html"><a href="分散分析-anova.html#データ1-2業種口コミサイト仮想データ"><i class="fa fa-check"></i>データ1: 2業種口コミサイト(仮想データ)</a></li>
<li class="chapter" data-level="" data-path="分散分析-anova.html"><a href="分散分析-anova.html#データ2-統計小テストデータ"><i class="fa fa-check"></i>データ2: 統計小テストデータ</a></li>
<li class="chapter" data-level="" data-path="分散分析-anova.html"><a href="分散分析-anova.html#データ3-経営科学アンケート"><i class="fa fa-check"></i>データ3: 経営科学アンケート</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="線形回帰分析.html"><a href="線形回帰分析.html"><i class="fa fa-check"></i><b>5</b> 線形回帰分析</a>
<ul>
<li class="chapter" data-level="5.1" data-path="線形回帰分析.html"><a href="線形回帰分析.html#重回帰分析の基本操作"><i class="fa fa-check"></i><b>5.1</b> 重回帰分析の基本操作</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰分析.html"><a href="線形回帰分析.html#データ1-1ルーム賃貸マンション"><i class="fa fa-check"></i>データ1: 1ルーム賃貸マンション</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="線形回帰分析.html"><a href="線形回帰分析.html#変数の選択"><i class="fa fa-check"></i><b>5.2</b> 変数の選択</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰分析.html"><a href="線形回帰分析.html#データ2-ボストン市内住宅物件価格データ"><i class="fa fa-check"></i>データ2: ボストン市内住宅物件価格データ</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="線形回帰分析.html"><a href="線形回帰分析.html#説明変数に質的変数を含む回帰"><i class="fa fa-check"></i><b>5.3</b> 説明変数に質的変数を含む回帰</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰分析.html"><a href="線形回帰分析.html#データセット3-高速道路事故データ"><i class="fa fa-check"></i>データセット#3: 高速道路事故データ</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="線形回帰分析.html"><a href="線形回帰分析.html#時系列データ同士の回帰"><i class="fa fa-check"></i><b>5.4</b> 時系列データ同士の回帰</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰分析.html"><a href="線形回帰分析.html#データセット4-株式市場"><i class="fa fa-check"></i>データセット#4: 株式市場</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="線形回帰分析.html"><a href="線形回帰分析.html#線形モデル"><i class="fa fa-check"></i><b>5.5</b> 線形モデル</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰分析.html"><a href="線形回帰分析.html#因子モデルの例-交互作用なし"><i class="fa fa-check"></i>2因子モデルの例 (交互作用なし)</a></li>
<li class="chapter" data-level="" data-path="線形回帰分析.html"><a href="線形回帰分析.html#因子モデルの例-交互作用有り"><i class="fa fa-check"></i>2因子モデルの例 (交互作用有り)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ロジットブロビット回帰分析.html"><a href="ロジットブロビット回帰分析.html"><i class="fa fa-check"></i><b>6</b> ロジット/ブロビット回帰分析</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ロジットブロビット回帰分析.html"><a href="ロジットブロビット回帰分析.html#ロジット回帰分析の基本操作"><i class="fa fa-check"></i><b>6.1</b> ロジット回帰分析の基本操作</a>
<ul>
<li class="chapter" data-level="" data-path="ロジットブロビット回帰分析.html"><a href="ロジットブロビット回帰分析.html#ロジットモデル-シミュレーションデータ"><i class="fa fa-check"></i>ロジットモデル: シミュレーションデータ</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="ロジットブロビット回帰分析.html"><a href="ロジットブロビット回帰分析.html#データ分析例"><i class="fa fa-check"></i><b>6.2</b> データ分析例</a>
<ul>
<li class="chapter" data-level="" data-path="ロジットブロビット回帰分析.html"><a href="ロジットブロビット回帰分析.html#データセット-1-販売プロモーションデータ-仮想"><i class="fa fa-check"></i>データセット (1): 販売プロモーション・データ (仮想)</a></li>
<li class="chapter" data-level="" data-path="ロジットブロビット回帰分析.html"><a href="ロジットブロビット回帰分析.html#データセット-2-個人ローンデフォルトデータ-仮想"><i class="fa fa-check"></i>データセット (2): 個人ローン・デフォルト・データ (仮想)</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="ロジットブロビット回帰分析.html"><a href="ロジットブロビット回帰分析.html#関数factorについて"><i class="fa fa-check"></i><b>6.3</b> 関数<code>factor()</code>について</a>
<ul>
<li class="chapter" data-level="" data-path="ロジットブロビット回帰分析.html"><a href="ロジットブロビット回帰分析.html#rでのfactor関数の使い方"><i class="fa fa-check"></i>Rでのfactor関数の使い方</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ビジネス統計</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="線形回帰分析" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> 線形回帰分析<a href="線形回帰分析.html#線形回帰分析" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="重回帰分析の基本操作" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> 重回帰分析の基本操作<a href="線形回帰分析.html#重回帰分析の基本操作" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="データ1-1ルーム賃貸マンション" class="section level3 unnumbered hasAnchor">
<h3>データ1: 1ルーム賃貸マンション<a href="線形回帰分析.html#データ1-1ルーム賃貸マンション" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>- 1ルーム賃貸マンション, 家賃データ, 50件 (仮想データ)
  - rent: 月額家賃 (円)
  - area: 専有面積 (平米) 
  - yrs: 築後年数 (年)
  - dist: 最寄駅からの徒歩距離 (m)</code></pre>
<ul>
<li>データの読み込み, 回帰実行</li>
</ul>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="線形回帰分析.html#cb169-1" tabindex="-1"></a>rentdat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;rentdat.csv&quot;</span>, <span class="at">header =</span> T)</span>
<span id="cb169-2"><a href="線形回帰分析.html#cb169-2" tabindex="-1"></a><span class="fu">head</span>(rentdat)</span>
<span id="cb169-3"><a href="線形回帰分析.html#cb169-3" tabindex="-1"></a><span class="co">#&gt;    rent  area   yrs    dist</span></span>
<span id="cb169-4"><a href="線形回帰分析.html#cb169-4" tabindex="-1"></a><span class="co">#&gt; 1 60000 18.45  8.73  837.46</span></span>
<span id="cb169-5"><a href="線形回帰分析.html#cb169-5" tabindex="-1"></a><span class="co">#&gt; 2 61000 19.84 13.33  520.86</span></span>
<span id="cb169-6"><a href="線形回帰分析.html#cb169-6" tabindex="-1"></a><span class="co">#&gt; 3 74000 22.45  8.26  433.77</span></span>
<span id="cb169-7"><a href="線形回帰分析.html#cb169-7" tabindex="-1"></a><span class="co">#&gt; 4 77000 26.81  5.94 1192.32</span></span>
<span id="cb169-8"><a href="線形回帰分析.html#cb169-8" tabindex="-1"></a><span class="co">#&gt; 5 59000 17.62  3.85  815.17</span></span>
<span id="cb169-9"><a href="線形回帰分析.html#cb169-9" tabindex="-1"></a><span class="co">#&gt; 6 86000 26.68  4.19  373.87</span></span>
<span id="cb169-10"><a href="線形回帰分析.html#cb169-10" tabindex="-1"></a><span class="fu">pairs</span>(rentdat)</span></code></pre></div>
<p><img src="040-linreg_files/figure-html/reg1-1-1.png" width="75%" /></p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="線形回帰分析.html#cb170-1" tabindex="-1"></a><span class="fu">cor</span>(rentdat)</span>
<span id="cb170-2"><a href="線形回帰分析.html#cb170-2" tabindex="-1"></a><span class="co">#&gt;            rent        area         yrs        dist</span></span>
<span id="cb170-3"><a href="線形回帰分析.html#cb170-3" tabindex="-1"></a><span class="co">#&gt; rent  1.0000000  0.84098526 -0.16885266 -0.36727009</span></span>
<span id="cb170-4"><a href="線形回帰分析.html#cb170-4" tabindex="-1"></a><span class="co">#&gt; area  0.8409853  1.00000000  0.05454398 -0.02291733</span></span>
<span id="cb170-5"><a href="線形回帰分析.html#cb170-5" tabindex="-1"></a><span class="co">#&gt; yrs  -0.1688527  0.05454398  1.00000000 -0.05812975</span></span>
<span id="cb170-6"><a href="線形回帰分析.html#cb170-6" tabindex="-1"></a><span class="co">#&gt; dist -0.3672701 -0.02291733 -0.05812975  1.00000000</span></span>
<span id="cb170-7"><a href="線形回帰分析.html#cb170-7" tabindex="-1"></a></span>
<span id="cb170-8"><a href="線形回帰分析.html#cb170-8" tabindex="-1"></a>res_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(rent <span class="sc">~</span> ., <span class="at">data =</span> rentdat)</span>
<span id="cb170-9"><a href="線形回帰分析.html#cb170-9" tabindex="-1"></a><span class="fu">summary</span>(res_lm)</span>
<span id="cb170-10"><a href="線形回帰分析.html#cb170-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb170-11"><a href="線形回帰分析.html#cb170-11" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb170-12"><a href="線形回帰分析.html#cb170-12" tabindex="-1"></a><span class="co">#&gt; lm(formula = rent ~ ., data = rentdat)</span></span>
<span id="cb170-13"><a href="線形回帰分析.html#cb170-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb170-14"><a href="線形回帰分析.html#cb170-14" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb170-15"><a href="線形回帰分析.html#cb170-15" tabindex="-1"></a><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span id="cb170-16"><a href="線形回帰分析.html#cb170-16" tabindex="-1"></a><span class="co">#&gt;  -6732  -2379  -1016   2286   7256 </span></span>
<span id="cb170-17"><a href="線形回帰分析.html#cb170-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb170-18"><a href="線形回帰分析.html#cb170-18" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb170-19"><a href="線形回帰分析.html#cb170-19" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb170-20"><a href="線形回帰分析.html#cb170-20" tabindex="-1"></a><span class="co">#&gt; (Intercept) 32261.469   3652.405   8.833 1.81e-11 ***</span></span>
<span id="cb170-21"><a href="線形回帰分析.html#cb170-21" tabindex="-1"></a><span class="co">#&gt; area         2397.144    142.744  16.793  &lt; 2e-16 ***</span></span>
<span id="cb170-22"><a href="線形回帰分析.html#cb170-22" tabindex="-1"></a><span class="co">#&gt; yrs          -745.440    159.275  -4.680 2.55e-05 ***</span></span>
<span id="cb170-23"><a href="線形回帰分析.html#cb170-23" tabindex="-1"></a><span class="co">#&gt; dist          -12.443      1.733  -7.180 4.89e-09 ***</span></span>
<span id="cb170-24"><a href="線形回帰分析.html#cb170-24" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb170-25"><a href="線形回帰分析.html#cb170-25" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb170-26"><a href="線形回帰分析.html#cb170-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb170-27"><a href="線形回帰分析.html#cb170-27" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 3531 on 46 degrees of freedom</span></span>
<span id="cb170-28"><a href="線形回帰分析.html#cb170-28" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.8838, Adjusted R-squared:  0.8762 </span></span>
<span id="cb170-29"><a href="線形回帰分析.html#cb170-29" tabindex="-1"></a><span class="co">#&gt; F-statistic: 116.6 on 3 and 46 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<ul>
<li>モデル診断</li>
</ul>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="線形回帰分析.html#cb171-1" tabindex="-1"></a><span class="fu">plot</span>(res_lm<span class="sc">$</span>fitted.values, rentdat<span class="sc">$</span>rent)  <span class="co"># モデル診断: y観測値 vs y適合値</span></span>
<span id="cb171-2"><a href="線形回帰分析.html#cb171-2" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="040-linreg_files/figure-html/reg1-2-1.png" width="75%" /></p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="線形回帰分析.html#cb172-1" tabindex="-1"></a><span class="fu">plot</span>(res_lm<span class="sc">$</span>fitted.values, res_lm<span class="sc">$</span>residuals)  <span class="co"># モデル診断: y適合値 vs 残差</span></span>
<span id="cb172-2"><a href="線形回帰分析.html#cb172-2" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="040-linreg_files/figure-html/reg1-2-2.png" width="75%" /></p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="線形回帰分析.html#cb173-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb173-2"><a href="線形回帰分析.html#cb173-2" tabindex="-1"></a><span class="fu">plot</span>(res_lm)</span></code></pre></div>
<p><img src="040-linreg_files/figure-html/reg1-2-3.png" width="75%" /></p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="線形回帰分析.html#cb174-1" tabindex="-1"></a><span class="co"># → resid(res_lm)</span></span></code></pre></div>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="線形回帰分析.html#cb175-1" tabindex="-1"></a><span class="co"># # 標準(化)回帰係数、p.211 srentdat &lt;- scale(rentdat)\t\t#</span></span>
<span id="cb175-2"><a href="線形回帰分析.html#cb175-2" tabindex="-1"></a><span class="co"># scale()の返り値はリスト型 → データフレームへ変換 srentdat &lt;-</span></span>
<span id="cb175-3"><a href="線形回帰分析.html#cb175-3" tabindex="-1"></a><span class="co"># data.frame(srentdat) # sres_lm &lt;- lm(rent ~ area + yrs + dist, data =</span></span>
<span id="cb175-4"><a href="線形回帰分析.html#cb175-4" tabindex="-1"></a><span class="co"># srentdat) summary(sres_lm)</span></span>
<span id="cb175-5"><a href="線形回帰分析.html#cb175-5" tabindex="-1"></a></span>
<span id="cb175-6"><a href="線形回帰分析.html#cb175-6" tabindex="-1"></a><span class="co"># # 偏回帰係数 vs 標準(化)偏回帰係数 summary(res_lm)[&#39;coefficients&#39;]</span></span>
<span id="cb175-7"><a href="線形回帰分析.html#cb175-7" tabindex="-1"></a><span class="co"># summary(sres_lm)[&#39;coefficients&#39;] # # 確認 attach(rentdat) y_sd &lt;- sd(rent)</span></span>
<span id="cb175-8"><a href="線形回帰分析.html#cb175-8" tabindex="-1"></a><span class="co"># x_sd &lt;- apply(rentdat[, -1], 2, sd) res_lm$coef[ -1] * x_sd / y_sd</span></span></code></pre></div>
<ul>
<li>モデルを使った予測
<ul>
<li>専有面積=18.8平米, 築後年数=13年, 駅距離=800m, または100mの物件の賃料は?</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="線形回帰分析.html#cb176-1" tabindex="-1"></a>new <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">area =</span> <span class="fl">18.8</span>, <span class="at">dist =</span> <span class="fu">c</span>(<span class="dv">800</span>, <span class="dv">100</span>), <span class="at">yrs =</span> <span class="dv">13</span>)</span>
<span id="cb176-2"><a href="線形回帰分析.html#cb176-2" tabindex="-1"></a><span class="fu">predict</span>(res_lm, <span class="at">newdata =</span> new)</span>
<span id="cb176-3"><a href="線形回帰分析.html#cb176-3" tabindex="-1"></a><span class="co">#&gt;        1        2 </span></span>
<span id="cb176-4"><a href="線形回帰分析.html#cb176-4" tabindex="-1"></a><span class="co">#&gt; 57682.32 66392.71</span></span>
<span id="cb176-5"><a href="線形回帰分析.html#cb176-5" tabindex="-1"></a><span class="co"># predict.lm(res_lm, newdata = new) res_lm$residuals\t\t# resid(res_lm)</span></span></code></pre></div>
</div>
</div>
<div id="変数の選択" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> 変数の選択<a href="線形回帰分析.html#変数の選択" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="データ2-ボストン市内住宅物件価格データ" class="section level3 unnumbered hasAnchor">
<h3>データ2: ボストン市内住宅物件価格データ<a href="線形回帰分析.html#データ2-ボストン市内住宅物件価格データ" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>- Boston Housingデータ
  - crim: 町ごとの一人当たり犯罪率
  - zn: 25,000平方フィート以上の住宅用地の割合
  - indus: 町ごとの非小売業の土地の割合
  - chas: チャールズ川のダミー変数 (川に接している場合は1, さもなくば0)
  - nox: 窒素酸化物濃度（1000万ppm）
  - rm: 1住居当たりの平均部屋数
  - age: 1940年以前に建設された住戸の持ち家比率
  - dis: ボストンの5つの雇用センターまでの距離の加重平均
  - rad: 放射状高速道路へのアクセス指数
  - tax: 10,000米ドル当たりの固定資産税率
  -  ptratio: 町ごとの生徒数・教師数比率
  - b: 1000(B - 0.63)^2 (Bは町ごとの黒人の割合)
  - lstat: 低所得者層の割合
  - medv: 持ち家住宅の中央値（1000ドル単位）
- 506件 x 14変数 (オリジナル版)
- source: http://lib.stat.cmu.edu/datasets/boston</code></pre>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="線形回帰分析.html#cb178-1" tabindex="-1"></a>housing <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;boston_housing.csv&quot;</span>, <span class="at">header =</span> T)</span></code></pre></div>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="線形回帰分析.html#cb179-1" tabindex="-1"></a><span class="co"># 散布図行列</span></span>
<span id="cb179-2"><a href="線形回帰分析.html#cb179-2" tabindex="-1"></a><span class="fu">pairs</span>(housing[, <span class="sc">-</span><span class="dv">4</span>])  <span class="co"># chas(バイナリ)を除去</span></span></code></pre></div>
<p><img src="040-linreg_files/figure-html/reg2-2-1.png" width="75%" /></p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="線形回帰分析.html#cb180-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cor</span>(housing[, <span class="fu">c</span>(<span class="st">&quot;crim&quot;</span>, <span class="st">&quot;rm&quot;</span>, <span class="st">&quot;tax&quot;</span>, <span class="st">&quot;lstat&quot;</span>)]), <span class="dv">2</span>)  <span class="co"># chas(バイナリ)を除去</span></span>
<span id="cb180-2"><a href="線形回帰分析.html#cb180-2" tabindex="-1"></a><span class="co">#&gt;        crim    rm   tax lstat</span></span>
<span id="cb180-3"><a href="線形回帰分析.html#cb180-3" tabindex="-1"></a><span class="co">#&gt; crim   1.00 -0.22  0.58  0.46</span></span>
<span id="cb180-4"><a href="線形回帰分析.html#cb180-4" tabindex="-1"></a><span class="co">#&gt; rm    -0.22  1.00 -0.29 -0.61</span></span>
<span id="cb180-5"><a href="線形回帰分析.html#cb180-5" tabindex="-1"></a><span class="co">#&gt; tax    0.58 -0.29  1.00  0.54</span></span>
<span id="cb180-6"><a href="線形回帰分析.html#cb180-6" tabindex="-1"></a><span class="co">#&gt; lstat  0.46 -0.61  0.54  1.00</span></span>
<span id="cb180-7"><a href="線形回帰分析.html#cb180-7" tabindex="-1"></a></span>
<span id="cb180-8"><a href="線形回帰分析.html#cb180-8" tabindex="-1"></a><span class="co"># install.packages(dplyr)</span></span>
<span id="cb180-9"><a href="線形回帰分析.html#cb180-9" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb180-10"><a href="線形回帰分析.html#cb180-10" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb180-11"><a href="線形回帰分析.html#cb180-11" tabindex="-1"></a><span class="fu">corrplot</span>(<span class="fu">cor</span>(<span class="fu">select</span>(housing, <span class="sc">-</span>chas)))  <span class="co"># corrplot, dplyr</span></span></code></pre></div>
<p><img src="040-linreg_files/figure-html/reg2-2-2.png" width="75%" /></p>
<ul>
<li>4変数に絞り込み</li>
</ul>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="線形回帰分析.html#cb181-1" tabindex="-1"></a>res_lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> crim <span class="sc">+</span> rm <span class="sc">+</span> tax <span class="sc">+</span> lstat, <span class="at">data =</span> housing)</span>
<span id="cb181-2"><a href="線形回帰分析.html#cb181-2" tabindex="-1"></a><span class="fu">summary</span>(res_lm1)</span>
<span id="cb181-3"><a href="線形回帰分析.html#cb181-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb181-4"><a href="線形回帰分析.html#cb181-4" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb181-5"><a href="線形回帰分析.html#cb181-5" tabindex="-1"></a><span class="co">#&gt; lm(formula = medv ~ crim + rm + tax + lstat, data = housing)</span></span>
<span id="cb181-6"><a href="線形回帰分析.html#cb181-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb181-7"><a href="線形回帰分析.html#cb181-7" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb181-8"><a href="線形回帰分析.html#cb181-8" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb181-9"><a href="線形回帰分析.html#cb181-9" tabindex="-1"></a><span class="co">#&gt; -16.383  -3.497  -1.149   1.825  30.716 </span></span>
<span id="cb181-10"><a href="線形回帰分析.html#cb181-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb181-11"><a href="線形回帰分析.html#cb181-11" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb181-12"><a href="線形回帰分析.html#cb181-12" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb181-13"><a href="線形回帰分析.html#cb181-13" tabindex="-1"></a><span class="co">#&gt; (Intercept) -1.414928   3.178364  -0.445   0.6564    </span></span>
<span id="cb181-14"><a href="線形回帰分析.html#cb181-14" tabindex="-1"></a><span class="co">#&gt; crim        -0.061579   0.035562  -1.732   0.0840 .  </span></span>
<span id="cb181-15"><a href="線形回帰分析.html#cb181-15" tabindex="-1"></a><span class="co">#&gt; rm           5.248721   0.439664  11.938   &lt;2e-16 ***</span></span>
<span id="cb181-16"><a href="線形回帰分析.html#cb181-16" tabindex="-1"></a><span class="co">#&gt; tax         -0.005018   0.001922  -2.611   0.0093 ** </span></span>
<span id="cb181-17"><a href="線形回帰分析.html#cb181-17" tabindex="-1"></a><span class="co">#&gt; lstat       -0.534835   0.050258 -10.642   &lt;2e-16 ***</span></span>
<span id="cb181-18"><a href="線形回帰分析.html#cb181-18" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb181-19"><a href="線形回帰分析.html#cb181-19" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb181-20"><a href="線形回帰分析.html#cb181-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb181-21"><a href="線形回帰分析.html#cb181-21" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 5.458 on 501 degrees of freedom</span></span>
<span id="cb181-22"><a href="線形回帰分析.html#cb181-22" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.6506, Adjusted R-squared:  0.6478 </span></span>
<span id="cb181-23"><a href="線形回帰分析.html#cb181-23" tabindex="-1"></a><span class="co">#&gt; F-statistic: 233.2 on 4 and 501 DF,  p-value: &lt; 2.2e-16</span></span>
<span id="cb181-24"><a href="線形回帰分析.html#cb181-24" tabindex="-1"></a><span class="fu">anova</span>(res_lm1)</span>
<span id="cb181-25"><a href="線形回帰分析.html#cb181-25" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb181-26"><a href="線形回帰分析.html#cb181-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb181-27"><a href="線形回帰分析.html#cb181-27" tabindex="-1"></a><span class="co">#&gt; Response: medv</span></span>
<span id="cb181-28"><a href="線形回帰分析.html#cb181-28" tabindex="-1"></a><span class="co">#&gt;            Df  Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span id="cb181-29"><a href="線形回帰分析.html#cb181-29" tabindex="-1"></a><span class="co">#&gt; crim        1  6440.8  6440.8 216.206 &lt; 2.2e-16 ***</span></span>
<span id="cb181-30"><a href="線形回帰分析.html#cb181-30" tabindex="-1"></a><span class="co">#&gt; rm          1 16709.7 16709.7 560.915 &lt; 2.2e-16 ***</span></span>
<span id="cb181-31"><a href="線形回帰分析.html#cb181-31" tabindex="-1"></a><span class="co">#&gt; tax         1  1267.3  1267.3  42.542 1.693e-10 ***</span></span>
<span id="cb181-32"><a href="線形回帰分析.html#cb181-32" tabindex="-1"></a><span class="co">#&gt; lstat       1  3373.6  3373.6 113.247 &lt; 2.2e-16 ***</span></span>
<span id="cb181-33"><a href="線形回帰分析.html#cb181-33" tabindex="-1"></a><span class="co">#&gt; Residuals 501 14924.8    29.8                      </span></span>
<span id="cb181-34"><a href="線形回帰分析.html#cb181-34" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb181-35"><a href="線形回帰分析.html#cb181-35" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb181-36"><a href="線形回帰分析.html#cb181-36" tabindex="-1"></a></span>
<span id="cb181-37"><a href="線形回帰分析.html#cb181-37" tabindex="-1"></a><span class="co"># update関数でモデル更新: 変数ptratio追加</span></span>
<span id="cb181-38"><a href="線形回帰分析.html#cb181-38" tabindex="-1"></a>res_lm2 <span class="ot">&lt;-</span> <span class="fu">update</span>(res_lm1, . <span class="sc">~</span> . <span class="sc">+</span> ptratio)</span>
<span id="cb181-39"><a href="線形回帰分析.html#cb181-39" tabindex="-1"></a><span class="fu">summary</span>(res_lm2)</span>
<span id="cb181-40"><a href="線形回帰分析.html#cb181-40" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb181-41"><a href="線形回帰分析.html#cb181-41" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb181-42"><a href="線形回帰分析.html#cb181-42" tabindex="-1"></a><span class="co">#&gt; lm(formula = medv ~ crim + rm + tax + lstat + ptratio, data = housing)</span></span>
<span id="cb181-43"><a href="線形回帰分析.html#cb181-43" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb181-44"><a href="線形回帰分析.html#cb181-44" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb181-45"><a href="線形回帰分析.html#cb181-45" tabindex="-1"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb181-46"><a href="線形回帰分析.html#cb181-46" tabindex="-1"></a><span class="co">#&gt; -14.3602  -3.1111  -0.9237   1.6569  30.4116 </span></span>
<span id="cb181-47"><a href="線形回帰分析.html#cb181-47" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb181-48"><a href="線形回帰分析.html#cb181-48" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb181-49"><a href="線形回帰分析.html#cb181-49" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb181-50"><a href="線形回帰分析.html#cb181-50" tabindex="-1"></a><span class="co">#&gt; (Intercept) 16.7488084  4.0001180   4.187 3.34e-05 ***</span></span>
<span id="cb181-51"><a href="線形回帰分析.html#cb181-51" tabindex="-1"></a><span class="co">#&gt; crim        -0.0593795  0.0339830  -1.747   0.0812 .  </span></span>
<span id="cb181-52"><a href="線形回帰分析.html#cb181-52" tabindex="-1"></a><span class="co">#&gt; rm           4.6349234  0.4292367  10.798  &lt; 2e-16 ***</span></span>
<span id="cb181-53"><a href="線形回帰分析.html#cb181-53" tabindex="-1"></a><span class="co">#&gt; tax         -0.0008196  0.0019328  -0.424   0.6717    </span></span>
<span id="cb181-54"><a href="線形回帰分析.html#cb181-54" tabindex="-1"></a><span class="co">#&gt; lstat       -0.5280046  0.0480346 -10.992  &lt; 2e-16 ***</span></span>
<span id="cb181-55"><a href="線形回帰分析.html#cb181-55" tabindex="-1"></a><span class="co">#&gt; ptratio     -0.8731668  0.1251429  -6.977 9.59e-12 ***</span></span>
<span id="cb181-56"><a href="線形回帰分析.html#cb181-56" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb181-57"><a href="線形回帰分析.html#cb181-57" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb181-58"><a href="線形回帰分析.html#cb181-58" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb181-59"><a href="線形回帰分析.html#cb181-59" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 5.215 on 500 degrees of freedom</span></span>
<span id="cb181-60"><a href="線形回帰分析.html#cb181-60" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.6816, Adjusted R-squared:  0.6784 </span></span>
<span id="cb181-61"><a href="線形回帰分析.html#cb181-61" tabindex="-1"></a><span class="co">#&gt; F-statistic: 214.1 on 5 and 500 DF,  p-value: &lt; 2.2e-16</span></span>
<span id="cb181-62"><a href="線形回帰分析.html#cb181-62" tabindex="-1"></a><span class="fu">anova</span>(res_lm2)</span>
<span id="cb181-63"><a href="線形回帰分析.html#cb181-63" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb181-64"><a href="線形回帰分析.html#cb181-64" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb181-65"><a href="線形回帰分析.html#cb181-65" tabindex="-1"></a><span class="co">#&gt; Response: medv</span></span>
<span id="cb181-66"><a href="線形回帰分析.html#cb181-66" tabindex="-1"></a><span class="co">#&gt;            Df  Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span id="cb181-67"><a href="線形回帰分析.html#cb181-67" tabindex="-1"></a><span class="co">#&gt; crim        1  6440.8  6440.8 236.784 &lt; 2.2e-16 ***</span></span>
<span id="cb181-68"><a href="線形回帰分析.html#cb181-68" tabindex="-1"></a><span class="co">#&gt; rm          1 16709.7 16709.7 614.301 &lt; 2.2e-16 ***</span></span>
<span id="cb181-69"><a href="線形回帰分析.html#cb181-69" tabindex="-1"></a><span class="co">#&gt; tax         1  1267.3  1267.3  46.591 2.540e-11 ***</span></span>
<span id="cb181-70"><a href="線形回帰分析.html#cb181-70" tabindex="-1"></a><span class="co">#&gt; lstat       1  3373.6  3373.6 124.026 &lt; 2.2e-16 ***</span></span>
<span id="cb181-71"><a href="線形回帰分析.html#cb181-71" tabindex="-1"></a><span class="co">#&gt; ptratio     1  1324.2  1324.2  48.684 9.589e-12 ***</span></span>
<span id="cb181-72"><a href="線形回帰分析.html#cb181-72" tabindex="-1"></a><span class="co">#&gt; Residuals 500 13600.6    27.2                      </span></span>
<span id="cb181-73"><a href="線形回帰分析.html#cb181-73" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb181-74"><a href="線形回帰分析.html#cb181-74" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb181-75"><a href="線形回帰分析.html#cb181-75" tabindex="-1"></a></span>
<span id="cb181-76"><a href="線形回帰分析.html#cb181-76" tabindex="-1"></a><span class="co"># 変数zn追加</span></span>
<span id="cb181-77"><a href="線形回帰分析.html#cb181-77" tabindex="-1"></a>res_lm3 <span class="ot">&lt;-</span> <span class="fu">update</span>(res_lm2, . <span class="sc">~</span> . <span class="sc">+</span> zn)</span>
<span id="cb181-78"><a href="線形回帰分析.html#cb181-78" tabindex="-1"></a><span class="fu">summary</span>(res_lm3)</span>
<span id="cb181-79"><a href="線形回帰分析.html#cb181-79" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb181-80"><a href="線形回帰分析.html#cb181-80" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb181-81"><a href="線形回帰分析.html#cb181-81" tabindex="-1"></a><span class="co">#&gt; lm(formula = medv ~ crim + rm + tax + lstat + ptratio + zn, data = housing)</span></span>
<span id="cb181-82"><a href="線形回帰分析.html#cb181-82" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb181-83"><a href="線形回帰分析.html#cb181-83" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb181-84"><a href="線形回帰分析.html#cb181-84" tabindex="-1"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb181-85"><a href="線形回帰分析.html#cb181-85" tabindex="-1"></a><span class="co">#&gt; -14.4790  -3.1374  -0.8754   1.6871  30.3185 </span></span>
<span id="cb181-86"><a href="線形回帰分析.html#cb181-86" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb181-87"><a href="線形回帰分析.html#cb181-87" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb181-88"><a href="線形回帰分析.html#cb181-88" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb181-89"><a href="線形回帰分析.html#cb181-89" tabindex="-1"></a><span class="co">#&gt; (Intercept) 17.3073953  4.0780517   4.244 2.62e-05 ***</span></span>
<span id="cb181-90"><a href="線形回帰分析.html#cb181-90" tabindex="-1"></a><span class="co">#&gt; crim        -0.0584021  0.0340274  -1.716   0.0867 .  </span></span>
<span id="cb181-91"><a href="線形回帰分析.html#cb181-91" tabindex="-1"></a><span class="co">#&gt; rm           4.6460026  0.4297290  10.811  &lt; 2e-16 ***</span></span>
<span id="cb181-92"><a href="線形回帰分析.html#cb181-92" tabindex="-1"></a><span class="co">#&gt; tax         -0.0008832  0.0019358  -0.456   0.6484    </span></span>
<span id="cb181-93"><a href="線形回帰分析.html#cb181-93" tabindex="-1"></a><span class="co">#&gt; lstat       -0.5354553  0.0491813 -10.887  &lt; 2e-16 ***</span></span>
<span id="cb181-94"><a href="線形回帰分析.html#cb181-94" tabindex="-1"></a><span class="co">#&gt; ptratio     -0.8958719  0.1291910  -6.934 1.27e-11 ***</span></span>
<span id="cb181-95"><a href="線形回帰分析.html#cb181-95" tabindex="-1"></a><span class="co">#&gt; zn          -0.0081367  0.0114124  -0.713   0.4762    </span></span>
<span id="cb181-96"><a href="線形回帰分析.html#cb181-96" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb181-97"><a href="線形回帰分析.html#cb181-97" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb181-98"><a href="線形回帰分析.html#cb181-98" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb181-99"><a href="線形回帰分析.html#cb181-99" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 5.218 on 499 degrees of freedom</span></span>
<span id="cb181-100"><a href="線形回帰分析.html#cb181-100" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.6819, Adjusted R-squared:  0.6781 </span></span>
<span id="cb181-101"><a href="線形回帰分析.html#cb181-101" tabindex="-1"></a><span class="co">#&gt; F-statistic: 178.3 on 6 and 499 DF,  p-value: &lt; 2.2e-16</span></span>
<span id="cb181-102"><a href="線形回帰分析.html#cb181-102" tabindex="-1"></a></span>
<span id="cb181-103"><a href="線形回帰分析.html#cb181-103" tabindex="-1"></a><span class="fu">anova</span>(res_lm, res_lm3)</span>
<span id="cb181-104"><a href="線形回帰分析.html#cb181-104" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb181-105"><a href="線形回帰分析.html#cb181-105" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb181-106"><a href="線形回帰分析.html#cb181-106" tabindex="-1"></a><span class="co">#&gt; Response: rent</span></span>
<span id="cb181-107"><a href="線形回帰分析.html#cb181-107" tabindex="-1"></a><span class="co">#&gt;           Df     Sum Sq    Mean Sq F value    Pr(&gt;F)    </span></span>
<span id="cb181-108"><a href="線形回帰分析.html#cb181-108" tabindex="-1"></a><span class="co">#&gt; area       1 3490224482 3490224482 279.906 &lt; 2.2e-16 ***</span></span>
<span id="cb181-109"><a href="線形回帰分析.html#cb181-109" tabindex="-1"></a><span class="co">#&gt; yrs        1  228207060  228207060  18.302 9.440e-05 ***</span></span>
<span id="cb181-110"><a href="線形回帰分析.html#cb181-110" tabindex="-1"></a><span class="co">#&gt; dist       1  642861374  642861374  51.556 4.893e-09 ***</span></span>
<span id="cb181-111"><a href="線形回帰分析.html#cb181-111" tabindex="-1"></a><span class="co">#&gt; Residuals 46  573587084   12469284                      </span></span>
<span id="cb181-112"><a href="線形回帰分析.html#cb181-112" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb181-113"><a href="線形回帰分析.html#cb181-113" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb181-114"><a href="線形回帰分析.html#cb181-114" tabindex="-1"></a></span>
<span id="cb181-115"><a href="線形回帰分析.html#cb181-115" tabindex="-1"></a><span class="co"># 変数nox追加, zn除去</span></span>
<span id="cb181-116"><a href="線形回帰分析.html#cb181-116" tabindex="-1"></a>res_lm4 <span class="ot">&lt;-</span> <span class="fu">update</span>(res_lm3, . <span class="sc">~</span> . <span class="sc">+</span> nox <span class="sc">-</span> zn)</span>
<span id="cb181-117"><a href="線形回帰分析.html#cb181-117" tabindex="-1"></a><span class="fu">summary</span>(res_lm4)</span>
<span id="cb181-118"><a href="線形回帰分析.html#cb181-118" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb181-119"><a href="線形回帰分析.html#cb181-119" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb181-120"><a href="線形回帰分析.html#cb181-120" tabindex="-1"></a><span class="co">#&gt; lm(formula = medv ~ crim + rm + tax + lstat + ptratio + nox, </span></span>
<span id="cb181-121"><a href="線形回帰分析.html#cb181-121" tabindex="-1"></a><span class="co">#&gt;     data = housing)</span></span>
<span id="cb181-122"><a href="線形回帰分析.html#cb181-122" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb181-123"><a href="線形回帰分析.html#cb181-123" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb181-124"><a href="線形回帰分析.html#cb181-124" tabindex="-1"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb181-125"><a href="線形回帰分析.html#cb181-125" tabindex="-1"></a><span class="co">#&gt; -14.2389  -3.1372  -0.9454   1.6680  30.4687 </span></span>
<span id="cb181-126"><a href="線形回帰分析.html#cb181-126" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb181-127"><a href="線形回帰分析.html#cb181-127" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb181-128"><a href="線形回帰分析.html#cb181-128" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb181-129"><a href="線形回帰分析.html#cb181-129" tabindex="-1"></a><span class="co">#&gt; (Intercept) 17.2649269  4.2731659   4.040 6.18e-05 ***</span></span>
<span id="cb181-130"><a href="線形回帰分析.html#cb181-130" tabindex="-1"></a><span class="co">#&gt; crim        -0.0596990  0.0340256  -1.755    0.080 .  </span></span>
<span id="cb181-131"><a href="線形回帰分析.html#cb181-131" tabindex="-1"></a><span class="co">#&gt; rm           4.6382386  0.4297223  10.794  &lt; 2e-16 ***</span></span>
<span id="cb181-132"><a href="線形回帰分析.html#cb181-132" tabindex="-1"></a><span class="co">#&gt; tax         -0.0004089  0.0022705  -0.180    0.857    </span></span>
<span id="cb181-133"><a href="線形回帰分析.html#cb181-133" tabindex="-1"></a><span class="co">#&gt; lstat       -0.5216846  0.0514382 -10.142  &lt; 2e-16 ***</span></span>
<span id="cb181-134"><a href="線形回帰分析.html#cb181-134" tabindex="-1"></a><span class="co">#&gt; ptratio     -0.8844707  0.1294545  -6.832 2.44e-11 ***</span></span>
<span id="cb181-135"><a href="線形回帰分析.html#cb181-135" tabindex="-1"></a><span class="co">#&gt; nox         -1.0363053  2.9989281  -0.346    0.730    </span></span>
<span id="cb181-136"><a href="線形回帰分析.html#cb181-136" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb181-137"><a href="線形回帰分析.html#cb181-137" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb181-138"><a href="線形回帰分析.html#cb181-138" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb181-139"><a href="線形回帰分析.html#cb181-139" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 5.22 on 499 degrees of freedom</span></span>
<span id="cb181-140"><a href="線形回帰分析.html#cb181-140" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.6817, Adjusted R-squared:  0.6779 </span></span>
<span id="cb181-141"><a href="線形回帰分析.html#cb181-141" tabindex="-1"></a><span class="co">#&gt; F-statistic: 178.1 on 6 and 499 DF,  p-value: &lt; 2.2e-16</span></span>
<span id="cb181-142"><a href="線形回帰分析.html#cb181-142" tabindex="-1"></a></span>
<span id="cb181-143"><a href="線形回帰分析.html#cb181-143" tabindex="-1"></a><span class="co"># 変数lstatの逆数を新変数invlstatとして定義し, モデルに追加</span></span>
<span id="cb181-144"><a href="線形回帰分析.html#cb181-144" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(housing, <span class="at">invlstat =</span> <span class="dv">1</span><span class="sc">/</span>housing<span class="sc">$</span>lstat)</span>
<span id="cb181-145"><a href="線形回帰分析.html#cb181-145" tabindex="-1"></a>res_lm5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> crim <span class="sc">+</span> rm <span class="sc">+</span> tax <span class="sc">+</span> ptratio <span class="sc">+</span> invlstat, <span class="at">data =</span> data2)</span>
<span id="cb181-146"><a href="線形回帰分析.html#cb181-146" tabindex="-1"></a><span class="fu">plot</span>(housing<span class="sc">$</span>medv, <span class="dv">1</span><span class="sc">/</span>housing<span class="sc">$</span>lstat)</span></code></pre></div>
<p><img src="040-linreg_files/figure-html/reg2-3-1.png" width="75%" /></p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="線形回帰分析.html#cb182-1" tabindex="-1"></a><span class="fu">summary</span>(res_lm5)</span>
<span id="cb182-2"><a href="線形回帰分析.html#cb182-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb182-3"><a href="線形回帰分析.html#cb182-3" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb182-4"><a href="線形回帰分析.html#cb182-4" tabindex="-1"></a><span class="co">#&gt; lm(formula = medv ~ crim + rm + tax + ptratio + invlstat, data = data2)</span></span>
<span id="cb182-5"><a href="線形回帰分析.html#cb182-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb182-6"><a href="線形回帰分析.html#cb182-6" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb182-7"><a href="線形回帰分析.html#cb182-7" tabindex="-1"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb182-8"><a href="線形回帰分析.html#cb182-8" tabindex="-1"></a><span class="co">#&gt; -14.9062  -2.6032  -0.5276   2.1041  31.2592 </span></span>
<span id="cb182-9"><a href="線形回帰分析.html#cb182-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb182-10"><a href="線形回帰分析.html#cb182-10" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb182-11"><a href="線形回帰分析.html#cb182-11" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb182-12"><a href="線形回帰分析.html#cb182-12" tabindex="-1"></a><span class="co">#&gt; (Intercept)  6.665018   3.295520   2.022   0.0437 *  </span></span>
<span id="cb182-13"><a href="線形回帰分析.html#cb182-13" tabindex="-1"></a><span class="co">#&gt; crim        -0.119564   0.030121  -3.969 8.26e-05 ***</span></span>
<span id="cb182-14"><a href="線形回帰分析.html#cb182-14" tabindex="-1"></a><span class="co">#&gt; rm           3.609393   0.394880   9.140  &lt; 2e-16 ***</span></span>
<span id="cb182-15"><a href="線形回帰分析.html#cb182-15" tabindex="-1"></a><span class="co">#&gt; tax         -0.002272   0.001693  -1.342   0.1802    </span></span>
<span id="cb182-16"><a href="線形回帰分析.html#cb182-16" tabindex="-1"></a><span class="co">#&gt; ptratio     -0.665188   0.114156  -5.827 1.01e-08 ***</span></span>
<span id="cb182-17"><a href="線形回帰分析.html#cb182-17" tabindex="-1"></a><span class="co">#&gt; invlstat    60.465938   3.762069  16.073  &lt; 2e-16 ***</span></span>
<span id="cb182-18"><a href="線形回帰分析.html#cb182-18" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb182-19"><a href="線形回帰分析.html#cb182-19" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb182-20"><a href="線形回帰分析.html#cb182-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb182-21"><a href="線形回帰分析.html#cb182-21" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 4.719 on 500 degrees of freedom</span></span>
<span id="cb182-22"><a href="線形回帰分析.html#cb182-22" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.7393, Adjusted R-squared:  0.7367 </span></span>
<span id="cb182-23"><a href="線形回帰分析.html#cb182-23" tabindex="-1"></a><span class="co">#&gt; F-statistic: 283.6 on 5 and 500 DF,  p-value: &lt; 2.2e-16</span></span>
<span id="cb182-24"><a href="線形回帰分析.html#cb182-24" tabindex="-1"></a></span>
<span id="cb182-25"><a href="線形回帰分析.html#cb182-25" tabindex="-1"></a><span class="co"># AIC, BICの計算</span></span>
<span id="cb182-26"><a href="線形回帰分析.html#cb182-26" tabindex="-1"></a><span class="fu">AIC</span>(res_lm5, res_lm2)</span>
<span id="cb182-27"><a href="線形回帰分析.html#cb182-27" tabindex="-1"></a><span class="co">#&gt;         df      AIC</span></span>
<span id="cb182-28"><a href="線形回帰分析.html#cb182-28" tabindex="-1"></a><span class="co">#&gt; res_lm5  7 3014.149</span></span>
<span id="cb182-29"><a href="線形回帰分析.html#cb182-29" tabindex="-1"></a><span class="co">#&gt; res_lm2  7 3115.379</span></span>
<span id="cb182-30"><a href="線形回帰分析.html#cb182-30" tabindex="-1"></a><span class="fu">BIC</span>(res_lm5, res_lm2)</span>
<span id="cb182-31"><a href="線形回帰分析.html#cb182-31" tabindex="-1"></a><span class="co">#&gt;         df      BIC</span></span>
<span id="cb182-32"><a href="線形回帰分析.html#cb182-32" tabindex="-1"></a><span class="co">#&gt; res_lm5  7 3043.735</span></span>
<span id="cb182-33"><a href="線形回帰分析.html#cb182-33" tabindex="-1"></a><span class="co">#&gt; res_lm2  7 3144.965</span></span>
<span id="cb182-34"><a href="線形回帰分析.html#cb182-34" tabindex="-1"></a></span>
<span id="cb182-35"><a href="線形回帰分析.html#cb182-35" tabindex="-1"></a><span class="co"># 追加 (除去) した変数群の有意性 (例)</span></span>
<span id="cb182-36"><a href="線形回帰分析.html#cb182-36" tabindex="-1"></a><span class="fu">anova</span>(res_lm1, res_lm3, <span class="at">test =</span> <span class="st">&quot;F&quot;</span>)  <span class="co"># F検定</span></span>
<span id="cb182-37"><a href="線形回帰分析.html#cb182-37" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb182-38"><a href="線形回帰分析.html#cb182-38" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb182-39"><a href="線形回帰分析.html#cb182-39" tabindex="-1"></a><span class="co">#&gt; Model 1: medv ~ crim + rm + tax + lstat</span></span>
<span id="cb182-40"><a href="線形回帰分析.html#cb182-40" tabindex="-1"></a><span class="co">#&gt; Model 2: medv ~ crim + rm + tax + lstat + ptratio + zn</span></span>
<span id="cb182-41"><a href="線形回帰分析.html#cb182-41" tabindex="-1"></a><span class="co">#&gt;   Res.Df   RSS Df Sum of Sq      F    Pr(&gt;F)    </span></span>
<span id="cb182-42"><a href="線形回帰分析.html#cb182-42" tabindex="-1"></a><span class="co">#&gt; 1    501 14925                                  </span></span>
<span id="cb182-43"><a href="線形回帰分析.html#cb182-43" tabindex="-1"></a><span class="co">#&gt; 2    499 13587  2    1338.1 24.572 6.636e-11 ***</span></span>
<span id="cb182-44"><a href="線形回帰分析.html#cb182-44" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb182-45"><a href="線形回帰分析.html#cb182-45" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb182-46"><a href="線形回帰分析.html#cb182-46" tabindex="-1"></a><span class="fu">anova</span>(res_lm3, res_lm1, <span class="at">test =</span> <span class="st">&quot;F&quot;</span>)  <span class="co"># 実質的に同一</span></span>
<span id="cb182-47"><a href="線形回帰分析.html#cb182-47" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb182-48"><a href="線形回帰分析.html#cb182-48" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb182-49"><a href="線形回帰分析.html#cb182-49" tabindex="-1"></a><span class="co">#&gt; Model 1: medv ~ crim + rm + tax + lstat + ptratio + zn</span></span>
<span id="cb182-50"><a href="線形回帰分析.html#cb182-50" tabindex="-1"></a><span class="co">#&gt; Model 2: medv ~ crim + rm + tax + lstat</span></span>
<span id="cb182-51"><a href="線形回帰分析.html#cb182-51" tabindex="-1"></a><span class="co">#&gt;   Res.Df   RSS Df Sum of Sq      F    Pr(&gt;F)    </span></span>
<span id="cb182-52"><a href="線形回帰分析.html#cb182-52" tabindex="-1"></a><span class="co">#&gt; 1    499 13587                                  </span></span>
<span id="cb182-53"><a href="線形回帰分析.html#cb182-53" tabindex="-1"></a><span class="co">#&gt; 2    501 14925 -2   -1338.1 24.572 6.636e-11 ***</span></span>
<span id="cb182-54"><a href="線形回帰分析.html#cb182-54" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb182-55"><a href="線形回帰分析.html#cb182-55" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb182-56"><a href="線形回帰分析.html#cb182-56" tabindex="-1"></a><span class="co"># anova(res_lm1, res_lm2, test = &#39;LRT&#39;) # 尤度比検定</span></span></code></pre></div>
<ul>
<li>ステップワイズ法による変数選択</li>
</ul>
<pre><code># step(); AICによって決定
# scope: モデルサーチの範囲(追加や削除を検討するべき変数を指定)
# scope指定ない場合:
# - directionのデフォルトは, 変数減少法(後方削除)
# - モデルサーチ上限(upper)は, 初期モデル
# scope指定ある場合:
# - directionのデフォルトは, 変数増減法
# - scopeがリストでなく, 単一式で与えらている場合, upperモデルと解釈 (lowerは欠損)</code></pre>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="線形回帰分析.html#cb184-1" tabindex="-1"></a>res_lm_all <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> housing)  <span class="co"># → 13変数</span></span>
<span id="cb184-2"><a href="線形回帰分析.html#cb184-2" tabindex="-1"></a>res_lm_all_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> housing)  <span class="co"># → y切片のみ (変数なし)</span></span>
<span id="cb184-3"><a href="線形回帰分析.html#cb184-3" tabindex="-1"></a></span>
<span id="cb184-4"><a href="線形回帰分析.html#cb184-4" tabindex="-1"></a><span class="fu">step</span>(res_lm5)  <span class="co"># 変数減少法 (scopeない場合のデフォルト)</span></span>
<span id="cb184-5"><a href="線形回帰分析.html#cb184-5" tabindex="-1"></a><span class="co">#&gt; Start:  AIC=1576.18</span></span>
<span id="cb184-6"><a href="線形回帰分析.html#cb184-6" tabindex="-1"></a><span class="co">#&gt; medv ~ crim + rm + tax + ptratio + invlstat</span></span>
<span id="cb184-7"><a href="線形回帰分析.html#cb184-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb184-8"><a href="線形回帰分析.html#cb184-8" tabindex="-1"></a><span class="co">#&gt;            Df Sum of Sq   RSS    AIC</span></span>
<span id="cb184-9"><a href="線形回帰分析.html#cb184-9" tabindex="-1"></a><span class="co">#&gt; - tax       1      40.1 11175 1576.0</span></span>
<span id="cb184-10"><a href="線形回帰分析.html#cb184-10" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;                  11134 1576.2</span></span>
<span id="cb184-11"><a href="線形回帰分析.html#cb184-11" tabindex="-1"></a><span class="co">#&gt; - crim      1     350.9 11485 1589.9</span></span>
<span id="cb184-12"><a href="線形回帰分析.html#cb184-12" tabindex="-1"></a><span class="co">#&gt; - ptratio   1     756.1 11891 1607.4</span></span>
<span id="cb184-13"><a href="線形回帰分析.html#cb184-13" tabindex="-1"></a><span class="co">#&gt; - rm        1    1860.5 12995 1652.4</span></span>
<span id="cb184-14"><a href="線形回帰分析.html#cb184-14" tabindex="-1"></a><span class="co">#&gt; - invlstat  1    5752.7 16887 1784.9</span></span>
<span id="cb184-15"><a href="線形回帰分析.html#cb184-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb184-16"><a href="線形回帰分析.html#cb184-16" tabindex="-1"></a><span class="co">#&gt; Step:  AIC=1576</span></span>
<span id="cb184-17"><a href="線形回帰分析.html#cb184-17" tabindex="-1"></a><span class="co">#&gt; medv ~ crim + rm + ptratio + invlstat</span></span>
<span id="cb184-18"><a href="線形回帰分析.html#cb184-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb184-19"><a href="線形回帰分析.html#cb184-19" tabindex="-1"></a><span class="co">#&gt;            Df Sum of Sq   RSS    AIC</span></span>
<span id="cb184-20"><a href="線形回帰分析.html#cb184-20" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;                  11175 1576.0</span></span>
<span id="cb184-21"><a href="線形回帰分析.html#cb184-21" tabindex="-1"></a><span class="co">#&gt; - crim      1     643.8 11818 1602.3</span></span>
<span id="cb184-22"><a href="線形回帰分析.html#cb184-22" tabindex="-1"></a><span class="co">#&gt; - ptratio   1     951.0 12126 1615.3</span></span>
<span id="cb184-23"><a href="線形回帰分析.html#cb184-23" tabindex="-1"></a><span class="co">#&gt; - rm        1    1847.9 13023 1651.4</span></span>
<span id="cb184-24"><a href="線形回帰分析.html#cb184-24" tabindex="-1"></a><span class="co">#&gt; - invlstat  1    6153.6 17328 1796.0</span></span>
<span id="cb184-25"><a href="線形回帰分析.html#cb184-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb184-26"><a href="線形回帰分析.html#cb184-26" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb184-27"><a href="線形回帰分析.html#cb184-27" tabindex="-1"></a><span class="co">#&gt; lm(formula = medv ~ crim + rm + ptratio + invlstat, data = data2)</span></span>
<span id="cb184-28"><a href="線形回帰分析.html#cb184-28" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb184-29"><a href="線形回帰分析.html#cb184-29" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb184-30"><a href="線形回帰分析.html#cb184-30" tabindex="-1"></a><span class="co">#&gt; (Intercept)         crim           rm      ptratio     invlstat  </span></span>
<span id="cb184-31"><a href="線形回帰分析.html#cb184-31" tabindex="-1"></a><span class="co">#&gt;      6.6395      -0.1399       3.5960      -0.7113      61.4172</span></span>
<span id="cb184-32"><a href="線形回帰分析.html#cb184-32" tabindex="-1"></a><span class="co"># step(res_lm5, direction = &#39;forward&#39;)\t# 変数増加法 (上限は初期モデル)</span></span>
<span id="cb184-33"><a href="線形回帰分析.html#cb184-33" tabindex="-1"></a><span class="co"># step(res_lm5, direction = &#39;both&#39;)\t# 変数増減法 (上限は初期モデル)</span></span></code></pre></div>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="線形回帰分析.html#cb185-1" tabindex="-1"></a><span class="co"># 採用する変数の上限・下限の指定</span></span>
<span id="cb185-2"><a href="線形回帰分析.html#cb185-2" tabindex="-1"></a><span class="fu">step</span>(res_lm_all, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> <span class="sc">~</span>crim <span class="sc">+</span> rm))  <span class="co"># 下限のモデルを指定. 変数増減法</span></span>
<span id="cb185-3"><a href="線形回帰分析.html#cb185-3" tabindex="-1"></a><span class="co">#&gt; Start:  AIC=1589.64</span></span>
<span id="cb185-4"><a href="線形回帰分析.html#cb185-4" tabindex="-1"></a><span class="co">#&gt; medv ~ crim + zn + indus + chas + nox + rm + age + dis + rad + </span></span>
<span id="cb185-5"><a href="線形回帰分析.html#cb185-5" tabindex="-1"></a><span class="co">#&gt;     tax + ptratio + b + lstat</span></span>
<span id="cb185-6"><a href="線形回帰分析.html#cb185-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb185-7"><a href="線形回帰分析.html#cb185-7" tabindex="-1"></a><span class="co">#&gt;           Df Sum of Sq   RSS    AIC</span></span>
<span id="cb185-8"><a href="線形回帰分析.html#cb185-8" tabindex="-1"></a><span class="co">#&gt; - age      1      0.06 11079 1587.7</span></span>
<span id="cb185-9"><a href="線形回帰分析.html#cb185-9" tabindex="-1"></a><span class="co">#&gt; - indus    1      2.52 11081 1587.8</span></span>
<span id="cb185-10"><a href="線形回帰分析.html#cb185-10" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;                 11079 1589.6</span></span>
<span id="cb185-11"><a href="線形回帰分析.html#cb185-11" tabindex="-1"></a><span class="co">#&gt; - chas     1    218.97 11298 1597.5</span></span>
<span id="cb185-12"><a href="線形回帰分析.html#cb185-12" tabindex="-1"></a><span class="co">#&gt; - tax      1    242.26 11321 1598.6</span></span>
<span id="cb185-13"><a href="線形回帰分析.html#cb185-13" tabindex="-1"></a><span class="co">#&gt; - zn       1    257.49 11336 1599.3</span></span>
<span id="cb185-14"><a href="線形回帰分析.html#cb185-14" tabindex="-1"></a><span class="co">#&gt; - b        1    270.63 11349 1599.8</span></span>
<span id="cb185-15"><a href="線形回帰分析.html#cb185-15" tabindex="-1"></a><span class="co">#&gt; - rad      1    479.15 11558 1609.1</span></span>
<span id="cb185-16"><a href="線形回帰分析.html#cb185-16" tabindex="-1"></a><span class="co">#&gt; - nox      1    487.16 11566 1609.4</span></span>
<span id="cb185-17"><a href="線形回帰分析.html#cb185-17" tabindex="-1"></a><span class="co">#&gt; - ptratio  1   1194.23 12273 1639.4</span></span>
<span id="cb185-18"><a href="線形回帰分析.html#cb185-18" tabindex="-1"></a><span class="co">#&gt; - dis      1   1232.41 12311 1641.0</span></span>
<span id="cb185-19"><a href="線形回帰分析.html#cb185-19" tabindex="-1"></a><span class="co">#&gt; - lstat    1   2410.84 13490 1687.3</span></span>
<span id="cb185-20"><a href="線形回帰分析.html#cb185-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb185-21"><a href="線形回帰分析.html#cb185-21" tabindex="-1"></a><span class="co">#&gt; Step:  AIC=1587.65</span></span>
<span id="cb185-22"><a href="線形回帰分析.html#cb185-22" tabindex="-1"></a><span class="co">#&gt; medv ~ crim + zn + indus + chas + nox + rm + dis + rad + tax + </span></span>
<span id="cb185-23"><a href="線形回帰分析.html#cb185-23" tabindex="-1"></a><span class="co">#&gt;     ptratio + b + lstat</span></span>
<span id="cb185-24"><a href="線形回帰分析.html#cb185-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb185-25"><a href="線形回帰分析.html#cb185-25" tabindex="-1"></a><span class="co">#&gt;           Df Sum of Sq   RSS    AIC</span></span>
<span id="cb185-26"><a href="線形回帰分析.html#cb185-26" tabindex="-1"></a><span class="co">#&gt; - indus    1      2.52 11081 1585.8</span></span>
<span id="cb185-27"><a href="線形回帰分析.html#cb185-27" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;                 11079 1587.7</span></span>
<span id="cb185-28"><a href="線形回帰分析.html#cb185-28" tabindex="-1"></a><span class="co">#&gt; - chas     1    219.91 11299 1595.6</span></span>
<span id="cb185-29"><a href="線形回帰分析.html#cb185-29" tabindex="-1"></a><span class="co">#&gt; - tax      1    242.24 11321 1596.6</span></span>
<span id="cb185-30"><a href="線形回帰分析.html#cb185-30" tabindex="-1"></a><span class="co">#&gt; - zn       1    260.32 11339 1597.4</span></span>
<span id="cb185-31"><a href="線形回帰分析.html#cb185-31" tabindex="-1"></a><span class="co">#&gt; - b        1    272.26 11351 1597.9</span></span>
<span id="cb185-32"><a href="線形回帰分析.html#cb185-32" tabindex="-1"></a><span class="co">#&gt; - rad      1    481.09 11560 1607.2</span></span>
<span id="cb185-33"><a href="線形回帰分析.html#cb185-33" tabindex="-1"></a><span class="co">#&gt; - nox      1    520.87 11600 1608.9</span></span>
<span id="cb185-34"><a href="線形回帰分析.html#cb185-34" tabindex="-1"></a><span class="co">#&gt; - ptratio  1   1200.23 12279 1637.7</span></span>
<span id="cb185-35"><a href="線形回帰分析.html#cb185-35" tabindex="-1"></a><span class="co">#&gt; - dis      1   1352.26 12431 1643.9</span></span>
<span id="cb185-36"><a href="線形回帰分析.html#cb185-36" tabindex="-1"></a><span class="co">#&gt; - lstat    1   2718.88 13798 1696.7</span></span>
<span id="cb185-37"><a href="線形回帰分析.html#cb185-37" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb185-38"><a href="線形回帰分析.html#cb185-38" tabindex="-1"></a><span class="co">#&gt; Step:  AIC=1585.76</span></span>
<span id="cb185-39"><a href="線形回帰分析.html#cb185-39" tabindex="-1"></a><span class="co">#&gt; medv ~ crim + zn + chas + nox + rm + dis + rad + tax + ptratio + </span></span>
<span id="cb185-40"><a href="線形回帰分析.html#cb185-40" tabindex="-1"></a><span class="co">#&gt;     b + lstat</span></span>
<span id="cb185-41"><a href="線形回帰分析.html#cb185-41" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb185-42"><a href="線形回帰分析.html#cb185-42" tabindex="-1"></a><span class="co">#&gt;           Df Sum of Sq   RSS    AIC</span></span>
<span id="cb185-43"><a href="線形回帰分析.html#cb185-43" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;                 11081 1585.8</span></span>
<span id="cb185-44"><a href="線形回帰分析.html#cb185-44" tabindex="-1"></a><span class="co">#&gt; - chas     1    227.21 11309 1594.0</span></span>
<span id="cb185-45"><a href="線形回帰分析.html#cb185-45" tabindex="-1"></a><span class="co">#&gt; - zn       1    257.82 11339 1595.4</span></span>
<span id="cb185-46"><a href="線形回帰分析.html#cb185-46" tabindex="-1"></a><span class="co">#&gt; - b        1    270.82 11352 1596.0</span></span>
<span id="cb185-47"><a href="線形回帰分析.html#cb185-47" tabindex="-1"></a><span class="co">#&gt; - tax      1    273.62 11355 1596.1</span></span>
<span id="cb185-48"><a href="線形回帰分析.html#cb185-48" tabindex="-1"></a><span class="co">#&gt; - rad      1    500.92 11582 1606.1</span></span>
<span id="cb185-49"><a href="線形回帰分析.html#cb185-49" tabindex="-1"></a><span class="co">#&gt; - nox      1    541.91 11623 1607.9</span></span>
<span id="cb185-50"><a href="線形回帰分析.html#cb185-50" tabindex="-1"></a><span class="co">#&gt; - ptratio  1   1206.45 12288 1636.0</span></span>
<span id="cb185-51"><a href="線形回帰分析.html#cb185-51" tabindex="-1"></a><span class="co">#&gt; - dis      1   1448.94 12530 1645.9</span></span>
<span id="cb185-52"><a href="線形回帰分析.html#cb185-52" tabindex="-1"></a><span class="co">#&gt; - lstat    1   2723.48 13805 1695.0</span></span>
<span id="cb185-53"><a href="線形回帰分析.html#cb185-53" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb185-54"><a href="線形回帰分析.html#cb185-54" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb185-55"><a href="線形回帰分析.html#cb185-55" tabindex="-1"></a><span class="co">#&gt; lm(formula = medv ~ crim + zn + chas + nox + rm + dis + rad + </span></span>
<span id="cb185-56"><a href="線形回帰分析.html#cb185-56" tabindex="-1"></a><span class="co">#&gt;     tax + ptratio + b + lstat, data = housing)</span></span>
<span id="cb185-57"><a href="線形回帰分析.html#cb185-57" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb185-58"><a href="線形回帰分析.html#cb185-58" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb185-59"><a href="線形回帰分析.html#cb185-59" tabindex="-1"></a><span class="co">#&gt; (Intercept)         crim           zn         chas          nox           rm  </span></span>
<span id="cb185-60"><a href="線形回帰分析.html#cb185-60" tabindex="-1"></a><span class="co">#&gt;   36.341145    -0.108413     0.045845     2.718716   -17.376023     3.801579  </span></span>
<span id="cb185-61"><a href="線形回帰分析.html#cb185-61" tabindex="-1"></a><span class="co">#&gt;         dis          rad          tax      ptratio            b        lstat  </span></span>
<span id="cb185-62"><a href="線形回帰分析.html#cb185-62" tabindex="-1"></a><span class="co">#&gt;   -1.492711     0.299608    -0.011778    -0.946525     0.009291    -0.522553</span></span>
<span id="cb185-63"><a href="線形回帰分析.html#cb185-63" tabindex="-1"></a><span class="fu">step</span>(res_lm_all_2, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">upper =</span> <span class="sc">~</span>crim <span class="sc">+</span> rm))  <span class="co"># 上限のモデルを指定. 変数増減法</span></span>
<span id="cb185-64"><a href="線形回帰分析.html#cb185-64" tabindex="-1"></a><span class="co">#&gt; Start:  AIC=2246.51</span></span>
<span id="cb185-65"><a href="線形回帰分析.html#cb185-65" tabindex="-1"></a><span class="co">#&gt; medv ~ 1</span></span>
<span id="cb185-66"><a href="線形回帰分析.html#cb185-66" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb185-67"><a href="線形回帰分析.html#cb185-67" tabindex="-1"></a><span class="co">#&gt;        Df Sum of Sq   RSS    AIC</span></span>
<span id="cb185-68"><a href="線形回帰分析.html#cb185-68" tabindex="-1"></a><span class="co">#&gt; + rm    1   20654.4 22062 1914.2</span></span>
<span id="cb185-69"><a href="線形回帰分析.html#cb185-69" tabindex="-1"></a><span class="co">#&gt; + crim  1    6440.8 36276 2165.8</span></span>
<span id="cb185-70"><a href="線形回帰分析.html#cb185-70" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;              42716 2246.5</span></span>
<span id="cb185-71"><a href="線形回帰分析.html#cb185-71" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb185-72"><a href="線形回帰分析.html#cb185-72" tabindex="-1"></a><span class="co">#&gt; Step:  AIC=1914.19</span></span>
<span id="cb185-73"><a href="線形回帰分析.html#cb185-73" tabindex="-1"></a><span class="co">#&gt; medv ~ rm</span></span>
<span id="cb185-74"><a href="線形回帰分析.html#cb185-74" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb185-75"><a href="線形回帰分析.html#cb185-75" tabindex="-1"></a><span class="co">#&gt;        Df Sum of Sq   RSS    AIC</span></span>
<span id="cb185-76"><a href="線形回帰分析.html#cb185-76" tabindex="-1"></a><span class="co">#&gt; + crim  1    2496.1 19566 1855.4</span></span>
<span id="cb185-77"><a href="線形回帰分析.html#cb185-77" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;              22062 1914.2</span></span>
<span id="cb185-78"><a href="線形回帰分析.html#cb185-78" tabindex="-1"></a><span class="co">#&gt; - rm    1   20654.4 42716 2246.5</span></span>
<span id="cb185-79"><a href="線形回帰分析.html#cb185-79" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb185-80"><a href="線形回帰分析.html#cb185-80" tabindex="-1"></a><span class="co">#&gt; Step:  AIC=1855.43</span></span>
<span id="cb185-81"><a href="線形回帰分析.html#cb185-81" tabindex="-1"></a><span class="co">#&gt; medv ~ rm + crim</span></span>
<span id="cb185-82"><a href="線形回帰分析.html#cb185-82" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb185-83"><a href="線形回帰分析.html#cb185-83" tabindex="-1"></a><span class="co">#&gt;        Df Sum of Sq   RSS    AIC</span></span>
<span id="cb185-84"><a href="線形回帰分析.html#cb185-84" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;              19566 1855.4</span></span>
<span id="cb185-85"><a href="線形回帰分析.html#cb185-85" tabindex="-1"></a><span class="co">#&gt; - crim  1    2496.1 22062 1914.2</span></span>
<span id="cb185-86"><a href="線形回帰分析.html#cb185-86" tabindex="-1"></a><span class="co">#&gt; - rm    1   16709.7 36276 2165.8</span></span>
<span id="cb185-87"><a href="線形回帰分析.html#cb185-87" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb185-88"><a href="線形回帰分析.html#cb185-88" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb185-89"><a href="線形回帰分析.html#cb185-89" tabindex="-1"></a><span class="co">#&gt; lm(formula = medv ~ rm + crim, data = housing)</span></span>
<span id="cb185-90"><a href="線形回帰分析.html#cb185-90" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb185-91"><a href="線形回帰分析.html#cb185-91" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb185-92"><a href="線形回帰分析.html#cb185-92" tabindex="-1"></a><span class="co">#&gt; (Intercept)           rm         crim  </span></span>
<span id="cb185-93"><a href="線形回帰分析.html#cb185-93" tabindex="-1"></a><span class="co">#&gt;    -29.2447       8.3911      -0.2649</span></span>
<span id="cb185-94"><a href="線形回帰分析.html#cb185-94" tabindex="-1"></a><span class="fu">step</span>(res_lm1, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">upper =</span> <span class="sc">~</span>crim <span class="sc">+</span> rm <span class="sc">+</span> tax <span class="sc">+</span> lstat <span class="sc">+</span> ptratio <span class="sc">+</span> b, <span class="at">lower =</span> <span class="sc">~</span>crim <span class="sc">+</span></span>
<span id="cb185-95"><a href="線形回帰分析.html#cb185-95" tabindex="-1"></a>  rm))</span>
<span id="cb185-96"><a href="線形回帰分析.html#cb185-96" tabindex="-1"></a><span class="co">#&gt; Start:  AIC=1722.43</span></span>
<span id="cb185-97"><a href="線形回帰分析.html#cb185-97" tabindex="-1"></a><span class="co">#&gt; medv ~ crim + rm + tax + lstat</span></span>
<span id="cb185-98"><a href="線形回帰分析.html#cb185-98" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb185-99"><a href="線形回帰分析.html#cb185-99" tabindex="-1"></a><span class="co">#&gt;           Df Sum of Sq   RSS    AIC</span></span>
<span id="cb185-100"><a href="線形回帰分析.html#cb185-100" tabindex="-1"></a><span class="co">#&gt; + ptratio  1    1324.2 13601 1677.4</span></span>
<span id="cb185-101"><a href="線形回帰分析.html#cb185-101" tabindex="-1"></a><span class="co">#&gt; + b        1     255.6 14669 1715.7</span></span>
<span id="cb185-102"><a href="線形回帰分析.html#cb185-102" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;                 14925 1722.4</span></span>
<span id="cb185-103"><a href="線形回帰分析.html#cb185-103" tabindex="-1"></a><span class="co">#&gt; - tax      1     203.1 15128 1727.3</span></span>
<span id="cb185-104"><a href="線形回帰分析.html#cb185-104" tabindex="-1"></a><span class="co">#&gt; - lstat    1    3373.6 18298 1823.5</span></span>
<span id="cb185-105"><a href="線形回帰分析.html#cb185-105" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb185-106"><a href="線形回帰分析.html#cb185-106" tabindex="-1"></a><span class="co">#&gt; Step:  AIC=1677.41</span></span>
<span id="cb185-107"><a href="線形回帰分析.html#cb185-107" tabindex="-1"></a><span class="co">#&gt; medv ~ crim + rm + tax + lstat + ptratio</span></span>
<span id="cb185-108"><a href="線形回帰分析.html#cb185-108" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb185-109"><a href="線形回帰分析.html#cb185-109" tabindex="-1"></a><span class="co">#&gt;           Df Sum of Sq   RSS    AIC</span></span>
<span id="cb185-110"><a href="線形回帰分析.html#cb185-110" tabindex="-1"></a><span class="co">#&gt; + b        1     306.0 13295 1667.9</span></span>
<span id="cb185-111"><a href="線形回帰分析.html#cb185-111" tabindex="-1"></a><span class="co">#&gt; - tax      1       4.9 13606 1675.6</span></span>
<span id="cb185-112"><a href="線形回帰分析.html#cb185-112" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;                 13601 1677.4</span></span>
<span id="cb185-113"><a href="線形回帰分析.html#cb185-113" tabindex="-1"></a><span class="co">#&gt; - ptratio  1    1324.2 14925 1722.4</span></span>
<span id="cb185-114"><a href="線形回帰分析.html#cb185-114" tabindex="-1"></a><span class="co">#&gt; - lstat    1    3286.7 16887 1784.9</span></span>
<span id="cb185-115"><a href="線形回帰分析.html#cb185-115" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb185-116"><a href="線形回帰分析.html#cb185-116" tabindex="-1"></a><span class="co">#&gt; Step:  AIC=1667.9</span></span>
<span id="cb185-117"><a href="線形回帰分析.html#cb185-117" tabindex="-1"></a><span class="co">#&gt; medv ~ crim + rm + tax + lstat + ptratio + b</span></span>
<span id="cb185-118"><a href="線形回帰分析.html#cb185-118" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb185-119"><a href="線形回帰分析.html#cb185-119" tabindex="-1"></a><span class="co">#&gt;           Df Sum of Sq   RSS    AIC</span></span>
<span id="cb185-120"><a href="線形回帰分析.html#cb185-120" tabindex="-1"></a><span class="co">#&gt; - tax      1      3.06 13298 1666.0</span></span>
<span id="cb185-121"><a href="線形回帰分析.html#cb185-121" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;                 13295 1667.9</span></span>
<span id="cb185-122"><a href="線形回帰分析.html#cb185-122" tabindex="-1"></a><span class="co">#&gt; - b        1    306.02 13601 1677.4</span></span>
<span id="cb185-123"><a href="線形回帰分析.html#cb185-123" tabindex="-1"></a><span class="co">#&gt; - ptratio  1   1374.66 14669 1715.7</span></span>
<span id="cb185-124"><a href="線形回帰分析.html#cb185-124" tabindex="-1"></a><span class="co">#&gt; - lstat    1   2849.76 16144 1764.2</span></span>
<span id="cb185-125"><a href="線形回帰分析.html#cb185-125" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb185-126"><a href="線形回帰分析.html#cb185-126" tabindex="-1"></a><span class="co">#&gt; Step:  AIC=1666.01</span></span>
<span id="cb185-127"><a href="線形回帰分析.html#cb185-127" tabindex="-1"></a><span class="co">#&gt; medv ~ crim + rm + lstat + ptratio + b</span></span>
<span id="cb185-128"><a href="線形回帰分析.html#cb185-128" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb185-129"><a href="線形回帰分析.html#cb185-129" tabindex="-1"></a><span class="co">#&gt;           Df Sum of Sq   RSS    AIC</span></span>
<span id="cb185-130"><a href="線形回帰分析.html#cb185-130" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;                 13298 1666.0</span></span>
<span id="cb185-131"><a href="線形回帰分析.html#cb185-131" tabindex="-1"></a><span class="co">#&gt; + tax      1      3.06 13295 1667.9</span></span>
<span id="cb185-132"><a href="線形回帰分析.html#cb185-132" tabindex="-1"></a><span class="co">#&gt; - b        1    307.85 13606 1675.6</span></span>
<span id="cb185-133"><a href="線形回帰分析.html#cb185-133" tabindex="-1"></a><span class="co">#&gt; - ptratio  1   1478.71 14776 1717.4</span></span>
<span id="cb185-134"><a href="線形回帰分析.html#cb185-134" tabindex="-1"></a><span class="co">#&gt; - lstat    1   3001.77 16299 1767.0</span></span>
<span id="cb185-135"><a href="線形回帰分析.html#cb185-135" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb185-136"><a href="線形回帰分析.html#cb185-136" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb185-137"><a href="線形回帰分析.html#cb185-137" tabindex="-1"></a><span class="co">#&gt; lm(formula = medv ~ crim + rm + lstat + ptratio + b, data = housing)</span></span>
<span id="cb185-138"><a href="線形回帰分析.html#cb185-138" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb185-139"><a href="線形回帰分析.html#cb185-139" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb185-140"><a href="線形回帰分析.html#cb185-140" tabindex="-1"></a><span class="co">#&gt; (Intercept)         crim           rm        lstat      ptratio            b  </span></span>
<span id="cb185-141"><a href="線形回帰分析.html#cb185-141" tabindex="-1"></a><span class="co">#&gt;   11.615006    -0.038921     4.788176    -0.495139    -0.877249     0.009593</span></span>
<span id="cb185-142"><a href="線形回帰分析.html#cb185-142" tabindex="-1"></a><span class="co"># 上限・下限を同時に指定. 変数増減法 ----------------------------------------#</span></span></code></pre></div>
</div>
</div>
<div id="説明変数に質的変数を含む回帰" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> 説明変数に質的変数を含む回帰<a href="線形回帰分析.html#説明変数に質的変数を含む回帰" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="データセット3-高速道路事故データ" class="section level3 unnumbered hasAnchor">
<h3>データセット#3: 高速道路事故データ<a href="線形回帰分析.html#データセット3-高速道路事故データ" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>- Hoffstedt’s Highway accident data
  - adt：1日の平均交通量（単位：千台)
  - trks：総交通量に占めるトラック交通量の割合
  - lane：交通の総車線数
  - acpt：1マイルあたりのアクセスポイント数
  - sigs: 1マイルあたりの信号付きインターチェンジの数
  - itg：1マイルあたりの高速道路型インターチェンジの数
  - slim：1973年の制限速度
  - lwid: 車線幅（フィート単位） 
  - shld: 車道の外側路肩の幅（フィート単位)
  - htype: 道路の種類または道路の財源を示す指標:
    &quot;mc&quot;: メジャーコレクター (major collector), &quot;fai&quot;: 州間 (interstate) 高速道路, &quot;pa&quot;: 地域・都市間主要幹線 (principal arterial) 道路, &quot;ma&quot;; 地域・都市内主要幹線 (major arterial) 道路
  - rate: 1973年の事故発生率（百万車両マイル当たり）
- 注) htypeは4-水準因子
- 参考文献: Weisberg (2014), Applied Linear Regression, 4th Ed., Wiley.</code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="線形回帰分析.html#cb187-1" tabindex="-1"></a><span class="fu">library</span>(alr4)</span>
<span id="cb187-2"><a href="線形回帰分析.html#cb187-2" tabindex="-1"></a><span class="fu">data</span>(Highway)</span>
<span id="cb187-3"><a href="線形回帰分析.html#cb187-3" tabindex="-1"></a><span class="fu">str</span>(Highway)</span>
<span id="cb187-4"><a href="線形回帰分析.html#cb187-4" tabindex="-1"></a><span class="co">#&gt; &#39;data.frame&#39;:    39 obs. of  12 variables:</span></span>
<span id="cb187-5"><a href="線形回帰分析.html#cb187-5" tabindex="-1"></a><span class="co">#&gt;  $ adt  : int  69 73 49 61 28 30 46 25 43 23 ...</span></span>
<span id="cb187-6"><a href="線形回帰分析.html#cb187-6" tabindex="-1"></a><span class="co">#&gt;  $ trks : int  8 8 10 13 12 6 8 9 12 7 ...</span></span>
<span id="cb187-7"><a href="線形回帰分析.html#cb187-7" tabindex="-1"></a><span class="co">#&gt;  $ lane : int  8 4 4 6 4 4 4 4 4 4 ...</span></span>
<span id="cb187-8"><a href="線形回帰分析.html#cb187-8" tabindex="-1"></a><span class="co">#&gt;  $ acpt : num  4.6 4.4 4.7 3.8 2.2 24.8 11 18.5 7.5 8.2 ...</span></span>
<span id="cb187-9"><a href="線形回帰分析.html#cb187-9" tabindex="-1"></a><span class="co">#&gt;  $ sigs : num  0 0 0 0 0 1.84 0.7 0.38 1.39 1.21 ...</span></span>
<span id="cb187-10"><a href="線形回帰分析.html#cb187-10" tabindex="-1"></a><span class="co">#&gt;  $ itg  : num  1.2 1.43 1.54 0.94 0.65 0.34 0.47 0.38 0.95 0.12 ...</span></span>
<span id="cb187-11"><a href="線形回帰分析.html#cb187-11" tabindex="-1"></a><span class="co">#&gt;  $ slim : int  55 60 60 65 70 55 55 55 50 50 ...</span></span>
<span id="cb187-12"><a href="線形回帰分析.html#cb187-12" tabindex="-1"></a><span class="co">#&gt;  $ len  : num  4.99 16.11 9.75 10.65 20.01 ...</span></span>
<span id="cb187-13"><a href="線形回帰分析.html#cb187-13" tabindex="-1"></a><span class="co">#&gt;  $ lwid : int  12 12 12 12 12 12 12 12 12 12 ...</span></span>
<span id="cb187-14"><a href="線形回帰分析.html#cb187-14" tabindex="-1"></a><span class="co">#&gt;  $ shld : int  10 10 10 10 10 10 8 10 4 5 ...</span></span>
<span id="cb187-15"><a href="線形回帰分析.html#cb187-15" tabindex="-1"></a><span class="co">#&gt;  $ htype: Factor w/ 4 levels &quot;mc&quot;,&quot;fai&quot;,&quot;pa&quot;,..: 2 2 2 2 2 3 3 3 3 3 ...</span></span>
<span id="cb187-16"><a href="線形回帰分析.html#cb187-16" tabindex="-1"></a><span class="co">#&gt;  $ rate : num  4.58 2.86 3.02 2.29 1.61 6.87 3.85 6.12 3.29 5.88 ...</span></span></code></pre></div>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="線形回帰分析.html#cb188-1" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb188-2"><a href="線形回帰分析.html#cb188-2" tabindex="-1"></a>cor_hw <span class="ot">&lt;-</span> <span class="fu">cor</span>(<span class="fu">cbind</span>(Highway<span class="sc">$</span>rate, Highway[, <span class="sc">-</span>(<span class="dv">11</span><span class="sc">:</span><span class="dv">12</span>)]))  <span class="co"># htypeを除去</span></span>
<span id="cb188-3"><a href="線形回帰分析.html#cb188-3" tabindex="-1"></a><span class="fu">corrplot.mixed</span>(cor_hw)</span></code></pre></div>
<p><img src="040-linreg_files/figure-html/unnamed-chunk-4-1.png" width="75%" /></p>
<ul>
<li>多重共線性のチェック (VIF)</li>
</ul>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="線形回帰分析.html#cb189-1" tabindex="-1"></a><span class="co"># VIF install.packages(&#39;car&#39;)\t\t# or RStudio, Tools → Install packages,</span></span>
<span id="cb189-2"><a href="線形回帰分析.html#cb189-2" tabindex="-1"></a><span class="fu">library</span>(car)  <span class="co"># &#39;Companion to Applied Regression&#39; package</span></span>
<span id="cb189-3"><a href="線形回帰分析.html#cb189-3" tabindex="-1"></a><span class="fu">vif</span>(res_lm)</span>
<span id="cb189-4"><a href="線形回帰分析.html#cb189-4" tabindex="-1"></a><span class="co">#&gt;     area      yrs     dist </span></span>
<span id="cb189-5"><a href="線形回帰分析.html#cb189-5" tabindex="-1"></a><span class="co">#&gt; 1.003378 1.006251 1.003784</span></span></code></pre></div>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="線形回帰分析.html#cb190-1" tabindex="-1"></a><span class="co"># OLS回帰</span></span>
<span id="cb190-2"><a href="線形回帰分析.html#cb190-2" tabindex="-1"></a>res_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(rate <span class="sc">~</span> ., <span class="at">data =</span> Highway)</span>
<span id="cb190-3"><a href="線形回帰分析.html#cb190-3" tabindex="-1"></a><span class="fu">summary</span>(res_lm)</span>
<span id="cb190-4"><a href="線形回帰分析.html#cb190-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb190-5"><a href="線形回帰分析.html#cb190-5" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb190-6"><a href="線形回帰分析.html#cb190-6" tabindex="-1"></a><span class="co">#&gt; lm(formula = rate ~ ., data = Highway)</span></span>
<span id="cb190-7"><a href="線形回帰分析.html#cb190-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb190-8"><a href="線形回帰分析.html#cb190-8" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb190-9"><a href="線形回帰分析.html#cb190-9" tabindex="-1"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb190-10"><a href="線形回帰分析.html#cb190-10" tabindex="-1"></a><span class="co">#&gt; -1.99564 -0.62039 -0.05676  0.61741  2.54998 </span></span>
<span id="cb190-11"><a href="線形回帰分析.html#cb190-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb190-12"><a href="線形回帰分析.html#cb190-12" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb190-13"><a href="線形回帰分析.html#cb190-13" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span id="cb190-14"><a href="線形回帰分析.html#cb190-14" tabindex="-1"></a><span class="co">#&gt; (Intercept) 13.658212   6.872719   1.987   0.0579 .</span></span>
<span id="cb190-15"><a href="線形回帰分析.html#cb190-15" tabindex="-1"></a><span class="co">#&gt; adt         -0.004038   0.033945  -0.119   0.9063  </span></span>
<span id="cb190-16"><a href="線形回帰分析.html#cb190-16" tabindex="-1"></a><span class="co">#&gt; trks        -0.100150   0.114726  -0.873   0.3910  </span></span>
<span id="cb190-17"><a href="線形回帰分析.html#cb190-17" tabindex="-1"></a><span class="co">#&gt; lane         0.026675   0.283834   0.094   0.9259  </span></span>
<span id="cb190-18"><a href="線形回帰分析.html#cb190-18" tabindex="-1"></a><span class="co">#&gt; acpt         0.066588   0.042569   1.564   0.1303  </span></span>
<span id="cb190-19"><a href="線形回帰分析.html#cb190-19" tabindex="-1"></a><span class="co">#&gt; sigs         0.713644   0.525213   1.359   0.1864  </span></span>
<span id="cb190-20"><a href="線形回帰分析.html#cb190-20" tabindex="-1"></a><span class="co">#&gt; itg         -0.475478   1.282742  -0.371   0.7140  </span></span>
<span id="cb190-21"><a href="線形回帰分析.html#cb190-21" tabindex="-1"></a><span class="co">#&gt; slim        -0.123778   0.081683  -1.515   0.1422  </span></span>
<span id="cb190-22"><a href="線形回帰分析.html#cb190-22" tabindex="-1"></a><span class="co">#&gt; len         -0.064751   0.033369  -1.940   0.0637 .</span></span>
<span id="cb190-23"><a href="線形回帰分析.html#cb190-23" tabindex="-1"></a><span class="co">#&gt; lwid        -0.133813   0.597917  -0.224   0.8247  </span></span>
<span id="cb190-24"><a href="線形回帰分析.html#cb190-24" tabindex="-1"></a><span class="co">#&gt; shld         0.014113   0.162174   0.087   0.9313  </span></span>
<span id="cb190-25"><a href="線形回帰分析.html#cb190-25" tabindex="-1"></a><span class="co">#&gt; htypefai     0.543592   1.728270   0.315   0.7557  </span></span>
<span id="cb190-26"><a href="線形回帰分析.html#cb190-26" tabindex="-1"></a><span class="co">#&gt; htypepa     -1.009777   1.105612  -0.913   0.3698  </span></span>
<span id="cb190-27"><a href="線形回帰分析.html#cb190-27" tabindex="-1"></a><span class="co">#&gt; htypema     -0.548025   0.975623  -0.562   0.5793  </span></span>
<span id="cb190-28"><a href="線形回帰分析.html#cb190-28" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb190-29"><a href="線形回帰分析.html#cb190-29" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb190-30"><a href="線形回帰分析.html#cb190-30" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb190-31"><a href="線形回帰分析.html#cb190-31" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 1.198 on 25 degrees of freedom</span></span>
<span id="cb190-32"><a href="線形回帰分析.html#cb190-32" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.7605, Adjusted R-squared:  0.636 </span></span>
<span id="cb190-33"><a href="線形回帰分析.html#cb190-33" tabindex="-1"></a><span class="co">#&gt; F-statistic: 6.107 on 13 and 25 DF,  p-value: 5.733e-05</span></span>
<span id="cb190-34"><a href="線形回帰分析.html#cb190-34" tabindex="-1"></a></span>
<span id="cb190-35"><a href="線形回帰分析.html#cb190-35" tabindex="-1"></a><span class="co"># ステップワイズ回帰</span></span>
<span id="cb190-36"><a href="線形回帰分析.html#cb190-36" tabindex="-1"></a>res_step <span class="ot">&lt;-</span> <span class="fu">step</span>(res_lm)</span>
<span id="cb190-37"><a href="線形回帰分析.html#cb190-37" tabindex="-1"></a><span class="co">#&gt; Start:  AIC=24.76</span></span>
<span id="cb190-38"><a href="線形回帰分析.html#cb190-38" tabindex="-1"></a><span class="co">#&gt; rate ~ adt + trks + lane + acpt + sigs + itg + slim + len + lwid + </span></span>
<span id="cb190-39"><a href="線形回帰分析.html#cb190-39" tabindex="-1"></a><span class="co">#&gt;     shld + htype</span></span>
<span id="cb190-40"><a href="線形回帰分析.html#cb190-40" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb190-41"><a href="線形回帰分析.html#cb190-41" tabindex="-1"></a><span class="co">#&gt;         Df Sum of Sq    RSS    AIC</span></span>
<span id="cb190-42"><a href="線形回帰分析.html#cb190-42" tabindex="-1"></a><span class="co">#&gt; - htype  3    3.1001 38.994 21.994</span></span>
<span id="cb190-43"><a href="線形回帰分析.html#cb190-43" tabindex="-1"></a><span class="co">#&gt; - shld   1    0.0109 35.905 22.775</span></span>
<span id="cb190-44"><a href="線形回帰分析.html#cb190-44" tabindex="-1"></a><span class="co">#&gt; - lane   1    0.0127 35.906 22.777</span></span>
<span id="cb190-45"><a href="線形回帰分析.html#cb190-45" tabindex="-1"></a><span class="co">#&gt; - adt    1    0.0203 35.914 22.785</span></span>
<span id="cb190-46"><a href="線形回帰分析.html#cb190-46" tabindex="-1"></a><span class="co">#&gt; - lwid   1    0.0719 35.966 22.841</span></span>
<span id="cb190-47"><a href="線形回帰分析.html#cb190-47" tabindex="-1"></a><span class="co">#&gt; - itg    1    0.1973 36.091 22.977</span></span>
<span id="cb190-48"><a href="線形回帰分析.html#cb190-48" tabindex="-1"></a><span class="co">#&gt; - trks   1    1.0941 36.988 23.934</span></span>
<span id="cb190-49"><a href="線形回帰分析.html#cb190-49" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;               35.894 24.763</span></span>
<span id="cb190-50"><a href="線形回帰分析.html#cb190-50" tabindex="-1"></a><span class="co">#&gt; - sigs   1    2.6508 38.544 25.542</span></span>
<span id="cb190-51"><a href="線形回帰分析.html#cb190-51" tabindex="-1"></a><span class="co">#&gt; - slim   1    3.2969 39.191 26.190</span></span>
<span id="cb190-52"><a href="線形回帰分析.html#cb190-52" tabindex="-1"></a><span class="co">#&gt; - acpt   1    3.5130 39.407 26.405</span></span>
<span id="cb190-53"><a href="線形回帰分析.html#cb190-53" tabindex="-1"></a><span class="co">#&gt; - len    1    5.4061 41.300 28.235</span></span>
<span id="cb190-54"><a href="線形回帰分析.html#cb190-54" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb190-55"><a href="線形回帰分析.html#cb190-55" tabindex="-1"></a><span class="co">#&gt; Step:  AIC=21.99</span></span>
<span id="cb190-56"><a href="線形回帰分析.html#cb190-56" tabindex="-1"></a><span class="co">#&gt; rate ~ adt + trks + lane + acpt + sigs + itg + slim + len + lwid + </span></span>
<span id="cb190-57"><a href="線形回帰分析.html#cb190-57" tabindex="-1"></a><span class="co">#&gt;     shld</span></span>
<span id="cb190-58"><a href="線形回帰分析.html#cb190-58" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb190-59"><a href="線形回帰分析.html#cb190-59" tabindex="-1"></a><span class="co">#&gt;        Df Sum of Sq    RSS    AIC</span></span>
<span id="cb190-60"><a href="線形回帰分析.html#cb190-60" tabindex="-1"></a><span class="co">#&gt; - adt   1    0.0131 39.007 20.007</span></span>
<span id="cb190-61"><a href="線形回帰分析.html#cb190-61" tabindex="-1"></a><span class="co">#&gt; - lane  1    0.0296 39.023 20.023</span></span>
<span id="cb190-62"><a href="線形回帰分析.html#cb190-62" tabindex="-1"></a><span class="co">#&gt; - itg   1    0.0431 39.037 20.037</span></span>
<span id="cb190-63"><a href="線形回帰分析.html#cb190-63" tabindex="-1"></a><span class="co">#&gt; - lwid  1    0.9119 39.906 20.895</span></span>
<span id="cb190-64"><a href="線形回帰分析.html#cb190-64" tabindex="-1"></a><span class="co">#&gt; - sigs  1    0.9652 39.959 20.948</span></span>
<span id="cb190-65"><a href="線形回帰分析.html#cb190-65" tabindex="-1"></a><span class="co">#&gt; - shld  1    0.9680 39.962 20.950</span></span>
<span id="cb190-66"><a href="線形回帰分析.html#cb190-66" tabindex="-1"></a><span class="co">#&gt; - slim  1    1.3365 40.330 21.308</span></span>
<span id="cb190-67"><a href="線形回帰分析.html#cb190-67" tabindex="-1"></a><span class="co">#&gt; - trks  1    1.7899 40.784 21.744</span></span>
<span id="cb190-68"><a href="線形回帰分析.html#cb190-68" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;              38.994 21.994</span></span>
<span id="cb190-69"><a href="線形回帰分析.html#cb190-69" tabindex="-1"></a><span class="co">#&gt; - len   1    5.2726 44.266 24.940</span></span>
<span id="cb190-70"><a href="線形回帰分析.html#cb190-70" tabindex="-1"></a><span class="co">#&gt; - acpt  1   11.8141 50.808 30.315</span></span>
<span id="cb190-71"><a href="線形回帰分析.html#cb190-71" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb190-72"><a href="線形回帰分析.html#cb190-72" tabindex="-1"></a><span class="co">#&gt; Step:  AIC=20.01</span></span>
<span id="cb190-73"><a href="線形回帰分析.html#cb190-73" tabindex="-1"></a><span class="co">#&gt; rate ~ trks + lane + acpt + sigs + itg + slim + len + lwid + </span></span>
<span id="cb190-74"><a href="線形回帰分析.html#cb190-74" tabindex="-1"></a><span class="co">#&gt;     shld</span></span>
<span id="cb190-75"><a href="線形回帰分析.html#cb190-75" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb190-76"><a href="線形回帰分析.html#cb190-76" tabindex="-1"></a><span class="co">#&gt;        Df Sum of Sq    RSS    AIC</span></span>
<span id="cb190-77"><a href="線形回帰分析.html#cb190-77" tabindex="-1"></a><span class="co">#&gt; - lane  1    0.0780 39.085 18.085</span></span>
<span id="cb190-78"><a href="線形回帰分析.html#cb190-78" tabindex="-1"></a><span class="co">#&gt; - itg   1    0.2582 39.265 18.264</span></span>
<span id="cb190-79"><a href="線形回帰分析.html#cb190-79" tabindex="-1"></a><span class="co">#&gt; - lwid  1    0.8988 39.906 18.895</span></span>
<span id="cb190-80"><a href="線形回帰分析.html#cb190-80" tabindex="-1"></a><span class="co">#&gt; - shld  1    0.9652 39.972 18.960</span></span>
<span id="cb190-81"><a href="線形回帰分析.html#cb190-81" tabindex="-1"></a><span class="co">#&gt; - sigs  1    0.9786 39.986 18.973</span></span>
<span id="cb190-82"><a href="線形回帰分析.html#cb190-82" tabindex="-1"></a><span class="co">#&gt; - slim  1    1.4501 40.457 19.430</span></span>
<span id="cb190-83"><a href="線形回帰分析.html#cb190-83" tabindex="-1"></a><span class="co">#&gt; - trks  1    1.7771 40.784 19.744</span></span>
<span id="cb190-84"><a href="線形回帰分析.html#cb190-84" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;              39.007 20.007</span></span>
<span id="cb190-85"><a href="線形回帰分析.html#cb190-85" tabindex="-1"></a><span class="co">#&gt; - len   1    5.3262 44.333 22.999</span></span>
<span id="cb190-86"><a href="線形回帰分析.html#cb190-86" tabindex="-1"></a><span class="co">#&gt; - acpt  1   11.9079 50.915 28.397</span></span>
<span id="cb190-87"><a href="線形回帰分析.html#cb190-87" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb190-88"><a href="線形回帰分析.html#cb190-88" tabindex="-1"></a><span class="co">#&gt; Step:  AIC=18.08</span></span>
<span id="cb190-89"><a href="線形回帰分析.html#cb190-89" tabindex="-1"></a><span class="co">#&gt; rate ~ trks + acpt + sigs + itg + slim + len + lwid + shld</span></span>
<span id="cb190-90"><a href="線形回帰分析.html#cb190-90" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb190-91"><a href="線形回帰分析.html#cb190-91" tabindex="-1"></a><span class="co">#&gt;        Df Sum of Sq    RSS    AIC</span></span>
<span id="cb190-92"><a href="線形回帰分析.html#cb190-92" tabindex="-1"></a><span class="co">#&gt; - itg   1    0.7717 39.857 16.847</span></span>
<span id="cb190-93"><a href="線形回帰分析.html#cb190-93" tabindex="-1"></a><span class="co">#&gt; - lwid  1    0.8615 39.946 16.935</span></span>
<span id="cb190-94"><a href="線形回帰分析.html#cb190-94" tabindex="-1"></a><span class="co">#&gt; - shld  1    0.8874 39.972 16.960</span></span>
<span id="cb190-95"><a href="線形回帰分析.html#cb190-95" tabindex="-1"></a><span class="co">#&gt; - sigs  1    1.3821 40.467 17.440</span></span>
<span id="cb190-96"><a href="線形回帰分析.html#cb190-96" tabindex="-1"></a><span class="co">#&gt; - slim  1    1.5009 40.586 17.554</span></span>
<span id="cb190-97"><a href="線形回帰分析.html#cb190-97" tabindex="-1"></a><span class="co">#&gt; - trks  1    1.8331 40.918 17.872</span></span>
<span id="cb190-98"><a href="線形回帰分析.html#cb190-98" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;              39.085 18.085</span></span>
<span id="cb190-99"><a href="線形回帰分析.html#cb190-99" tabindex="-1"></a><span class="co">#&gt; - len   1    5.2498 44.335 21.000</span></span>
<span id="cb190-100"><a href="線形回帰分析.html#cb190-100" tabindex="-1"></a><span class="co">#&gt; - acpt  1   11.9551 51.040 26.493</span></span>
<span id="cb190-101"><a href="線形回帰分析.html#cb190-101" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb190-102"><a href="線形回帰分析.html#cb190-102" tabindex="-1"></a><span class="co">#&gt; Step:  AIC=16.85</span></span>
<span id="cb190-103"><a href="線形回帰分析.html#cb190-103" tabindex="-1"></a><span class="co">#&gt; rate ~ trks + acpt + sigs + slim + len + lwid + shld</span></span>
<span id="cb190-104"><a href="線形回帰分析.html#cb190-104" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb190-105"><a href="線形回帰分析.html#cb190-105" tabindex="-1"></a><span class="co">#&gt;        Df Sum of Sq    RSS    AIC</span></span>
<span id="cb190-106"><a href="線形回帰分析.html#cb190-106" tabindex="-1"></a><span class="co">#&gt; - shld  1    0.5989 40.456 15.429</span></span>
<span id="cb190-107"><a href="線形回帰分析.html#cb190-107" tabindex="-1"></a><span class="co">#&gt; - lwid  1    0.7972 40.654 15.620</span></span>
<span id="cb190-108"><a href="線形回帰分析.html#cb190-108" tabindex="-1"></a><span class="co">#&gt; - slim  1    1.5121 41.369 16.300</span></span>
<span id="cb190-109"><a href="線形回帰分析.html#cb190-109" tabindex="-1"></a><span class="co">#&gt; - sigs  1    1.7001 41.557 16.476</span></span>
<span id="cb190-110"><a href="線形回帰分析.html#cb190-110" tabindex="-1"></a><span class="co">#&gt; - trks  1    1.7312 41.588 16.506</span></span>
<span id="cb190-111"><a href="線形回帰分析.html#cb190-111" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;              39.857 16.847</span></span>
<span id="cb190-112"><a href="線形回帰分析.html#cb190-112" tabindex="-1"></a><span class="co">#&gt; - len   1    6.3017 46.158 20.572</span></span>
<span id="cb190-113"><a href="線形回帰分析.html#cb190-113" tabindex="-1"></a><span class="co">#&gt; - acpt  1   11.3358 51.192 24.609</span></span>
<span id="cb190-114"><a href="線形回帰分析.html#cb190-114" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb190-115"><a href="線形回帰分析.html#cb190-115" tabindex="-1"></a><span class="co">#&gt; Step:  AIC=15.43</span></span>
<span id="cb190-116"><a href="線形回帰分析.html#cb190-116" tabindex="-1"></a><span class="co">#&gt; rate ~ trks + acpt + sigs + slim + len + lwid</span></span>
<span id="cb190-117"><a href="線形回帰分析.html#cb190-117" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb190-118"><a href="線形回帰分析.html#cb190-118" tabindex="-1"></a><span class="co">#&gt;        Df Sum of Sq    RSS    AIC</span></span>
<span id="cb190-119"><a href="線形回帰分析.html#cb190-119" tabindex="-1"></a><span class="co">#&gt; - lwid  1    0.4727 40.928 13.882</span></span>
<span id="cb190-120"><a href="線形回帰分析.html#cb190-120" tabindex="-1"></a><span class="co">#&gt; - trks  1    1.4809 41.936 14.831</span></span>
<span id="cb190-121"><a href="線形回帰分析.html#cb190-121" tabindex="-1"></a><span class="co">#&gt; - sigs  1    1.4984 41.954 14.847</span></span>
<span id="cb190-122"><a href="線形回帰分析.html#cb190-122" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;              40.456 15.429</span></span>
<span id="cb190-123"><a href="線形回帰分析.html#cb190-123" tabindex="-1"></a><span class="co">#&gt; - slim  1    5.6245 46.080 18.506</span></span>
<span id="cb190-124"><a href="線形回帰分析.html#cb190-124" tabindex="-1"></a><span class="co">#&gt; - len   1    5.7031 46.159 18.572</span></span>
<span id="cb190-125"><a href="線形回帰分析.html#cb190-125" tabindex="-1"></a><span class="co">#&gt; - acpt  1   11.5064 51.962 23.191</span></span>
<span id="cb190-126"><a href="線形回帰分析.html#cb190-126" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb190-127"><a href="線形回帰分析.html#cb190-127" tabindex="-1"></a><span class="co">#&gt; Step:  AIC=13.88</span></span>
<span id="cb190-128"><a href="線形回帰分析.html#cb190-128" tabindex="-1"></a><span class="co">#&gt; rate ~ trks + acpt + sigs + slim + len</span></span>
<span id="cb190-129"><a href="線形回帰分析.html#cb190-129" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb190-130"><a href="線形回帰分析.html#cb190-130" tabindex="-1"></a><span class="co">#&gt;        Df Sum of Sq    RSS    AIC</span></span>
<span id="cb190-131"><a href="線形回帰分析.html#cb190-131" tabindex="-1"></a><span class="co">#&gt; - trks  1    1.4051 42.333 13.198</span></span>
<span id="cb190-132"><a href="線形回帰分析.html#cb190-132" tabindex="-1"></a><span class="co">#&gt; - sigs  1    1.5118 42.440 13.297</span></span>
<span id="cb190-133"><a href="線形回帰分析.html#cb190-133" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;              40.928 13.882</span></span>
<span id="cb190-134"><a href="線形回帰分析.html#cb190-134" tabindex="-1"></a><span class="co">#&gt; - len   1    5.2305 46.159 16.573</span></span>
<span id="cb190-135"><a href="線形回帰分析.html#cb190-135" tabindex="-1"></a><span class="co">#&gt; - slim  1    6.0861 47.014 17.289</span></span>
<span id="cb190-136"><a href="線形回帰分析.html#cb190-136" tabindex="-1"></a><span class="co">#&gt; - acpt  1   11.6253 52.554 21.633</span></span>
<span id="cb190-137"><a href="線形回帰分析.html#cb190-137" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb190-138"><a href="線形回帰分析.html#cb190-138" tabindex="-1"></a><span class="co">#&gt; Step:  AIC=13.2</span></span>
<span id="cb190-139"><a href="線形回帰分析.html#cb190-139" tabindex="-1"></a><span class="co">#&gt; rate ~ acpt + sigs + slim + len</span></span>
<span id="cb190-140"><a href="線形回帰分析.html#cb190-140" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb190-141"><a href="線形回帰分析.html#cb190-141" tabindex="-1"></a><span class="co">#&gt;        Df Sum of Sq    RSS    AIC</span></span>
<span id="cb190-142"><a href="線形回帰分析.html#cb190-142" tabindex="-1"></a><span class="co">#&gt; &lt;none&gt;              42.333 13.198</span></span>
<span id="cb190-143"><a href="線形回帰分析.html#cb190-143" tabindex="-1"></a><span class="co">#&gt; - sigs  1    2.5132 44.847 13.448</span></span>
<span id="cb190-144"><a href="線形回帰分析.html#cb190-144" tabindex="-1"></a><span class="co">#&gt; - slim  1    6.3349 48.668 16.637</span></span>
<span id="cb190-145"><a href="線形回帰分析.html#cb190-145" tabindex="-1"></a><span class="co">#&gt; - len   1    9.1881 51.521 18.859</span></span>
<span id="cb190-146"><a href="線形回帰分析.html#cb190-146" tabindex="-1"></a><span class="co">#&gt; - acpt  1   12.5355 54.869 21.314</span></span>
<span id="cb190-147"><a href="線形回帰分析.html#cb190-147" tabindex="-1"></a><span class="fu">summary</span>(res_step)</span>
<span id="cb190-148"><a href="線形回帰分析.html#cb190-148" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb190-149"><a href="線形回帰分析.html#cb190-149" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb190-150"><a href="線形回帰分析.html#cb190-150" tabindex="-1"></a><span class="co">#&gt; lm(formula = rate ~ acpt + sigs + slim + len, data = Highway)</span></span>
<span id="cb190-151"><a href="線形回帰分析.html#cb190-151" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb190-152"><a href="線形回帰分析.html#cb190-152" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb190-153"><a href="線形回帰分析.html#cb190-153" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb190-154"><a href="線形回帰分析.html#cb190-154" tabindex="-1"></a><span class="co">#&gt; -1.7505 -0.8659  0.1051  0.6618  2.5116 </span></span>
<span id="cb190-155"><a href="線形回帰分析.html#cb190-155" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb190-156"><a href="線形回帰分析.html#cb190-156" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb190-157"><a href="線形回帰分析.html#cb190-157" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span id="cb190-158"><a href="線形回帰分析.html#cb190-158" tabindex="-1"></a><span class="co">#&gt; (Intercept)  8.81443    2.60435   3.385  0.00181 **</span></span>
<span id="cb190-159"><a href="線形回帰分析.html#cb190-159" tabindex="-1"></a><span class="co">#&gt; acpt         0.08940    0.02818   3.173  0.00319 **</span></span>
<span id="cb190-160"><a href="線形回帰分析.html#cb190-160" tabindex="-1"></a><span class="co">#&gt; sigs         0.48538    0.34164   1.421  0.16450   </span></span>
<span id="cb190-161"><a href="線形回帰分析.html#cb190-161" tabindex="-1"></a><span class="co">#&gt; slim        -0.09599    0.04255  -2.256  0.03064 * </span></span>
<span id="cb190-162"><a href="線形回帰分析.html#cb190-162" tabindex="-1"></a><span class="co">#&gt; len         -0.06856    0.02524  -2.717  0.01030 * </span></span>
<span id="cb190-163"><a href="線形回帰分析.html#cb190-163" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb190-164"><a href="線形回帰分析.html#cb190-164" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb190-165"><a href="線形回帰分析.html#cb190-165" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb190-166"><a href="線形回帰分析.html#cb190-166" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 1.116 on 34 degrees of freedom</span></span>
<span id="cb190-167"><a href="線形回帰分析.html#cb190-167" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.7176, Adjusted R-squared:  0.6843 </span></span>
<span id="cb190-168"><a href="線形回帰分析.html#cb190-168" tabindex="-1"></a><span class="co">#&gt; F-statistic:  21.6 on 4 and 34 DF,  p-value: 6.112e-09</span></span>
<span id="cb190-169"><a href="線形回帰分析.html#cb190-169" tabindex="-1"></a></span>
<span id="cb190-170"><a href="線形回帰分析.html#cb190-170" tabindex="-1"></a><span class="do">## 除かれた変数群の有意性 anova(res_step, res_lm) # anova(res_lm, res_step)</span></span></code></pre></div>
</div>
</div>
<div id="時系列データ同士の回帰" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> 時系列データ同士の回帰<a href="線形回帰分析.html#時系列データ同士の回帰" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="データセット4-株式市場" class="section level3 unnumbered hasAnchor">
<h3>データセット#4: 株式市場<a href="線形回帰分析.html#データセット4-株式市場" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>- TOPIX: 東証株価指数, 月次終値, 2011年12月--2017年4月
- X1--X4, ある指標</code></pre>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="線形回帰分析.html#cb192-1" tabindex="-1"></a>topixmat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;topix_X.csv&quot;</span>)</span>
<span id="cb192-2"><a href="線形回帰分析.html#cb192-2" tabindex="-1"></a><span class="fu">attach</span>(topixmat)</span>
<span id="cb192-3"><a href="線形回帰分析.html#cb192-3" tabindex="-1"></a></span>
<span id="cb192-4"><a href="線形回帰分析.html#cb192-4" tabindex="-1"></a>res_lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(topix <span class="sc">~</span> X1)</span>
<span id="cb192-5"><a href="線形回帰分析.html#cb192-5" tabindex="-1"></a><span class="fu">summary</span>(res_lm1)</span>
<span id="cb192-6"><a href="線形回帰分析.html#cb192-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb192-7"><a href="線形回帰分析.html#cb192-7" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb192-8"><a href="線形回帰分析.html#cb192-8" tabindex="-1"></a><span class="co">#&gt; lm(formula = topix ~ X1)</span></span>
<span id="cb192-9"><a href="線形回帰分析.html#cb192-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb192-10"><a href="線形回帰分析.html#cb192-10" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb192-11"><a href="線形回帰分析.html#cb192-11" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb192-12"><a href="線形回帰分析.html#cb192-12" tabindex="-1"></a><span class="co">#&gt; -391.79 -173.11  -16.77   82.05  452.93 </span></span>
<span id="cb192-13"><a href="線形回帰分析.html#cb192-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb192-14"><a href="線形回帰分析.html#cb192-14" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb192-15"><a href="線形回帰分析.html#cb192-15" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb192-16"><a href="線形回帰分析.html#cb192-16" tabindex="-1"></a><span class="co">#&gt; (Intercept) -170.600    219.329  -0.778     0.44    </span></span>
<span id="cb192-17"><a href="線形回帰分析.html#cb192-17" tabindex="-1"></a><span class="co">#&gt; X1            11.635      1.805   6.448 1.82e-08 ***</span></span>
<span id="cb192-18"><a href="線形回帰分析.html#cb192-18" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb192-19"><a href="線形回帰分析.html#cb192-19" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb192-20"><a href="線形回帰分析.html#cb192-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb192-21"><a href="線形回帰分析.html#cb192-21" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 220.2 on 63 degrees of freedom</span></span>
<span id="cb192-22"><a href="線形回帰分析.html#cb192-22" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.3975, Adjusted R-squared:  0.388 </span></span>
<span id="cb192-23"><a href="線形回帰分析.html#cb192-23" tabindex="-1"></a><span class="co">#&gt; F-statistic: 41.57 on 1 and 63 DF,  p-value: 1.815e-08</span></span>
<span id="cb192-24"><a href="線形回帰分析.html#cb192-24" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb192-25"><a href="線形回帰分析.html#cb192-25" tabindex="-1"></a><span class="fu">plot</span>(X1, topix)</span></code></pre></div>
<p><img src="040-linreg_files/figure-html/reg4-1-1.png" width="75%" /></p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="線形回帰分析.html#cb193-1" tabindex="-1"></a><span class="fu">cor</span>(X1, topix)</span>
<span id="cb193-2"><a href="線形回帰分析.html#cb193-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.6305084</span></span>
<span id="cb193-3"><a href="線形回帰分析.html#cb193-3" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb193-4"><a href="線形回帰分析.html#cb193-4" tabindex="-1"></a><span class="fu">plot</span>(topix, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb193-5"><a href="線形回帰分析.html#cb193-5" tabindex="-1"></a><span class="fu">plot</span>(X1, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="040-linreg_files/figure-html/reg4-1-2.png" width="75%" /></p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="線形回帰分析.html#cb194-1" tabindex="-1"></a></span>
<span id="cb194-2"><a href="線形回帰分析.html#cb194-2" tabindex="-1"></a>res_lm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(topix <span class="sc">~</span> X2)</span>
<span id="cb194-3"><a href="線形回帰分析.html#cb194-3" tabindex="-1"></a><span class="fu">summary</span>(res_lm2)</span>
<span id="cb194-4"><a href="線形回帰分析.html#cb194-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb194-5"><a href="線形回帰分析.html#cb194-5" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb194-6"><a href="線形回帰分析.html#cb194-6" tabindex="-1"></a><span class="co">#&gt; lm(formula = topix ~ X2)</span></span>
<span id="cb194-7"><a href="線形回帰分析.html#cb194-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb194-8"><a href="線形回帰分析.html#cb194-8" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb194-9"><a href="線形回帰分析.html#cb194-9" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb194-10"><a href="線形回帰分析.html#cb194-10" tabindex="-1"></a><span class="co">#&gt; -396.10 -182.85  -57.86  198.61  599.41 </span></span>
<span id="cb194-11"><a href="線形回帰分析.html#cb194-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb194-12"><a href="線形回帰分析.html#cb194-12" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb194-13"><a href="線形回帰分析.html#cb194-13" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb194-14"><a href="線形回帰分析.html#cb194-14" tabindex="-1"></a><span class="co">#&gt; (Intercept)  153.656    243.855    0.63    0.531    </span></span>
<span id="cb194-15"><a href="線形回帰分析.html#cb194-15" tabindex="-1"></a><span class="co">#&gt; X2             8.739      1.960    4.46 3.45e-05 ***</span></span>
<span id="cb194-16"><a href="線形回帰分析.html#cb194-16" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb194-17"><a href="線形回帰分析.html#cb194-17" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb194-18"><a href="線形回帰分析.html#cb194-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb194-19"><a href="線形回帰分析.html#cb194-19" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 247.3 on 63 degrees of freedom</span></span>
<span id="cb194-20"><a href="線形回帰分析.html#cb194-20" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.2399, Adjusted R-squared:  0.2279 </span></span>
<span id="cb194-21"><a href="線形回帰分析.html#cb194-21" tabindex="-1"></a><span class="co">#&gt; F-statistic: 19.89 on 1 and 63 DF,  p-value: 3.451e-05</span></span>
<span id="cb194-22"><a href="線形回帰分析.html#cb194-22" tabindex="-1"></a><span class="fu">plot</span>(X2, topix)</span>
<span id="cb194-23"><a href="線形回帰分析.html#cb194-23" tabindex="-1"></a><span class="fu">cor</span>(X2, topix)</span>
<span id="cb194-24"><a href="線形回帰分析.html#cb194-24" tabindex="-1"></a><span class="co">#&gt; [1] 0.4898424</span></span>
<span id="cb194-25"><a href="線形回帰分析.html#cb194-25" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="040-linreg_files/figure-html/reg4-1-3.png" width="75%" /></p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="線形回帰分析.html#cb195-1" tabindex="-1"></a><span class="fu">plot</span>(topix, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb195-2"><a href="線形回帰分析.html#cb195-2" tabindex="-1"></a><span class="fu">plot</span>(X2, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="040-linreg_files/figure-html/reg4-1-4.png" width="75%" /></p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="線形回帰分析.html#cb196-1" tabindex="-1"></a></span>
<span id="cb196-2"><a href="線形回帰分析.html#cb196-2" tabindex="-1"></a><span class="co"># 残差プロット plot(res_lm1); plot(res_lm2)</span></span>
<span id="cb196-3"><a href="線形回帰分析.html#cb196-3" tabindex="-1"></a></span>
<span id="cb196-4"><a href="線形回帰分析.html#cb196-4" tabindex="-1"></a><span class="co"># Durbin - Watson検定</span></span>
<span id="cb196-5"><a href="線形回帰分析.html#cb196-5" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb196-6"><a href="線形回帰分析.html#cb196-6" tabindex="-1"></a><span class="fu">dwtest</span>(res_lm1)</span>
<span id="cb196-7"><a href="線形回帰分析.html#cb196-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb196-8"><a href="線形回帰分析.html#cb196-8" tabindex="-1"></a><span class="co">#&gt;  Durbin-Watson test</span></span>
<span id="cb196-9"><a href="線形回帰分析.html#cb196-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb196-10"><a href="線形回帰分析.html#cb196-10" tabindex="-1"></a><span class="co">#&gt; data:  res_lm1</span></span>
<span id="cb196-11"><a href="線形回帰分析.html#cb196-11" tabindex="-1"></a><span class="co">#&gt; DW = 0.17012, p-value &lt; 2.2e-16</span></span>
<span id="cb196-12"><a href="線形回帰分析.html#cb196-12" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true autocorrelation is greater than 0</span></span>
<span id="cb196-13"><a href="線形回帰分析.html#cb196-13" tabindex="-1"></a><span class="fu">dwtest</span>(res_lm2)</span>
<span id="cb196-14"><a href="線形回帰分析.html#cb196-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb196-15"><a href="線形回帰分析.html#cb196-15" tabindex="-1"></a><span class="co">#&gt;  Durbin-Watson test</span></span>
<span id="cb196-16"><a href="線形回帰分析.html#cb196-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb196-17"><a href="線形回帰分析.html#cb196-17" tabindex="-1"></a><span class="co">#&gt; data:  res_lm2</span></span>
<span id="cb196-18"><a href="線形回帰分析.html#cb196-18" tabindex="-1"></a><span class="co">#&gt; DW = 0.1226, p-value &lt; 2.2e-16</span></span>
<span id="cb196-19"><a href="線形回帰分析.html#cb196-19" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true autocorrelation is greater than 0</span></span></code></pre></div>

</div>
</div>
<div id="線形モデル" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> 線形モデル<a href="線形回帰分析.html#線形モデル" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>本セクションでは, 線形モデルと関数<code>lm</code>の出力結果との対応関係の確認を行う.
具体的には, 目的変数が量的変数で, いずれもカテゴリー変数である2つの説明変数を持つ線形モデル (2因子モデル) を取り上げる.
サプリメント売上データに対して”回帰分析” (関数<code>lm()</code>を適用) することで得られる
回帰係数の推定値を調べることで, 線形モデルの持つパラメータの意味を理解する.</p>
<p>さらに, Rの環境設定のための関数<code>options()</code>のパラメータの一つであるコントラスト(“contrasts”)を変えることで, パラメータの持つ意味が, すなわち, 解釈が変わることも確認する.</p>
<div id="因子モデルの例-交互作用なし" class="section level3 unnumbered hasAnchor">
<h3>2因子モデルの例 (交互作用なし)<a href="線形回帰分析.html#因子モデルの例-交互作用なし" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="データ-サプリメント売上データ-1-仮想" class="section level4 unnumbered hasAnchor">
<h4>データ: サプリメント売上データ (1) (仮想)<a href="線形回帰分析.html#データ-サプリメント売上データ-1-仮想" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<pre><code>- sales1_10.txt, sales2_10.txt (過去10分売上)
 - 性別 (因子A)
 - 年代 (因子B)
 - 売上 (万円)</code></pre>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="線形回帰分析.html#cb198-1" tabindex="-1"></a><span class="co"># 因子A (性別) 因子B (30代以下, 40代以上) サプリメント売上(万円)</span></span>
<span id="cb198-2"><a href="線形回帰分析.html#cb198-2" tabindex="-1"></a><span class="co"># 過去n週間データ (n = 10, 50)</span></span>
<span id="cb198-3"><a href="線形回帰分析.html#cb198-3" tabindex="-1"></a></span>
<span id="cb198-4"><a href="線形回帰分析.html#cb198-4" tabindex="-1"></a><span class="do">### n = 10のケース</span></span>
<span id="cb198-5"><a href="線形回帰分析.html#cb198-5" tabindex="-1"></a>sales <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;sales1_10.txt&quot;</span>)</span>
<span id="cb198-6"><a href="線形回帰分析.html#cb198-6" tabindex="-1"></a><span class="co"># sales &lt;- read.csv(&#39;sales2_10.txt&#39;)</span></span>
<span id="cb198-7"><a href="線形回帰分析.html#cb198-7" tabindex="-1"></a>sales</span>
<span id="cb198-8"><a href="線形回帰分析.html#cb198-8" tabindex="-1"></a><span class="co">#&gt;    性別 年代  売上</span></span>
<span id="cb198-9"><a href="線形回帰分析.html#cb198-9" tabindex="-1"></a><span class="co">#&gt; 1    A1   B1 14.06</span></span>
<span id="cb198-10"><a href="線形回帰分析.html#cb198-10" tabindex="-1"></a><span class="co">#&gt; 2    A1   B1 13.45</span></span>
<span id="cb198-11"><a href="線形回帰分析.html#cb198-11" tabindex="-1"></a><span class="co">#&gt; 3    A1   B1  9.89</span></span>
<span id="cb198-12"><a href="線形回帰分析.html#cb198-12" tabindex="-1"></a><span class="co">#&gt; 4    A1   B1 12.20</span></span>
<span id="cb198-13"><a href="線形回帰分析.html#cb198-13" tabindex="-1"></a><span class="co">#&gt; 5    A1   B1 14.88</span></span>
<span id="cb198-14"><a href="線形回帰分析.html#cb198-14" tabindex="-1"></a><span class="co">#&gt; 6    A1   B1 15.17</span></span>
<span id="cb198-15"><a href="線形回帰分析.html#cb198-15" tabindex="-1"></a><span class="co">#&gt; 7    A1   B1 10.38</span></span>
<span id="cb198-16"><a href="線形回帰分析.html#cb198-16" tabindex="-1"></a><span class="co">#&gt; 8    A1   B1 12.91</span></span>
<span id="cb198-17"><a href="線形回帰分析.html#cb198-17" tabindex="-1"></a><span class="co">#&gt; 9    A1   B1  9.12</span></span>
<span id="cb198-18"><a href="線形回帰分析.html#cb198-18" tabindex="-1"></a><span class="co">#&gt; 10   A1   B1 13.23</span></span>
<span id="cb198-19"><a href="線形回帰分析.html#cb198-19" tabindex="-1"></a><span class="co">#&gt; 11   A1   B2 21.31</span></span>
<span id="cb198-20"><a href="線形回帰分析.html#cb198-20" tabindex="-1"></a><span class="co">#&gt; 12   A1   B2 20.27</span></span>
<span id="cb198-21"><a href="線形回帰分析.html#cb198-21" tabindex="-1"></a><span class="co">#&gt; 13   A1   B2 17.29</span></span>
<span id="cb198-22"><a href="線形回帰分析.html#cb198-22" tabindex="-1"></a><span class="co">#&gt; 14   A1   B2 20.96</span></span>
<span id="cb198-23"><a href="線形回帰分析.html#cb198-23" tabindex="-1"></a><span class="co">#&gt; 15   A1   B2 20.22</span></span>
<span id="cb198-24"><a href="線形回帰分析.html#cb198-24" tabindex="-1"></a><span class="co">#&gt; 16   A1   B2 18.27</span></span>
<span id="cb198-25"><a href="線形回帰分析.html#cb198-25" tabindex="-1"></a><span class="co">#&gt; 17   A1   B2 15.14</span></span>
<span id="cb198-26"><a href="線形回帰分析.html#cb198-26" tabindex="-1"></a><span class="co">#&gt; 18   A1   B2 17.41</span></span>
<span id="cb198-27"><a href="線形回帰分析.html#cb198-27" tabindex="-1"></a><span class="co">#&gt; 19   A1   B2 20.78</span></span>
<span id="cb198-28"><a href="線形回帰分析.html#cb198-28" tabindex="-1"></a><span class="co">#&gt; 20   A1   B2 19.45</span></span>
<span id="cb198-29"><a href="線形回帰分析.html#cb198-29" tabindex="-1"></a><span class="co">#&gt; 21   A2   B1 22.21</span></span>
<span id="cb198-30"><a href="線形回帰分析.html#cb198-30" tabindex="-1"></a><span class="co">#&gt; 22   A2   B1 17.44</span></span>
<span id="cb198-31"><a href="線形回帰分析.html#cb198-31" tabindex="-1"></a><span class="co">#&gt; 23   A2   B1 21.98</span></span>
<span id="cb198-32"><a href="線形回帰分析.html#cb198-32" tabindex="-1"></a><span class="co">#&gt; 24   A2   B1 17.64</span></span>
<span id="cb198-33"><a href="線形回帰分析.html#cb198-33" tabindex="-1"></a><span class="co">#&gt; 25   A2   B1 20.20</span></span>
<span id="cb198-34"><a href="線形回帰分析.html#cb198-34" tabindex="-1"></a><span class="co">#&gt; 26   A2   B1 22.88</span></span>
<span id="cb198-35"><a href="線形回帰分析.html#cb198-35" tabindex="-1"></a><span class="co">#&gt; 27   A2   B1 21.94</span></span>
<span id="cb198-36"><a href="線形回帰分析.html#cb198-36" tabindex="-1"></a><span class="co">#&gt; 28   A2   B1 21.38</span></span>
<span id="cb198-37"><a href="線形回帰分析.html#cb198-37" tabindex="-1"></a><span class="co">#&gt; 29   A2   B1 23.69</span></span>
<span id="cb198-38"><a href="線形回帰分析.html#cb198-38" tabindex="-1"></a><span class="co">#&gt; 30   A2   B1 23.24</span></span>
<span id="cb198-39"><a href="線形回帰分析.html#cb198-39" tabindex="-1"></a><span class="co">#&gt; 31   A2   B2 22.44</span></span>
<span id="cb198-40"><a href="線形回帰分析.html#cb198-40" tabindex="-1"></a><span class="co">#&gt; 32   A2   B2 27.77</span></span>
<span id="cb198-41"><a href="線形回帰分析.html#cb198-41" tabindex="-1"></a><span class="co">#&gt; 33   A2   B2 30.91</span></span>
<span id="cb198-42"><a href="線形回帰分析.html#cb198-42" tabindex="-1"></a><span class="co">#&gt; 34   A2   B2 28.55</span></span>
<span id="cb198-43"><a href="線形回帰分析.html#cb198-43" tabindex="-1"></a><span class="co">#&gt; 35   A2   B2 23.86</span></span>
<span id="cb198-44"><a href="線形回帰分析.html#cb198-44" tabindex="-1"></a><span class="co">#&gt; 36   A2   B2 23.69</span></span>
<span id="cb198-45"><a href="線形回帰分析.html#cb198-45" tabindex="-1"></a><span class="co">#&gt; 37   A2   B2 29.09</span></span>
<span id="cb198-46"><a href="線形回帰分析.html#cb198-46" tabindex="-1"></a><span class="co">#&gt; 38   A2   B2 22.72</span></span>
<span id="cb198-47"><a href="線形回帰分析.html#cb198-47" tabindex="-1"></a><span class="co">#&gt; 39   A2   B2 27.03</span></span>
<span id="cb198-48"><a href="線形回帰分析.html#cb198-48" tabindex="-1"></a><span class="co">#&gt; 40   A2   B2 26.05</span></span></code></pre></div>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="線形回帰分析.html#cb199-1" tabindex="-1"></a><span class="co"># クロス集計</span></span>
<span id="cb199-2"><a href="線形回帰分析.html#cb199-2" tabindex="-1"></a><span class="fu">table</span>(sales[, <span class="sc">-</span><span class="dv">3</span>])</span>
<span id="cb199-3"><a href="線形回帰分析.html#cb199-3" tabindex="-1"></a><span class="co">#&gt;     年代</span></span>
<span id="cb199-4"><a href="線形回帰分析.html#cb199-4" tabindex="-1"></a><span class="co">#&gt; 性別 B1 B2</span></span>
<span id="cb199-5"><a href="線形回帰分析.html#cb199-5" tabindex="-1"></a><span class="co">#&gt;   A1 10 10</span></span>
<span id="cb199-6"><a href="線形回帰分析.html#cb199-6" tabindex="-1"></a><span class="co">#&gt;   A2 10 10</span></span>
<span id="cb199-7"><a href="線形回帰分析.html#cb199-7" tabindex="-1"></a><span class="co"># 各グループの平均売上計算</span></span>
<span id="cb199-8"><a href="線形回帰分析.html#cb199-8" tabindex="-1"></a><span class="fu">aggregate</span>(売上 <span class="sc">~</span> 性別 <span class="sc">+</span> 年代, <span class="at">data =</span> sales, <span class="at">FUN =</span> mean)  <span class="co"># 性別・年代別平均</span></span>
<span id="cb199-9"><a href="線形回帰分析.html#cb199-9" tabindex="-1"></a><span class="co">#&gt;   性別 年代   売上</span></span>
<span id="cb199-10"><a href="線形回帰分析.html#cb199-10" tabindex="-1"></a><span class="co">#&gt; 1   A1   B1 12.529</span></span>
<span id="cb199-11"><a href="線形回帰分析.html#cb199-11" tabindex="-1"></a><span class="co">#&gt; 2   A2   B1 21.260</span></span>
<span id="cb199-12"><a href="線形回帰分析.html#cb199-12" tabindex="-1"></a><span class="co">#&gt; 3   A1   B2 19.110</span></span>
<span id="cb199-13"><a href="線形回帰分析.html#cb199-13" tabindex="-1"></a><span class="co">#&gt; 4   A2   B2 26.211</span></span></code></pre></div>
<ul>
<li>主効果モデル (交互作用なし)</li>
</ul>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="線形回帰分析.html#cb200-1" tabindex="-1"></a><span class="co"># lm関数の実行</span></span>
<span id="cb200-2"><a href="線形回帰分析.html#cb200-2" tabindex="-1"></a>res_lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(売上 <span class="sc">~</span> 性別 <span class="sc">+</span> 年代, <span class="at">data =</span> sales)</span>
<span id="cb200-3"><a href="線形回帰分析.html#cb200-3" tabindex="-1"></a><span class="fu">summary</span>(res_lm1)</span>
<span id="cb200-4"><a href="線形回帰分析.html#cb200-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb200-5"><a href="線形回帰分析.html#cb200-5" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb200-6"><a href="線形回帰分析.html#cb200-6" tabindex="-1"></a><span class="co">#&gt; lm(formula = 売上 ~ 性別 + 年代, data = sales)</span></span>
<span id="cb200-7"><a href="線形回帰分析.html#cb200-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb200-8"><a href="線形回帰分析.html#cb200-8" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb200-9"><a href="線形回帰分析.html#cb200-9" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb200-10"><a href="線形回帰分析.html#cb200-10" tabindex="-1"></a><span class="co">#&gt; -4.1785 -1.6985  0.5205  1.9345  4.2915 </span></span>
<span id="cb200-11"><a href="線形回帰分析.html#cb200-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb200-12"><a href="線形回帰分析.html#cb200-12" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb200-13"><a href="線形回帰分析.html#cb200-13" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb200-14"><a href="線形回帰分析.html#cb200-14" tabindex="-1"></a><span class="co">#&gt; (Intercept)  12.9365     0.6417  20.161  &lt; 2e-16 ***</span></span>
<span id="cb200-15"><a href="線形回帰分析.html#cb200-15" tabindex="-1"></a><span class="co">#&gt; 性別A2        7.9160     0.7409  10.684 7.33e-13 ***</span></span>
<span id="cb200-16"><a href="線形回帰分析.html#cb200-16" tabindex="-1"></a><span class="co">#&gt; 年代B2        5.7660     0.7409   7.782 2.64e-09 ***</span></span>
<span id="cb200-17"><a href="線形回帰分析.html#cb200-17" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb200-18"><a href="線形回帰分析.html#cb200-18" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb200-19"><a href="線形回帰分析.html#cb200-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb200-20"><a href="線形回帰分析.html#cb200-20" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 2.343 on 37 degrees of freedom</span></span>
<span id="cb200-21"><a href="線形回帰分析.html#cb200-21" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.8252, Adjusted R-squared:  0.8158 </span></span>
<span id="cb200-22"><a href="線形回帰分析.html#cb200-22" tabindex="-1"></a><span class="co">#&gt; F-statistic: 87.35 on 2 and 37 DF,  p-value: 9.677e-15</span></span></code></pre></div>
</div>
</div>
<div id="因子モデルの例-交互作用有り" class="section level3 unnumbered hasAnchor">
<h3>2因子モデルの例 (交互作用有り)<a href="線形回帰分析.html#因子モデルの例-交互作用有り" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>飽和モデル (主効果 + 交互作用効果)</li>
</ul>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="線形回帰分析.html#cb201-1" tabindex="-1"></a>res_lm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(売上 <span class="sc">~</span> 性別 <span class="sc">*</span> 年代, <span class="at">data =</span> sales)</span>
<span id="cb201-2"><a href="線形回帰分析.html#cb201-2" tabindex="-1"></a><span class="fu">summary</span>(res_lm2)</span>
<span id="cb201-3"><a href="線形回帰分析.html#cb201-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb201-4"><a href="線形回帰分析.html#cb201-4" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb201-5"><a href="線形回帰分析.html#cb201-5" tabindex="-1"></a><span class="co">#&gt; lm(formula = 売上 ~ 性別 * 年代, data = sales)</span></span>
<span id="cb201-6"><a href="線形回帰分析.html#cb201-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb201-7"><a href="線形回帰分析.html#cb201-7" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb201-8"><a href="線形回帰分析.html#cb201-8" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb201-9"><a href="線形回帰分析.html#cb201-9" tabindex="-1"></a><span class="co">#&gt; -3.9700 -1.9023  0.6905  1.6325  4.6990 </span></span>
<span id="cb201-10"><a href="線形回帰分析.html#cb201-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb201-11"><a href="線形回帰分析.html#cb201-11" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb201-12"><a href="線形回帰分析.html#cb201-12" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb201-13"><a href="線形回帰分析.html#cb201-13" tabindex="-1"></a><span class="co">#&gt; (Intercept)    12.5290     0.7388  16.959  &lt; 2e-16 ***</span></span>
<span id="cb201-14"><a href="線形回帰分析.html#cb201-14" tabindex="-1"></a><span class="co">#&gt; 性別A2          8.7310     1.0448   8.357 5.96e-10 ***</span></span>
<span id="cb201-15"><a href="線形回帰分析.html#cb201-15" tabindex="-1"></a><span class="co">#&gt; 年代B2          6.5810     1.0448   6.299 2.78e-07 ***</span></span>
<span id="cb201-16"><a href="線形回帰分析.html#cb201-16" tabindex="-1"></a><span class="co">#&gt; 性別A2:年代B2  -1.6300     1.4775  -1.103    0.277    </span></span>
<span id="cb201-17"><a href="線形回帰分析.html#cb201-17" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb201-18"><a href="線形回帰分析.html#cb201-18" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb201-19"><a href="線形回帰分析.html#cb201-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb201-20"><a href="線形回帰分析.html#cb201-20" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 2.336 on 36 degrees of freedom</span></span>
<span id="cb201-21"><a href="線形回帰分析.html#cb201-21" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.8309, Adjusted R-squared:  0.8169 </span></span>
<span id="cb201-22"><a href="線形回帰分析.html#cb201-22" tabindex="-1"></a><span class="co">#&gt; F-statistic: 58.98 on 3 and 36 DF,  p-value: 5.697e-14</span></span>
<span id="cb201-23"><a href="線形回帰分析.html#cb201-23" tabindex="-1"></a><span class="fu">anova</span>(res_lm2)</span>
<span id="cb201-24"><a href="線形回帰分析.html#cb201-24" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb201-25"><a href="線形回帰分析.html#cb201-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb201-26"><a href="線形回帰分析.html#cb201-26" tabindex="-1"></a><span class="co">#&gt; Response: 売上</span></span>
<span id="cb201-27"><a href="線形回帰分析.html#cb201-27" tabindex="-1"></a><span class="co">#&gt;           Df Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span id="cb201-28"><a href="線形回帰分析.html#cb201-28" tabindex="-1"></a><span class="co">#&gt; 性別       1 626.63  626.63 114.813 9.506e-13 ***</span></span>
<span id="cb201-29"><a href="線形回帰分析.html#cb201-29" tabindex="-1"></a><span class="co">#&gt; 年代       1 332.47  332.47  60.916 2.975e-09 ***</span></span>
<span id="cb201-30"><a href="線形回帰分析.html#cb201-30" tabindex="-1"></a><span class="co">#&gt; 性別:年代  1   6.64    6.64   1.217    0.2773    </span></span>
<span id="cb201-31"><a href="線形回帰分析.html#cb201-31" tabindex="-1"></a><span class="co">#&gt; Residuals 36 196.48    5.46                      </span></span>
<span id="cb201-32"><a href="線形回帰分析.html#cb201-32" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb201-33"><a href="線形回帰分析.html#cb201-33" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb201-34"><a href="線形回帰分析.html#cb201-34" tabindex="-1"></a></span>
<span id="cb201-35"><a href="線形回帰分析.html#cb201-35" tabindex="-1"></a><span class="co"># 交互作用プロット</span></span>
<span id="cb201-36"><a href="線形回帰分析.html#cb201-36" tabindex="-1"></a><span class="fu">attach</span>(sales)</span>
<span id="cb201-37"><a href="線形回帰分析.html#cb201-37" tabindex="-1"></a><span class="fu">interaction.plot</span>(年代, 性別, <span class="at">response =</span> 売上)</span></code></pre></div>
<p><img src="060-linear_files/figure-html/unnamed-chunk-5-1.png" width="75%" /></p>
<div id="データ-サプリメント売上データ-2-仮想" class="section level4 unnumbered hasAnchor">
<h4>データ: サプリメント売上データ (2) (仮想)<a href="線形回帰分析.html#データ-サプリメント売上データ-2-仮想" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>上と同じデータ項目を持つが, 件数が<span class="math inline">\(n=10 \rightarrow 50\)</span>に増加したデータセット.</p>
<pre><code>- sales1_50.txt, sales2_50.txt (過去50分売上)
 - 性別 (因子A)
 - 年代 (因子B)
 - 売上 (万円)</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="線形回帰分析.html#cb203-1" tabindex="-1"></a><span class="do">### n = 50のケース</span></span>
<span id="cb203-2"><a href="線形回帰分析.html#cb203-2" tabindex="-1"></a>sales2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;sales1_50.txt&quot;</span>)</span>
<span id="cb203-3"><a href="線形回帰分析.html#cb203-3" tabindex="-1"></a><span class="co"># sales2 &lt;- read.csv(&#39;sales2_50.txt&#39;)</span></span>
<span id="cb203-4"><a href="線形回帰分析.html#cb203-4" tabindex="-1"></a></span>
<span id="cb203-5"><a href="線形回帰分析.html#cb203-5" tabindex="-1"></a><span class="co"># クロス集計</span></span>
<span id="cb203-6"><a href="線形回帰分析.html#cb203-6" tabindex="-1"></a><span class="fu">table</span>(sales2[, <span class="sc">-</span><span class="dv">3</span>])</span>
<span id="cb203-7"><a href="線形回帰分析.html#cb203-7" tabindex="-1"></a><span class="co">#&gt;     年代</span></span>
<span id="cb203-8"><a href="線形回帰分析.html#cb203-8" tabindex="-1"></a><span class="co">#&gt; 性別 B1 B2</span></span>
<span id="cb203-9"><a href="線形回帰分析.html#cb203-9" tabindex="-1"></a><span class="co">#&gt;   A1 50 50</span></span>
<span id="cb203-10"><a href="線形回帰分析.html#cb203-10" tabindex="-1"></a><span class="co">#&gt;   A2 50 50</span></span>
<span id="cb203-11"><a href="線形回帰分析.html#cb203-11" tabindex="-1"></a><span class="co"># 各グループの平均売上計算</span></span>
<span id="cb203-12"><a href="線形回帰分析.html#cb203-12" tabindex="-1"></a><span class="fu">aggregate</span>(売上 <span class="sc">~</span> 性別 <span class="sc">+</span> 年代, <span class="at">data =</span> sales2, <span class="at">FUN =</span> mean)  <span class="co"># 性別・年代別平均</span></span>
<span id="cb203-13"><a href="線形回帰分析.html#cb203-13" tabindex="-1"></a><span class="co">#&gt;   性別 年代    売上</span></span>
<span id="cb203-14"><a href="線形回帰分析.html#cb203-14" tabindex="-1"></a><span class="co">#&gt; 1   A1   B1 12.9766</span></span>
<span id="cb203-15"><a href="線形回帰分析.html#cb203-15" tabindex="-1"></a><span class="co">#&gt; 2   A2   B1 24.0718</span></span>
<span id="cb203-16"><a href="線形回帰分析.html#cb203-16" tabindex="-1"></a><span class="co">#&gt; 3   A1   B2 18.2048</span></span>
<span id="cb203-17"><a href="線形回帰分析.html#cb203-17" tabindex="-1"></a><span class="co">#&gt; 4   A2   B2 27.3582</span></span></code></pre></div>
<ul>
<li>主効果モデル (交互作用なし)</li>
</ul>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="線形回帰分析.html#cb204-1" tabindex="-1"></a><span class="co"># 主効果モデル</span></span>
<span id="cb204-2"><a href="線形回帰分析.html#cb204-2" tabindex="-1"></a>res_lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(売上 <span class="sc">~</span> 性別 <span class="sc">+</span> 年代, <span class="at">data =</span> sales2)</span>
<span id="cb204-3"><a href="線形回帰分析.html#cb204-3" tabindex="-1"></a><span class="fu">summary</span>(res_lm1)</span>
<span id="cb204-4"><a href="線形回帰分析.html#cb204-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb204-5"><a href="線形回帰分析.html#cb204-5" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb204-6"><a href="線形回帰分析.html#cb204-6" tabindex="-1"></a><span class="co">#&gt; lm(formula = 売上 ~ 性別 + 年代, data = sales2)</span></span>
<span id="cb204-7"><a href="線形回帰分析.html#cb204-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb204-8"><a href="線形回帰分析.html#cb204-8" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb204-9"><a href="線形回帰分析.html#cb204-9" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb204-10"><a href="線形回帰分析.html#cb204-10" tabindex="-1"></a><span class="co">#&gt; -6.8037 -2.2375  0.0243  2.2664  6.9406 </span></span>
<span id="cb204-11"><a href="線形回帰分析.html#cb204-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb204-12"><a href="線形回帰分析.html#cb204-12" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb204-13"><a href="線形回帰分析.html#cb204-13" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb204-14"><a href="線形回帰分析.html#cb204-14" tabindex="-1"></a><span class="co">#&gt; (Intercept)  13.4621     0.3516   38.29   &lt;2e-16 ***</span></span>
<span id="cb204-15"><a href="線形回帰分析.html#cb204-15" tabindex="-1"></a><span class="co">#&gt; 性別A2       10.1243     0.4060   24.94   &lt;2e-16 ***</span></span>
<span id="cb204-16"><a href="線形回帰分析.html#cb204-16" tabindex="-1"></a><span class="co">#&gt; 年代B2        4.2573     0.4060   10.49   &lt;2e-16 ***</span></span>
<span id="cb204-17"><a href="線形回帰分析.html#cb204-17" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb204-18"><a href="線形回帰分析.html#cb204-18" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb204-19"><a href="線形回帰分析.html#cb204-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb204-20"><a href="線形回帰分析.html#cb204-20" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 2.871 on 197 degrees of freedom</span></span>
<span id="cb204-21"><a href="線形回帰分析.html#cb204-21" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.7879, Adjusted R-squared:  0.7858 </span></span>
<span id="cb204-22"><a href="線形回帰分析.html#cb204-22" tabindex="-1"></a><span class="co">#&gt; F-statistic: 365.9 on 2 and 197 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<ul>
<li>飽和モデル (主効果 + 交互作用効果)</li>
</ul>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="線形回帰分析.html#cb205-1" tabindex="-1"></a><span class="co"># 飽和モデル (主効果+交互作用効果)</span></span>
<span id="cb205-2"><a href="線形回帰分析.html#cb205-2" tabindex="-1"></a>res_lm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(売上 <span class="sc">~</span> 性別 <span class="sc">*</span> 年代, <span class="at">data =</span> sales2)</span>
<span id="cb205-3"><a href="線形回帰分析.html#cb205-3" tabindex="-1"></a><span class="fu">summary</span>(res_lm2)</span>
<span id="cb205-4"><a href="線形回帰分析.html#cb205-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb205-5"><a href="線形回帰分析.html#cb205-5" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb205-6"><a href="線形回帰分析.html#cb205-6" tabindex="-1"></a><span class="co">#&gt; lm(formula = 売上 ~ 性別 * 年代, data = sales2)</span></span>
<span id="cb205-7"><a href="線形回帰分析.html#cb205-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb205-8"><a href="線形回帰分析.html#cb205-8" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb205-9"><a href="線形回帰分析.html#cb205-9" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb205-10"><a href="線形回帰分析.html#cb205-10" tabindex="-1"></a><span class="co">#&gt; -6.3182 -2.0093  0.2117  2.1238  6.8418 </span></span>
<span id="cb205-11"><a href="線形回帰分析.html#cb205-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb205-12"><a href="線形回帰分析.html#cb205-12" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb205-13"><a href="線形回帰分析.html#cb205-13" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb205-14"><a href="線形回帰分析.html#cb205-14" tabindex="-1"></a><span class="co">#&gt; (Intercept)    12.9766     0.4011  32.355   &lt;2e-16 ***</span></span>
<span id="cb205-15"><a href="線形回帰分析.html#cb205-15" tabindex="-1"></a><span class="co">#&gt; 性別A2         11.0952     0.5672  19.561   &lt;2e-16 ***</span></span>
<span id="cb205-16"><a href="線形回帰分析.html#cb205-16" tabindex="-1"></a><span class="co">#&gt; 年代B2          5.2282     0.5672   9.217   &lt;2e-16 ***</span></span>
<span id="cb205-17"><a href="線形回帰分析.html#cb205-17" tabindex="-1"></a><span class="co">#&gt; 性別A2:年代B2  -1.9418     0.8021  -2.421   0.0164 *  </span></span>
<span id="cb205-18"><a href="線形回帰分析.html#cb205-18" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb205-19"><a href="線形回帰分析.html#cb205-19" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb205-20"><a href="線形回帰分析.html#cb205-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb205-21"><a href="線形回帰分析.html#cb205-21" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 2.836 on 196 degrees of freedom</span></span>
<span id="cb205-22"><a href="線形回帰分析.html#cb205-22" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.7941, Adjusted R-squared:  0.7909 </span></span>
<span id="cb205-23"><a href="線形回帰分析.html#cb205-23" tabindex="-1"></a><span class="co">#&gt; F-statistic: 251.9 on 3 and 196 DF,  p-value: &lt; 2.2e-16</span></span>
<span id="cb205-24"><a href="線形回帰分析.html#cb205-24" tabindex="-1"></a><span class="fu">anova</span>(res_lm2)</span>
<span id="cb205-25"><a href="線形回帰分析.html#cb205-25" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb205-26"><a href="線形回帰分析.html#cb205-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb205-27"><a href="線形回帰分析.html#cb205-27" tabindex="-1"></a><span class="co">#&gt; Response: 売上</span></span>
<span id="cb205-28"><a href="線形回帰分析.html#cb205-28" tabindex="-1"></a><span class="co">#&gt;            Df Sum Sq Mean Sq F value Pr(&gt;F)    </span></span>
<span id="cb205-29"><a href="線形回帰分析.html#cb205-29" tabindex="-1"></a><span class="co">#&gt; 性別        1 5125.1  5125.1  637.21 &lt;2e-16 ***</span></span>
<span id="cb205-30"><a href="線形回帰分析.html#cb205-30" tabindex="-1"></a><span class="co">#&gt; 年代        1  906.2   906.2  112.67 &lt;2e-16 ***</span></span>
<span id="cb205-31"><a href="線形回帰分析.html#cb205-31" tabindex="-1"></a><span class="co">#&gt; 性別:年代   1   47.1    47.1    5.86 0.0164 *  </span></span>
<span id="cb205-32"><a href="線形回帰分析.html#cb205-32" tabindex="-1"></a><span class="co">#&gt; Residuals 196 1576.4     8.0                   </span></span>
<span id="cb205-33"><a href="線形回帰分析.html#cb205-33" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb205-34"><a href="線形回帰分析.html#cb205-34" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb205-35"><a href="線形回帰分析.html#cb205-35" tabindex="-1"></a><span class="fu">anova</span>(res_lm1, res_lm2, <span class="at">test =</span> <span class="st">&quot;F&quot;</span>)</span>
<span id="cb205-36"><a href="線形回帰分析.html#cb205-36" tabindex="-1"></a><span class="co">#&gt; Analysis of Variance Table</span></span>
<span id="cb205-37"><a href="線形回帰分析.html#cb205-37" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb205-38"><a href="線形回帰分析.html#cb205-38" tabindex="-1"></a><span class="co">#&gt; Model 1: 売上 ~ 性別 + 年代</span></span>
<span id="cb205-39"><a href="線形回帰分析.html#cb205-39" tabindex="-1"></a><span class="co">#&gt; Model 2: 売上 ~ 性別 * 年代</span></span>
<span id="cb205-40"><a href="線形回帰分析.html#cb205-40" tabindex="-1"></a><span class="co">#&gt;   Res.Df    RSS Df Sum of Sq    F Pr(&gt;F)  </span></span>
<span id="cb205-41"><a href="線形回帰分析.html#cb205-41" tabindex="-1"></a><span class="co">#&gt; 1    197 1623.6                           </span></span>
<span id="cb205-42"><a href="線形回帰分析.html#cb205-42" tabindex="-1"></a><span class="co">#&gt; 2    196 1576.4  1    47.132 5.86 0.0164 *</span></span>
<span id="cb205-43"><a href="線形回帰分析.html#cb205-43" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb205-44"><a href="線形回帰分析.html#cb205-44" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb205-45"><a href="線形回帰分析.html#cb205-45" tabindex="-1"></a></span>
<span id="cb205-46"><a href="線形回帰分析.html#cb205-46" tabindex="-1"></a><span class="co"># 交互作用プロット</span></span>
<span id="cb205-47"><a href="線形回帰分析.html#cb205-47" tabindex="-1"></a><span class="fu">interaction.plot</span>(年代, 性別, <span class="at">response =</span> 売上)</span></code></pre></div>
<p><img src="060-linear_files/figure-html/unnamed-chunk-7-1.png" width="75%" /></p>
<ul>
<li>予測 (理論値)</li>
</ul>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="線形回帰分析.html#cb206-1" tabindex="-1"></a>sales_pred1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(sales2, <span class="fu">predict</span>(res_lm1))</span>
<span id="cb206-2"><a href="線形回帰分析.html#cb206-2" tabindex="-1"></a><span class="fu">head</span>(sales_pred1, <span class="dv">10</span>)</span>
<span id="cb206-3"><a href="線形回帰分析.html#cb206-3" tabindex="-1"></a><span class="co">#&gt;    性別 年代  売上 predict.res_lm1.</span></span>
<span id="cb206-4"><a href="線形回帰分析.html#cb206-4" tabindex="-1"></a><span class="co">#&gt; 1    A1   B1 14.06         13.46205</span></span>
<span id="cb206-5"><a href="線形回帰分析.html#cb206-5" tabindex="-1"></a><span class="co">#&gt; 2    A1   B1 13.45         13.46205</span></span>
<span id="cb206-6"><a href="線形回帰分析.html#cb206-6" tabindex="-1"></a><span class="co">#&gt; 3    A1   B1  9.89         13.46205</span></span>
<span id="cb206-7"><a href="線形回帰分析.html#cb206-7" tabindex="-1"></a><span class="co">#&gt; 4    A1   B1 12.20         13.46205</span></span>
<span id="cb206-8"><a href="線形回帰分析.html#cb206-8" tabindex="-1"></a><span class="co">#&gt; 5    A1   B1 14.88         13.46205</span></span>
<span id="cb206-9"><a href="線形回帰分析.html#cb206-9" tabindex="-1"></a><span class="co">#&gt; 6    A1   B1 15.17         13.46205</span></span>
<span id="cb206-10"><a href="線形回帰分析.html#cb206-10" tabindex="-1"></a><span class="co">#&gt; 7    A1   B1 10.38         13.46205</span></span>
<span id="cb206-11"><a href="線形回帰分析.html#cb206-11" tabindex="-1"></a><span class="co">#&gt; 8    A1   B1 12.91         13.46205</span></span>
<span id="cb206-12"><a href="線形回帰分析.html#cb206-12" tabindex="-1"></a><span class="co">#&gt; 9    A1   B1  9.12         13.46205</span></span>
<span id="cb206-13"><a href="線形回帰分析.html#cb206-13" tabindex="-1"></a><span class="co">#&gt; 10   A1   B1 13.23         13.46205</span></span></code></pre></div>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="線形回帰分析.html#cb207-1" tabindex="-1"></a>sales_pred2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(sales2, <span class="fu">predict</span>(res_lm2))</span>
<span id="cb207-2"><a href="線形回帰分析.html#cb207-2" tabindex="-1"></a><span class="fu">head</span>(sales_pred2, <span class="dv">10</span>)</span>
<span id="cb207-3"><a href="線形回帰分析.html#cb207-3" tabindex="-1"></a><span class="co">#&gt;    性別 年代  売上 predict.res_lm2.</span></span>
<span id="cb207-4"><a href="線形回帰分析.html#cb207-4" tabindex="-1"></a><span class="co">#&gt; 1    A1   B1 14.06          12.9766</span></span>
<span id="cb207-5"><a href="線形回帰分析.html#cb207-5" tabindex="-1"></a><span class="co">#&gt; 2    A1   B1 13.45          12.9766</span></span>
<span id="cb207-6"><a href="線形回帰分析.html#cb207-6" tabindex="-1"></a><span class="co">#&gt; 3    A1   B1  9.89          12.9766</span></span>
<span id="cb207-7"><a href="線形回帰分析.html#cb207-7" tabindex="-1"></a><span class="co">#&gt; 4    A1   B1 12.20          12.9766</span></span>
<span id="cb207-8"><a href="線形回帰分析.html#cb207-8" tabindex="-1"></a><span class="co">#&gt; 5    A1   B1 14.88          12.9766</span></span>
<span id="cb207-9"><a href="線形回帰分析.html#cb207-9" tabindex="-1"></a><span class="co">#&gt; 6    A1   B1 15.17          12.9766</span></span>
<span id="cb207-10"><a href="線形回帰分析.html#cb207-10" tabindex="-1"></a><span class="co">#&gt; 7    A1   B1 10.38          12.9766</span></span>
<span id="cb207-11"><a href="線形回帰分析.html#cb207-11" tabindex="-1"></a><span class="co">#&gt; 8    A1   B1 12.91          12.9766</span></span>
<span id="cb207-12"><a href="線形回帰分析.html#cb207-12" tabindex="-1"></a><span class="co">#&gt; 9    A1   B1  9.12          12.9766</span></span>
<span id="cb207-13"><a href="線形回帰分析.html#cb207-13" tabindex="-1"></a><span class="co">#&gt; 10   A1   B1 13.23          12.9766</span></span></code></pre></div>
</div>
<div id="コントラストの設定変更" class="section level4 unnumbered hasAnchor">
<h4>“コントラスト”の設定変更<a href="線形回帰分析.html#コントラストの設定変更" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>関数<code>options()</code>のパラメータの一つであるコントラスト(“contrasts”)を変えることで, パラメータの持つ意味が, すなわち, 解釈が変わる.</p>
<p>Rのデフォルトは, 処置対比 (“contr.treatment”).</p>
<pre><code>#options(&quot;contrasts&quot;)
#options(&quot;contrasts&quot; = c(&quot;contr.treatment&quot;, &quot;contr.poly&quot;))  # デフォルト
#options(&quot;contrasts&quot; = c(&quot;contr.sum&quot;, &quot;contr.poly&quot;))</code></pre>
<p>零和対比 (“contr.sum) に変更した場合.
- 主効果モデル (交互作用なし)</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="線形回帰分析.html#cb209-1" tabindex="-1"></a><span class="fu">options</span>(<span class="at">contrasts =</span> <span class="fu">c</span>(<span class="st">&quot;contr.sum&quot;</span>, <span class="st">&quot;contr.poly&quot;</span>))</span>
<span id="cb209-2"><a href="線形回帰分析.html#cb209-2" tabindex="-1"></a><span class="co"># 主効果モデル</span></span>
<span id="cb209-3"><a href="線形回帰分析.html#cb209-3" tabindex="-1"></a>res_lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(売上 <span class="sc">~</span> 性別 <span class="sc">+</span> 年代, <span class="at">data =</span> sales2)</span>
<span id="cb209-4"><a href="線形回帰分析.html#cb209-4" tabindex="-1"></a><span class="fu">summary</span>(res_lm1)</span>
<span id="cb209-5"><a href="線形回帰分析.html#cb209-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb209-6"><a href="線形回帰分析.html#cb209-6" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb209-7"><a href="線形回帰分析.html#cb209-7" tabindex="-1"></a><span class="co">#&gt; lm(formula = 売上 ~ 性別 + 年代, data = sales2)</span></span>
<span id="cb209-8"><a href="線形回帰分析.html#cb209-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb209-9"><a href="線形回帰分析.html#cb209-9" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb209-10"><a href="線形回帰分析.html#cb209-10" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb209-11"><a href="線形回帰分析.html#cb209-11" tabindex="-1"></a><span class="co">#&gt; -6.8037 -2.2375  0.0243  2.2664  6.9406 </span></span>
<span id="cb209-12"><a href="線形回帰分析.html#cb209-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb209-13"><a href="線形回帰分析.html#cb209-13" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb209-14"><a href="線形回帰分析.html#cb209-14" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb209-15"><a href="線形回帰分析.html#cb209-15" tabindex="-1"></a><span class="co">#&gt; (Intercept)   20.653      0.203  101.74   &lt;2e-16 ***</span></span>
<span id="cb209-16"><a href="線形回帰分析.html#cb209-16" tabindex="-1"></a><span class="co">#&gt; 性別1         -5.062      0.203  -24.94   &lt;2e-16 ***</span></span>
<span id="cb209-17"><a href="線形回帰分析.html#cb209-17" tabindex="-1"></a><span class="co">#&gt; 年代1         -2.129      0.203  -10.49   &lt;2e-16 ***</span></span>
<span id="cb209-18"><a href="線形回帰分析.html#cb209-18" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb209-19"><a href="線形回帰分析.html#cb209-19" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb209-20"><a href="線形回帰分析.html#cb209-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb209-21"><a href="線形回帰分析.html#cb209-21" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 2.871 on 197 degrees of freedom</span></span>
<span id="cb209-22"><a href="線形回帰分析.html#cb209-22" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.7879, Adjusted R-squared:  0.7858 </span></span>
<span id="cb209-23"><a href="線形回帰分析.html#cb209-23" tabindex="-1"></a><span class="co">#&gt; F-statistic: 365.9 on 2 and 197 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<ul>
<li>飽和モデル (主効果 + 交互作用効果)</li>
</ul>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="線形回帰分析.html#cb210-1" tabindex="-1"></a><span class="co"># 飽和モデル (主効果+交互作用効果)</span></span>
<span id="cb210-2"><a href="線形回帰分析.html#cb210-2" tabindex="-1"></a>res_lm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(売上 <span class="sc">~</span> 性別 <span class="sc">*</span> 年代, <span class="at">data =</span> sales2)</span>
<span id="cb210-3"><a href="線形回帰分析.html#cb210-3" tabindex="-1"></a><span class="fu">summary</span>(res_lm2)</span>
<span id="cb210-4"><a href="線形回帰分析.html#cb210-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb210-5"><a href="線形回帰分析.html#cb210-5" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb210-6"><a href="線形回帰分析.html#cb210-6" tabindex="-1"></a><span class="co">#&gt; lm(formula = 売上 ~ 性別 * 年代, data = sales2)</span></span>
<span id="cb210-7"><a href="線形回帰分析.html#cb210-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb210-8"><a href="線形回帰分析.html#cb210-8" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb210-9"><a href="線形回帰分析.html#cb210-9" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb210-10"><a href="線形回帰分析.html#cb210-10" tabindex="-1"></a><span class="co">#&gt; -6.3182 -2.0093  0.2117  2.1239  6.8418 </span></span>
<span id="cb210-11"><a href="線形回帰分析.html#cb210-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb210-12"><a href="線形回帰分析.html#cb210-12" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb210-13"><a href="線形回帰分析.html#cb210-13" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb210-14"><a href="線形回帰分析.html#cb210-14" tabindex="-1"></a><span class="co">#&gt; (Intercept)  20.6528     0.2005 102.988   &lt;2e-16 ***</span></span>
<span id="cb210-15"><a href="線形回帰分析.html#cb210-15" tabindex="-1"></a><span class="co">#&gt; 性別1        -5.0622     0.2005 -25.243   &lt;2e-16 ***</span></span>
<span id="cb210-16"><a href="線形回帰分析.html#cb210-16" tabindex="-1"></a><span class="co">#&gt; 年代1        -2.1286     0.2005 -10.615   &lt;2e-16 ***</span></span>
<span id="cb210-17"><a href="線形回帰分析.html#cb210-17" tabindex="-1"></a><span class="co">#&gt; 性別1:年代1  -0.4855     0.2005  -2.421   0.0164 *  </span></span>
<span id="cb210-18"><a href="線形回帰分析.html#cb210-18" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb210-19"><a href="線形回帰分析.html#cb210-19" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb210-20"><a href="線形回帰分析.html#cb210-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb210-21"><a href="線形回帰分析.html#cb210-21" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 2.836 on 196 degrees of freedom</span></span>
<span id="cb210-22"><a href="線形回帰分析.html#cb210-22" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.7941, Adjusted R-squared:  0.7909 </span></span>
<span id="cb210-23"><a href="線形回帰分析.html#cb210-23" tabindex="-1"></a><span class="co">#&gt; F-statistic: 251.9 on 3 and 196 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="分散分析-anova.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ロジットブロビット回帰分析.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
